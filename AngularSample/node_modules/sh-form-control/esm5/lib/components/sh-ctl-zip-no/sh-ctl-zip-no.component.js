/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component } from '@angular/core';
import { SHCtlCommon } from '../sh-ctl-common';
import { SHFormControl } from '../../utilities/ShFormControl';
var SHCtlZipNoComponent = /** @class */ (function (_super) {
    tslib_1.__extends(SHCtlZipNoComponent, _super);
    function SHCtlZipNoComponent() {
        var _this = _super.call(this) || this;
        _this.isValidateError = false;
        _this.errorMessage = "3桁か7桁のみ有効です。";
        _this.ctlName = "SHCtlZipNo";
        _this.maxlength = 7;
        return _this;
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    SHCtlZipNoComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes.value) {
            if (changes.value.currentValue) {
                if (changes.value.currentValue != changes.value.previousValue
                    && changes.value.currentValue.length == this.maxlength) {
                    this.value = this.withHyphen(changes.value.currentValue);
                }
            }
        }
    };
    /**
     * @return {?}
     */
    SHCtlZipNoComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.onInit();
    };
    /**
     * @return {?}
     */
    SHCtlZipNoComponent.prototype.ngAfterContentChecked = /**
     * @return {?}
     */
    function () {
        if (this.value != null) {
            this.changeFormat(this.value);
        }
    };
    /**
     * onInput
     * @param event input
     */
    /**
     * onInput
     * @param {?} event input
     * @return {?}
     */
    SHCtlZipNoComponent.prototype.onInput = /**
     * onInput
     * @param {?} event input
     * @return {?}
     */
    function (event) {
        SHCtlCommon.replaceSpace(event);
        SHCtlCommon.replaceFUllSpace(event);
        SHCtlCommon.replaceSign(event);
        SHCtlCommon.replaceFullWidth(event);
        SHCtlCommon.replaceHalfWidth(event);
        SHCtlCommon.sliceLength(event, this.maxlength);
    };
    /**
     * onClick
     * @param event click
     */
    /**
     * onClick
     * @param {?} event click
     * @return {?}
     */
    SHCtlZipNoComponent.prototype.onClick = /**
     * onClick
     * @param {?} event click
     * @return {?}
     */
    function (event) {
        this.onBeforeClick(event);
        this.onAfterClick(event);
    };
    /**
     * onFocus
     * @param event focus
     */
    /**
     * onFocus
     * @param {?} event focus
     * @return {?}
     */
    SHCtlZipNoComponent.prototype.onFocus = /**
     * onFocus
     * @param {?} event focus
     * @return {?}
     */
    function (event) {
        var _this = this;
        this.onBeforeFocus(event);
        if (!event.target.value) {
            setTimeout((/**
             * @return {?}
             */
            function () { _this.onAfterFocus(event); }), 0);
            return;
        }
        event.target.value = this.withoutHyphen(event.target.value);
        event.target.select();
        setTimeout((/**
         * @return {?}
         */
        function () { _this.onAfterFocus(event); }), 0);
        return true;
    };
    /**
     * onBlur
     * @param event blur
     */
    /**
     * onBlur
     * @param {?} event blur
     * @return {?}
     */
    SHCtlZipNoComponent.prototype.onBlur = /**
     * onBlur
     * @param {?} event blur
     * @return {?}
     */
    function (event) {
        var _this = this;
        this.onBeforeBlur(event);
        if (!event.target.value) {
            setTimeout((/**
             * @return {?}
             */
            function () { _this.onAfterBlur(event); }), 0);
            ;
            return;
        }
        event.target.value = this.withHyphen(event.target.value);
        setTimeout((/**
         * @return {?}
         */
        function () { _this.onAfterBlur(event); }), 0);
        ;
    };
    /**
     * onChange
     * @param event change
     */
    /**
     * onChange
     * @param {?} event change
     * @return {?}
     */
    SHCtlZipNoComponent.prototype.onChange = /**
     * onChange
     * @param {?} event change
     * @return {?}
     */
    function (event) {
        var _this = this;
        this.onBeforeChange(event);
        //入力桁数が間違っている場合に、自コンポーネントにフォーカスを戻す
        if (event.target.value.length != 0 && event.target.value.length != 3 && event.target.value.length != 7) {
            event.target.value = "";
            /** @type {?} */
            var inputValue_1 = (/** @type {?} */ (document.querySelector("textarea[name=" + this.ctlName + "], input[name=" + this.ctlName + "]")));
            setTimeout((/**
             * @return {?}
             */
            function () { inputValue_1.focus(); }), 10);
        }
        this.valueChange.emit(event.target.value);
        setTimeout((/**
         * @return {?}
         */
        function () { _this.onAfterChange(event); }), 0);
    };
    /**
     * ハイフン付与編集
     * @param inputTargetValue event.target.value
     */
    /**
     * ハイフン付与編集
     * @param {?} inputTargetValue event.target.value
     * @return {?}
     */
    SHCtlZipNoComponent.prototype.withHyphen = /**
     * ハイフン付与編集
     * @param {?} inputTargetValue event.target.value
     * @return {?}
     */
    function (inputTargetValue) {
        inputTargetValue = inputTargetValue.replace(/\ |\-/g, "");
        if (SHCtlCommon.isBlank(inputTargetValue)) {
            return "";
        }
        inputTargetValue = inputTargetValue.replace(/[!"#$%&'()\*\+\.,\/:;<=>?@\[\\\]^_`{|}~a-zA-Z]/g, "");
        inputTargetValue = inputTargetValue.replace(/[^\x01-\x7E\xA1-\xDF]/g, "");
        if (isNaN(inputTargetValue)) {
            return "";
        }
        /** @type {?} */
        var zipcd = inputTargetValue.toString();
        if (zipcd.match(/^\d{3}-?\d{4}$/)) {
            zipcd = zipcd.substr(0, 3) + "-" + zipcd.substr(3);
        }
        return zipcd;
    };
    /**
     * ハイフン除去編集
     * @param inputTargetValue event.target.value
     */
    /**
     * ハイフン除去編集
     * @param {?} inputTargetValue event.target.value
     * @return {?}
     */
    SHCtlZipNoComponent.prototype.withoutHyphen = /**
     * ハイフン除去編集
     * @param {?} inputTargetValue event.target.value
     * @return {?}
     */
    function (inputTargetValue) {
        return new String(inputTargetValue).replace(/-/g, "");
    };
    /**
     * フォーマット編集
     * @param value this.value
     */
    /**
     * フォーマット編集
     * @param {?} value this.value
     * @return {?}
     */
    SHCtlZipNoComponent.prototype.changeFormat = /**
     * フォーマット編集
     * @param {?} value this.value
     * @return {?}
     */
    function (value) {
        if (!value) {
            this.stringValue = "";
            return;
        }
        /** @type {?} */
        var nullFirstString = null;
        /** @type {?} */
        var nullLastString = null;
        nullFirstString = value.slice(0, 3);
        nullLastString = value.slice(-4);
        this.stringValue = String(nullFirstString + "-" + nullLastString);
    };
    SHCtlZipNoComponent.decorators = [
        { type: Component, args: [{
                    selector: 'sh-ctl-zip-no',
                    template: "<ng-container *ngIf=\"!onlyField; else onlyFieldControl\">\r\n  <div *ngIf=\"!isDisabled\" (focusin)=\"onFocusin($event)\" (focusout)=\"onFocusout($event)\">\r\n    <mat-form-field class=\"mat-validation\" [floatLabel]=\"floatLabel\">\r\n      <input #inputElm matInput attr.name=\"{{ctlName}}\"\r\n        class=\"form-control ShCtlZipNo can-moved-with-the-enter-key  {{strClass}}\" type=\"tel\" [placeholder]=\"title\"\r\n        [required]=\"required\" [disabled]=\"disabled\" [class.isValidateError]=\"isValidateError\" [ngStyle]=\"styles\"\r\n        [ngClass]=\"objClass\" [(ngModel)]=\"value\" (input)=\"onInput($event)\" (click)=\"onClick($event)\"\r\n        (focus)=\"onFocus($event)\" (change)=\"onChange($event)\" />\r\n      <button mat-button *ngIf=\"inputElm.value && !inputElm.readOnly && !inputElm.disabled\" matSuffix mat-icon-button\r\n        aria-label=\"Clear\" (mousedown)=\"clearValue()\" (keydown)=\"clickClearButton($event)\">\r\n        <mat-icon>close</mat-icon>\r\n      </button>\r\n    </mat-form-field>\r\n    <span class=\"custom-alert-message\">{{message.toString().split(',').join(' ')}}</span>\r\n  </div>\r\n</ng-container>\r\n\r\n<ng-template #onlyFieldControl>\r\n  <div class=\"only-field\" (focusin)=\"onFocusin($event)\" (focusout)=\"onFocusout($event)\">\r\n    <input #inputElm matInput attr.name=\"{{ctlName}}\"\r\n      class=\"form-control ShCtlZipNo can-moved-with-the-enter-key  {{strClass}}\" type=\"tel\"\r\n      [required]=\"required\" [disabled]=\"disabled\" [class.isValidateError]=\"isValidateError\" [ngStyle]=\"styles\"\r\n      [ngClass]=\"objClass\" [(ngModel)]=\"value\" (input)=\"onInput($event)\" (click)=\"onClick($event)\"\r\n      (focus)=\"onFocus($event)\" (change)=\"onChange($event)\" />\r\n    <button mat-button *ngIf=\"inputElm.value && !inputElm.readOnly && !inputElm.disabled\" matSuffix mat-icon-button\r\n      aria-label=\"Clear\" (mousedown)=\"clearValue()\" (keydown)=\"clickClearButton($event)\">\r\n      <mat-icon>close</mat-icon>\r\n    </button>\r\n  </div>\r\n</ng-template>\r\n\r\n<div *ngIf=\"isDisabled\" class=\"display-ctl-view\">\r\n  <div>\r\n    <div *ngIf=\"title\" class=\"display-ctl-view\">\r\n      <div class=\"display-result\" [ngStyle]=\"{'width.px': labelWidth}\" fxLayout=\"row wrap\" fxFlex>\r\n        <div fxFlex class=\"item-title\"><strong>{{title}}:</strong></div>\r\n      </div>\r\n      <div fxFlex class=\"valueOutput\">\r\n        {{stringValue}}\r\n      </div>\r\n    </div>\r\n\r\n    <div *ngIf=\"!title\" class=\"display-ctl-view notitle-value\">\r\n      <div fxFlex class=\"valueOutput\">\r\n        {{stringValue}}\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n",
                    styles: [".display-ctl-view{display:-webkit-box;display:flex}.display-result{margin-left:30px}.valueOutput{-webkit-box-flex:1;flex:1;padding-top:4px}.notitle-value{width:100%;margin-left:30px}", ".sh-flex{width:100%;display:-webkit-inline-box;display:inline-flex}.sh-flex-center{-webkit-box-align:center;align-items:center}.sh-flex-between{-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:center;align-items:center}.display-ctl-view{margin-top:20px}.overlay{position:fixed;display:-webkit-box;display:flex;top:0;left:0;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center;height:100%;width:100%;color:gray;background-color:rgba(0,0,0,.5);z-index:9999}.loader-text{display:block;color:#f3f3f3;margin-top:1em}.mat-dialog-content{overflow:hidden;max-height:none}.sh-dialog-content{height:85%}.sh-kbn-dialog-table-container{height:92%;overflow-y:scroll;margin-top:18px;margin-bottom:18px}.sh-dialog-table-container{display:-webkit-box;display:flex;height:83%;overflow-y:scroll;margin-top:18px;margin-bottom:18px}.sh-text-center{text-align:center}.sh-width-100{width:100%}.sh-label{display:block}.custom-alert-message{top:-20px;position:relative;font-size:.75em;color:rgba(0,0,0,.54)}.result-input,.sh-label{color:rgba(0,0,0,.87)}::ng-deep .mat-form-field-label span{color:rgba(0,0,0,.87)}::ng-deep .result-container .mat-form-field-flex{background-color:#ccdcff}.sh-ctl-state-primary::ng-deep .mat-form-field-label{color:#3f51b5}.sh-ctl-state-primary::ng-deep .mat-form-field-underline{background-color:#3f51b5}.sh-ctl-state-primary-message{color:#3f51b5}.sh-ctl-state-secondary::ng-deep .mat-form-field-label{color:#ff4081}.sh-ctl-state-secondary::ng-deep .mat-form-field-underline{background-color:#ff4081}.sh-ctl-state-secondary-message{color:#ff4081}.sh-ctl-state-success::ng-deep .mat-form-field-label{color:#0dad17}.sh-ctl-state-success::ng-deep .mat-form-field-underline{background-color:#0dad17}.sh-ctl-state-success-message{color:#0dad17}.sh-ctl-state-danger::ng-deep .mat-form-field-label{color:#f44336}.sh-ctl-state-danger::ng-deep .mat-form-field-underline{background-color:#f44336}.sh-ctl-state-danger-message{color:#f44336}.sh-ctl-state-warning::ng-deep .mat-form-field-label{color:#e29f2b}.sh-ctl-state-warning::ng-deep .mat-form-field-underline{background-color:#e29f2b}.sh-ctl-state-warning-message{color:#e29f2b}.sh-container{position:relative;width:100%;height:100%}.only-field{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;width:100%;height:100%;min-height:28px}.only-field input,.only-field textarea{font:inherit;background:0 0;color:currentColor;border:none;outline:0;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit}.only-field-danger{background-color:#f44336}.only-field-warning{background-color:#e29f2b}.only-field-success{background-color:#0dad17}::ng-deep .only-field .material-icons{font-size:13px}::ng-deep .only-field .mat-button{position:relative;width:24px;height:24px}::ng-deep .only-field .mat-icon-button{position:relative;width:24px;height:24px}::ng-deep .only-field .mat-icon{position:absolute;top:0;left:0}::ng-deep .only-field .mat-datepicker-toggle-default-icon{position:absolute;top:25%;left:0;right:0;bottom:0;margin-left:auto;margin-right:auto}::ng-deep .mat-datepicker-toggle span svg{width:16px;height:16px}.only-label{background-color:#ccdcff;position:relative}.only-label mat-icon{position:absolute;top:25%;left:0;right:0;bottom:0;margin-left:auto;font-size:16px}.bind-flg__input{opacity:0;height:0;width:0;position:absolute;z-index:-100}"]
                }] }
    ];
    /** @nocollapse */
    SHCtlZipNoComponent.ctorParameters = function () { return []; };
    return SHCtlZipNoComponent;
}(SHFormControl));
export { SHCtlZipNoComponent };
if (false) {
    /** @type {?} */
    SHCtlZipNoComponent.prototype.isValidateError;
    /** @type {?} */
    SHCtlZipNoComponent.prototype.errorMessage;
    /** @type {?} */
    SHCtlZipNoComponent.prototype.stringValue;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2gtY3RsLXppcC1uby5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9zaC1mb3JtLWNvbnRyb2wvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9zaC1jdGwtemlwLW5vL3NoLWN0bC16aXAtbm8uY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBeUQsTUFBTSxlQUFlLENBQUM7QUFDakcsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBQy9DLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQTtBQUU3RDtJQUt5QywrQ0FBcUI7SUFLNUQ7UUFBQSxZQUNFLGlCQUFPLFNBR1I7UUFSTSxxQkFBZSxHQUFZLEtBQUssQ0FBQztRQUNqQyxrQkFBWSxHQUFXLGNBQWMsQ0FBQztRQUszQyxLQUFJLENBQUMsT0FBTyxHQUFHLFlBQVksQ0FBQztRQUM1QixLQUFJLENBQUMsU0FBUyxHQUFHLENBQUMsQ0FBQzs7SUFDckIsQ0FBQzs7Ozs7SUFFTSx5Q0FBVzs7OztJQUFsQixVQUFtQixPQUFzQjtRQUN2QyxJQUFJLE9BQU8sQ0FBQyxLQUFLLEVBQUU7WUFDakIsSUFBRyxPQUFPLENBQUMsS0FBSyxDQUFDLFlBQVksRUFBRTtnQkFDN0IsSUFBSSxPQUFPLENBQUMsS0FBSyxDQUFDLFlBQVksSUFBSSxPQUFPLENBQUMsS0FBSyxDQUFDLGFBQWE7dUJBQ3hELE9BQU8sQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDLE1BQU0sSUFBSSxJQUFJLENBQUMsU0FBUyxFQUFFO29CQUN4RCxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQTtpQkFDekQ7YUFDRjtTQUNGO0lBQ0gsQ0FBQzs7OztJQUVNLHNDQUFROzs7SUFBZjtRQUNFLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztJQUVo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Z2VzLCBTaW1wbGVDaGFuZ2VzLCBBZnRlckNvbnRlbnRDaGVja2VkIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFNIQ3RsQ29tbW9uIH0gZnJvbSAnLi4vc2gtY3RsLWNvbW1vbic7XHJcbmltcG9ydCB7IFNIRm9ybUNvbnRyb2wgfSBmcm9tICcuLi8uLi91dGlsaXRpZXMvU2hGb3JtQ29udHJvbCdcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnc2gtY3RsLXppcC1ubycsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL3NoLWN0bC16aXAtbm8uY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczogWycuL3NoLWN0bC16aXAtbm8uY29tcG9uZW50LmNzcycsICcuLi8uLi8uLi9zdHlsZS5jb21tb24uY3NzJ11cclxufSlcclxuZXhwb3J0IGNsYXNzIFNIQ3RsWmlwTm9Db21wb25lbnQgZXh0ZW5kcyBTSEZvcm1Db250cm9sPHN0cmluZz4gaW1wbGVtZW50cyBPbkNoYW5nZXMsIE9uSW5pdCwgQWZ0ZXJDb250ZW50Q2hlY2tlZCB7XHJcbiAgcHVibGljIGlzVmFsaWRhdGVFcnJvcjogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIHB1YmxpYyBlcnJvck1lc3NhZ2U6IHN0cmluZyA9IFwiM+ahgeOBizfmoYHjga7jgb/mnInlirnjgafjgZnjgIJcIjtcclxuICBwdWJsaWMgc3RyaW5nVmFsdWU6IGFueTtcclxuXHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICBzdXBlcigpO1xyXG4gICAgdGhpcy5jdGxOYW1lID0gXCJTSEN0bFppcE5vXCI7XHJcbiAgICB0aGlzLm1heGxlbmd0aCA9IDc7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgaWYgKGNoYW5nZXMudmFsdWUpIHtcclxuICAgICAgaWYoY2hhbmdlcy52YWx1ZS5jdXJyZW50VmFsdWUpIHtcclxuICAgICAgICBpZiAoY2hhbmdlcy52YWx1ZS5jdXJyZW50VmFsdWUgIT0gY2hhbmdlcy52YWx1ZS5wcmV2aW91c1ZhbHVlXHJcbiAgICAgICAgICAmJiBjaGFuZ2VzLnZhbHVlLmN1cnJlbnRWYWx1ZS5sZW5ndGggPT0gdGhpcy5tYXhsZW5ndGgpIHtcclxuICAgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLndpdGhIeXBoZW4oY2hhbmdlcy52YWx1ZS5jdXJyZW50VmFsdWUpXHJcbiAgICAgICAgfSAgXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHB1YmxpYyBuZ09uSW5pdCgpIHtcclxuICAgIHRoaXMub25Jbml0KCk7XHJcblxyXG4gIH1cclxuXHJcbiAgcHVibGljIG5nQWZ0ZXJDb250ZW50Q2hlY2tlZCgpIHtcclxuICAgIGlmICh0aGlzLnZhbHVlICE9IG51bGwpIHtcclxuICAgICAgdGhpcy5jaGFuZ2VGb3JtYXQodGhpcy52YWx1ZSk7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogb25JbnB1dFxyXG4gICAqIEBwYXJhbSBldmVudCBpbnB1dFxyXG4gICAqL1xyXG4gIHB1YmxpYyBvbklucHV0KGV2ZW50KSB7XHJcbiAgICBTSEN0bENvbW1vbi5yZXBsYWNlU3BhY2UoZXZlbnQpO1xyXG4gICAgU0hDdGxDb21tb24ucmVwbGFjZUZVbGxTcGFjZShldmVudCk7XHJcbiAgICBTSEN0bENvbW1vbi5yZXBsYWNlU2lnbihldmVudCk7XHJcbiAgICBTSEN0bENvbW1vbi5yZXBsYWNlRnVsbFdpZHRoKGV2ZW50KTtcclxuICAgIFNIQ3RsQ29tbW9uLnJlcGxhY2VIYWxmV2lkdGgoZXZlbnQpO1xyXG4gICAgU0hDdGxDb21tb24uc2xpY2VMZW5ndGgoZXZlbnQsIHRoaXMubWF4bGVuZ3RoKTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBvbkNsaWNrXHJcbiAgICogQHBhcmFtIGV2ZW50IGNsaWNrXHJcbiAgICovXHJcbiAgcHVibGljIG9uQ2xpY2soZXZlbnQpIHtcclxuICAgIHRoaXMub25CZWZvcmVDbGljayhldmVudCk7XHJcblxyXG4gICAgdGhpcy5vbkFmdGVyQ2xpY2soZXZlbnQpO1xyXG5cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIG9uRm9jdXNcclxuICAgKiBAcGFyYW0gZXZlbnQgZm9jdXNcclxuICAgKi9cclxuICBwdWJsaWMgb25Gb2N1cyhldmVudCkge1xyXG4gICAgdGhpcy5vbkJlZm9yZUZvY3VzKGV2ZW50KTtcclxuXHJcbiAgICBpZiAoIWV2ZW50LnRhcmdldC52YWx1ZSkge1xyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHt0aGlzLm9uQWZ0ZXJGb2N1cyhldmVudCl9LCAwKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgZXZlbnQudGFyZ2V0LnZhbHVlID0gdGhpcy53aXRob3V0SHlwaGVuKGV2ZW50LnRhcmdldC52YWx1ZSlcclxuICAgIGV2ZW50LnRhcmdldC5zZWxlY3QoKTtcclxuXHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHt0aGlzLm9uQWZ0ZXJGb2N1cyhldmVudCl9LCAwKTtcclxuICAgIHJldHVybiB0cnVlO1xyXG5cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIG9uQmx1clxyXG4gICAqIEBwYXJhbSBldmVudCBibHVyXHJcbiAgICovXHJcbiAgcHVibGljIG9uQmx1cihldmVudCkge1xyXG4gICAgdGhpcy5vbkJlZm9yZUJsdXIoZXZlbnQpO1xyXG5cclxuICAgIGlmICghZXZlbnQudGFyZ2V0LnZhbHVlKSB7XHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge3RoaXMub25BZnRlckJsdXIoZXZlbnQpO30sIDApOztcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGV2ZW50LnRhcmdldC52YWx1ZSA9IHRoaXMud2l0aEh5cGhlbihldmVudC50YXJnZXQudmFsdWUpXHJcblxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7dGhpcy5vbkFmdGVyQmx1cihldmVudCk7fSwgMCk7O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogb25DaGFuZ2VcclxuICAgKiBAcGFyYW0gZXZlbnQgY2hhbmdlXHJcbiAgICovXHJcbiAgcHVibGljIG9uQ2hhbmdlKGV2ZW50KSB7XHJcbiAgICB0aGlzLm9uQmVmb3JlQ2hhbmdlKGV2ZW50KTtcclxuXHJcbiAgICAvL+WFpeWKm+ahgeaVsOOBjOmWk+mBleOBo+OBpuOBhOOCi+WgtOWQiOOBq+OAgeiHquOCs+ODs+ODneODvOODjeODs+ODiOOBq+ODleOCqeODvOOCq+OCueOCkuaIu+OBmVxyXG4gICAgaWYgKGV2ZW50LnRhcmdldC52YWx1ZS5sZW5ndGggIT0gMCAmJiBldmVudC50YXJnZXQudmFsdWUubGVuZ3RoICE9IDMgJiYgZXZlbnQudGFyZ2V0LnZhbHVlLmxlbmd0aCAhPSA3KSB7ICAgICAgXHJcbiAgICAgIGV2ZW50LnRhcmdldC52YWx1ZSA9IFwiXCI7XHJcbiAgICAgIGxldCBpbnB1dFZhbHVlID0gPEhUTUxJbnB1dEVsZW1lbnQ+ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgdGV4dGFyZWFbbmFtZT1gICsgdGhpcy5jdGxOYW1lICsgYF0sIGlucHV0W25hbWU9YCArIHRoaXMuY3RsTmFtZSArIGBdYCk7XHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge2lucHV0VmFsdWUuZm9jdXMoKTt9LCAxMCk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy52YWx1ZUNoYW5nZS5lbWl0KGV2ZW50LnRhcmdldC52YWx1ZSk7XHJcblxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7dGhpcy5vbkFmdGVyQ2hhbmdlKGV2ZW50KX0sIDApO1xyXG4gIH1cclxuICBcclxuICAvKipcclxuICAgKiDjg4/jgqTjg5Xjg7Pku5jkuI7nt6jpm4ZcclxuICAgKiBAcGFyYW0gaW5wdXRUYXJnZXRWYWx1ZSBldmVudC50YXJnZXQudmFsdWVcclxuICAgKi9cclxuICBwdWJsaWMgd2l0aEh5cGhlbihpbnB1dFRhcmdldFZhbHVlKTogc3RyaW5nIHtcclxuICAgIGlucHV0VGFyZ2V0VmFsdWUgPSBpbnB1dFRhcmdldFZhbHVlLnJlcGxhY2UoL1xcIHxcXC0vZywgXCJcIik7XHJcblxyXG4gICAgaWYgKFNIQ3RsQ29tbW9uLmlzQmxhbmsoaW5wdXRUYXJnZXRWYWx1ZSkpIHtcclxuICAgICAgcmV0dXJuIFwiXCI7XHJcbiAgICB9XHJcbiAgICBpbnB1dFRhcmdldFZhbHVlID0gaW5wdXRUYXJnZXRWYWx1ZS5yZXBsYWNlKC9bIVwiIyQlJicoKVxcKlxcK1xcLixcXC86Ozw9Pj9AXFxbXFxcXFxcXV5fYHt8fX5hLXpBLVpdL2csIFwiXCIpO1xyXG4gICAgaW5wdXRUYXJnZXRWYWx1ZSA9IGlucHV0VGFyZ2V0VmFsdWUucmVwbGFjZSgvW15cXHgwMS1cXHg3RVxceEExLVxceERGXS9nLCBcIlwiKTtcclxuICAgIGlmIChpc05hTihpbnB1dFRhcmdldFZhbHVlKSkge1xyXG4gICAgICByZXR1cm4gXCJcIjtcclxuICAgIH1cclxuICAgIGxldCB6aXBjZCA9IGlucHV0VGFyZ2V0VmFsdWUudG9TdHJpbmcoKTtcclxuICAgIGlmICh6aXBjZC5tYXRjaCgvXlxcZHszfS0/XFxkezR9JC8pKSB7XHJcbiAgICAgIHppcGNkID0gemlwY2Quc3Vic3RyKDAsIDMpICsgXCItXCIgKyB6aXBjZC5zdWJzdHIoMylcclxuICAgIH1cclxuICAgIHJldHVybiB6aXBjZDtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDjg4/jgqTjg5Xjg7PpmaTljrvnt6jpm4ZcclxuICAgKiBAcGFyYW0gaW5wdXRUYXJnZXRWYWx1ZSBldmVudC50YXJnZXQudmFsdWVcclxuICAgKi9cclxuICBwdWJsaWMgd2l0aG91dEh5cGhlbihpbnB1dFRhcmdldFZhbHVlKSB7XHJcbiAgICByZXR1cm4gbmV3IFN0cmluZyhpbnB1dFRhcmdldFZhbHVlKS5yZXBsYWNlKC8tL2csIFwiXCIpO1xyXG5cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOODleOCqeODvOODnuODg+ODiOe3qOmbhlxyXG4gICAqIEBwYXJhbSB2YWx1ZSB0aGlzLnZhbHVlXHJcbiAgICovXHJcbiAgcHVibGljIGNoYW5nZUZvcm1hdCh2YWx1ZSkge1xyXG4gICAgaWYgKCF2YWx1ZSkge1xyXG4gICAgICB0aGlzLnN0cmluZ1ZhbHVlID0gXCJcIjtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgbGV0IG51bGxGaXJzdFN0cmluZyA9IG51bGw7XHJcbiAgICBsZXQgbnVsbExhc3RTdHJpbmcgPSBudWxsO1xyXG4gICAgbnVsbEZpcnN0U3RyaW5nID0gdmFsdWUuc2xpY2UoMCwgMyk7XHJcbiAgICBudWxsTGFzdFN0cmluZyA9IHZhbHVlLnNsaWNlKC00KTtcclxuICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBTdHJpbmcobnVsbEZpcnN0U3RyaW5nICsgXCItXCIgKyBudWxsTGFzdFN0cmluZyk7XHJcbiAgfVxyXG59XHJcbiJdfQ==