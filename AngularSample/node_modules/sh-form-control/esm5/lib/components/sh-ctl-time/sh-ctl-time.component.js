/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, Input } from '@angular/core';
import { SHCtlCommon } from '../sh-ctl-common';
import { SHFormControl } from '../../utilities/ShFormControl';
var SHCtlTimeComponent = /** @class */ (function (_super) {
    tslib_1.__extends(SHCtlTimeComponent, _super);
    function SHCtlTimeComponent() {
        var _this = _super.call(this) || this;
        _this.obj = ".ShCtlTime";
        _this.adjust = 1;
        _this.isValidateError = false;
        _this.errorMessage = "無効な日付です";
        _this.isFirst = true;
        _this.format = SHCtlCommon.Const.timeFormat.HHMM;
        //直前の値保持
        _this.timeStrage = null;
        _this.ctlName = "SHCtlTime";
        return _this;
    }
    /**
     * @return {?}
     */
    SHCtlTimeComponent.prototype.ngAfterContentChecked = /**
     * @return {?}
     */
    function () {
        if (this.value != null) {
            /** @type {?} */
            var date = this.value.split(':');
            switch (this.format) {
                case SHCtlCommon.Const.timeFormat.HH:
                    this.stringValue = "" + date[0];
                    break;
                case SHCtlCommon.Const.timeFormat.HHMM:
                    this.stringValue = date[0] + ":" + (date.length > 1 ? date[1] : "00");
                    break;
                case SHCtlCommon.Const.timeFormat.HH:
                    this.stringValue = date[0] + ":" + (date.length > 1 ? date[1] : "00") + ":" + (date.length > 2 ? date[2] : "00");
                    break;
                default:
                    break;
            }
        }
    };
    /**
     * @return {?}
     */
    SHCtlTimeComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.onInit();
    };
    /**
     * onInput
     * @param event input
     */
    /**
     * onInput
     * @param {?} event input
     * @return {?}
     */
    SHCtlTimeComponent.prototype.onInput = /**
     * onInput
     * @param {?} event input
     * @return {?}
     */
    function (event) {
        this.timecalculation(event);
    };
    /**
     * onClick
     * @param event click
     */
    /**
     * onClick
     * @param {?} event click
     * @return {?}
     */
    SHCtlTimeComponent.prototype.onClick = /**
     * onClick
     * @param {?} event click
     * @return {?}
     */
    function (event) {
        this.onBeforeClick(event);
        this.onAfterClick(event);
    };
    /**
     * onFocus
     * @param event focus
     */
    /**
     * onFocus
     * @param {?} event focus
     * @return {?}
     */
    SHCtlTimeComponent.prototype.onFocus = /**
     * onFocus
     * @param {?} event focus
     * @return {?}
     */
    function (event) {
        var _this = this;
        this.onBeforeFocus(event);
        event.target.select();
        setTimeout((/**
         * @return {?}
         */
        function () { _this.onAfterFocus(event); }), 0);
    };
    /**
     * onBlur
     * @param event blur
     */
    /**
     * onBlur
     * @param {?} event blur
     * @return {?}
     */
    SHCtlTimeComponent.prototype.onBlur = /**
     * onBlur
     * @param {?} event blur
     * @return {?}
     */
    function (event) {
        var _this = this;
        this.onBeforeBlur(event);
        /** @type {?} */
        var val = event.target.value;
        if (val) {
            //HH形式の場合
            if (val.length == 2)
                val += ":00:00";
            //HHMM形式の場合
            if (val.length == 5)
                val += ":00";
        }
        if (this.timeStrage != val) {
            this.onBeforeChange(event);
            this.valueChange.emit(val);
        }
        this.timeStrage = val;
        setTimeout((/**
         * @return {?}
         */
        function () { _this.onAfterBlur(event); }), 0);
    };
    /**
     * onKeypress
     * @param event keypress
     */
    /**
     * onKeypress
     * @param {?} event keypress
     * @return {?}
     */
    SHCtlTimeComponent.prototype.onKeypress = /**
     * onKeypress
     * @param {?} event keypress
     * @return {?}
     */
    function (event) {
        this.timecalculation(event);
    };
    /**
     * onChange
     * @param event change
     */
    /**
     * onChange
     * @param {?} event change
     * @return {?}
     */
    SHCtlTimeComponent.prototype.onChange = /**
     * onChange
     * @param {?} event change
     * @return {?}
     */
    function (event) {
    };
    /**
     * キーイベント系
     * /キーを押すことで現在時刻をセット
     * @param event keypress
     */
    /**
     * キーイベント系
     * /キーを押すことで現在時刻をセット
     * @private
     * @param {?} event keypress
     * @return {?}
     */
    SHCtlTimeComponent.prototype.timecalculation = /**
     * キーイベント系
     * /キーを押すことで現在時刻をセット
     * @private
     * @param {?} event keypress
     * @return {?}
     */
    function (event) {
        if (event.key === SHCtlCommon.Const.keyCodes.signs[191]) {
            event.target.value = this.setCurrentTime();
            this.onChange(event);
        }
    };
    /**
     * 現在時刻の設定
     * @param event keypress
     */
    /**
     * 現在時刻の設定
     * @private
     * @return {?}
     */
    SHCtlTimeComponent.prototype.setCurrentTime = /**
     * 現在時刻の設定
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var newDate = new Date();
        /** @type {?} */
        var nullFirstString = null;
        /** @type {?} */
        var nullLastString = null;
        nullFirstString = SHCtlCommon.padding(newDate.getHours(), 2); // HH
        nullLastString = SHCtlCommon.padding(newDate.getMinutes(), 2); // HH:MM
        // HH:MM
        /** @type {?} */
        var stringValue = String(nullFirstString + ":" + nullLastString);
        return stringValue;
    };
    SHCtlTimeComponent.decorators = [
        { type: Component, args: [{
                    selector: 'sh-ctl-time',
                    template: "<ng-container *ngIf=\"!onlyField; else onlyFieldControl\">\r\n  <div *ngIf=\"!isDisabled\" (focusin)=\"onFocusin($event)\" (focusout)=\"onFocusout($event)\">\r\n    <mat-form-field class=\"mat-validation\" [floatLabel]=\"floatLabel\">\r\n      <input #inputElm matInput [placeholder]=\"title\" [required]=\"required\" type=\"time\" step=\"{{format}}\" max=\"23:59\" [(ngModel)]=\"value\"\r\n        attr.name=\"{{ctlName}}\" class=\"form-control ShCtlTime can-moved-with-the-enter-key  {{strClass}}\"\r\n        (input)=\"onInput($event)\" (click)=\"onClick($event)\" (focus)=\"onFocus($event)\" (blur)=\"onBlur($event)\"\r\n        autocomplete=\"off\" (change)=\"onChange($event)\" [disabled]=\"disabled\" (keypress)=\"onKeypress($event)\"\r\n        [class.isValidateError]=\"isValidateError\" maxlength=\"{{maxlength}}\" [ngStyle]=\"styles\" [ngClass]=\"objClass\" >\r\n      <button mat-button class=\"closeButton\" type=\"button\" *ngIf=\"inputElm.value && !inputElm.readOnly && !inputElm.disabled\" matSuffix mat-icon-button\r\n        aria-label=\"Clear\" (mousedown)=\"clearValue()\" (keydown)=\"clickClearButton($event)\">\r\n        <mat-icon>close</mat-icon>\r\n      </button>\r\n    </mat-form-field>\r\n    <span class=\"custom-alert-message\">{{message.toString().split(',').join(' ')}}</span>\r\n  </div>\r\n</ng-container>\r\n\r\n<ng-template #onlyFieldControl>\r\n  <div class=\"only-field\" (focusin)=\"onFocusin($event)\" (focusout)=\"onFocusout($event)\">\r\n    <input #inputElm matInput [required]=\"required\" type=\"time\" step=\"{{format}}\" max=\"23:59\" [(ngModel)]=\"value\"\r\n      attr.name=\"{{ctlName}}\" class=\"form-control ShCtlTime can-moved-with-the-enter-key  {{strClass}}\"\r\n      (input)=\"onInput($event)\" (click)=\"onClick($event)\" (focus)=\"onFocus($event)\" (blur)=\"onBlur($event)\"\r\n      autocomplete=\"off\" (change)=\"onChange($event)\" [disabled]=\"disabled\" (keypress)=\"onKeypress($event)\"\r\n      [class.isValidateError]=\"isValidateError\" maxlength=\"{{maxlength}}\" [ngStyle]=\"styles\" [ngClass]=\"objClass\" >\r\n    <button mat-button class=\"closeButton\" type=\"button\" *ngIf=\"inputElm.value && !inputElm.readOnly && !inputElm.disabled\" matSuffix mat-icon-button\r\n      aria-label=\"Clear\" (mousedown)=\"clearValue()\" (keydown)=\"clickClearButton($event)\">\r\n      <mat-icon>close</mat-icon>\r\n    </button>\r\n  </div>\r\n</ng-template>\r\n\r\n<div *ngIf=\"isDisabled\" class=\"display-ctl-view\">\r\n  <div>\r\n    <div *ngIf=\"title\" class=\"display-ctl-view\">\r\n      <div class=\"display-result\" [ngStyle]=\"{'width.px': labelWidth}\" fxLayout=\"row wrap\" fxFlex>\r\n        <div fxFlex class=\"item-title\"><strong>{{title}}:</strong></div>\r\n      </div>\r\n      <div fxFlex class=\"valueOutput\" type=\"time\">\r\n        {{stringValue}}\r\n      </div>\r\n    </div>\r\n\r\n    <div *ngIf=\"!title\" class=\"display-ctl-view notitle-value\">\r\n      <div fxFlex class=\"valueOutput\">\r\n        {{stringValue}}\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n",
                    styles: [".isValidateError{border:1px solid red}.alert-danger{background-color:#ffd2ff}.display-ctl-view{display:-webkit-box;display:flex}.display-result{margin-left:30px}.valueOutput{-webkit-box-flex:1;flex:1;padding-top:4px}.notitle-value{width:100%;margin-left:30px}.ShCtlTime{float:left}mat-form-field .closeButton{position:absolute;right:20px;bottom:5px}", ".sh-flex{width:100%;display:-webkit-inline-box;display:inline-flex}.sh-flex-center{-webkit-box-align:center;align-items:center}.sh-flex-between{-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:center;align-items:center}.display-ctl-view{margin-top:20px}.overlay{position:fixed;display:-webkit-box;display:flex;top:0;left:0;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center;height:100%;width:100%;color:gray;background-color:rgba(0,0,0,.5);z-index:9999}.loader-text{display:block;color:#f3f3f3;margin-top:1em}.mat-dialog-content{overflow:hidden;max-height:none}.sh-dialog-content{height:85%}.sh-kbn-dialog-table-container{height:92%;overflow-y:scroll;margin-top:18px;margin-bottom:18px}.sh-dialog-table-container{display:-webkit-box;display:flex;height:83%;overflow-y:scroll;margin-top:18px;margin-bottom:18px}.sh-text-center{text-align:center}.sh-width-100{width:100%}.sh-label{display:block}.custom-alert-message{top:-20px;position:relative;font-size:.75em;color:rgba(0,0,0,.54)}.result-input,.sh-label{color:rgba(0,0,0,.87)}::ng-deep .mat-form-field-label span{color:rgba(0,0,0,.87)}::ng-deep .result-container .mat-form-field-flex{background-color:#ccdcff}.sh-ctl-state-primary::ng-deep .mat-form-field-label{color:#3f51b5}.sh-ctl-state-primary::ng-deep .mat-form-field-underline{background-color:#3f51b5}.sh-ctl-state-primary-message{color:#3f51b5}.sh-ctl-state-secondary::ng-deep .mat-form-field-label{color:#ff4081}.sh-ctl-state-secondary::ng-deep .mat-form-field-underline{background-color:#ff4081}.sh-ctl-state-secondary-message{color:#ff4081}.sh-ctl-state-success::ng-deep .mat-form-field-label{color:#0dad17}.sh-ctl-state-success::ng-deep .mat-form-field-underline{background-color:#0dad17}.sh-ctl-state-success-message{color:#0dad17}.sh-ctl-state-danger::ng-deep .mat-form-field-label{color:#f44336}.sh-ctl-state-danger::ng-deep .mat-form-field-underline{background-color:#f44336}.sh-ctl-state-danger-message{color:#f44336}.sh-ctl-state-warning::ng-deep .mat-form-field-label{color:#e29f2b}.sh-ctl-state-warning::ng-deep .mat-form-field-underline{background-color:#e29f2b}.sh-ctl-state-warning-message{color:#e29f2b}.sh-container{position:relative;width:100%;height:100%}.only-field{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;width:100%;height:100%;min-height:28px}.only-field input,.only-field textarea{font:inherit;background:0 0;color:currentColor;border:none;outline:0;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit}.only-field-danger{background-color:#f44336}.only-field-warning{background-color:#e29f2b}.only-field-success{background-color:#0dad17}::ng-deep .only-field .material-icons{font-size:13px}::ng-deep .only-field .mat-button{position:relative;width:24px;height:24px}::ng-deep .only-field .mat-icon-button{position:relative;width:24px;height:24px}::ng-deep .only-field .mat-icon{position:absolute;top:0;left:0}::ng-deep .only-field .mat-datepicker-toggle-default-icon{position:absolute;top:25%;left:0;right:0;bottom:0;margin-left:auto;margin-right:auto}::ng-deep .mat-datepicker-toggle span svg{width:16px;height:16px}.only-label{background-color:#ccdcff;position:relative}.only-label mat-icon{position:absolute;top:25%;left:0;right:0;bottom:0;margin-left:auto;font-size:16px}.bind-flg__input{opacity:0;height:0;width:0;position:absolute;z-index:-100}"]
                }] }
    ];
    /** @nocollapse */
    SHCtlTimeComponent.ctorParameters = function () { return []; };
    SHCtlTimeComponent.propDecorators = {
        format: [{ type: Input }]
    };
    return SHCtlTimeComponent;
}(SHFormControl));
export { SHCtlTimeComponent };
if (false) {
    /** @type {?} */
    SHCtlTimeComponent.prototype.obj;
    /** @type {?} */
    SHCtlTimeComponent.prototype.adjust;
    /** @type {?} */
    SHCtlTimeComponent.prototype.isValidateError;
    /** @type {?} */
    SHCtlTimeComponent.prototype.errorMessage;
    /** @type {?} */
    SHCtlTimeComponent.prototype.stringValue;
    /** @type {?} */
    SHCtlTimeComponent.prototype.isFirst;
    /** @type {?} */
    SHCtlTimeComponent.prototype.format;
    /**
     * @type {?}
     * @private
     */
    SHCtlTimeComponent.prototype.timeStrage;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2gtY3RsLXRpbWUuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vc2gtZm9ybS1jb250cm9sLyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvc2gtY3RsLXRpbWUvc2gtY3RsLXRpbWUuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxLQUFLLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDekQsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBQy9DLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSwrQkFBK0IsQ0FBQTtBQUU3RDtJQUt3Qyw4Q0FBcUI7SUFZM0Q7UUFBQSxZQUNFLGlCQUFPLFNBRVI7UUFkTSxTQUFHLEdBQVcsWUFBWSxDQUFDO1FBQzNCLFlBQU0sR0FBVyxDQUFDLENBQUM7UUFDbkIscUJBQWUsR0FBWSxLQUFLLENBQUM7UUFDakMsa0JBQVksR0FBVyxTQUFTLENBQUM7UUFFakMsYUFBTyxHQUFZLElBQUksQ0FBQztRQUNmLFlBQU0sR0FBVyxXQUFXLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUM7O1FBRzNELGdCQUFVLEdBQVcsSUFBSSxDQUFDO1FBSWhDLEtBQUksQ0FBQyxPQUFPLEdBQUcsV0FBVyxDQUFDOztJQUM3QixDQUFDOzs7O0lBRU0sa0RBQXFCOzs7SUFBNUI7UUFDRSxJQUFJLElBQUksQ0FBQyxLQUFLLElBQUksSUFBSSxFQUFFOztnQkFDbEIsSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQztZQUNoQyxRQUFPLElBQUksQ0FBQyxNQUFNLEVBQUM7Z0JBQ2pCLEtBQUssV0FBVyxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsRUFBRTtvQkFDbEMsSUFBSSxDQUFDLFdBQVcsR0FBRyxLQUFHLElBQUksQ0FBQyxDQUFDLENBQUcsQ0FBQTtvQkFDL0IsTUFBTTtnQkFDUixLQUFL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LCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgU0hDdGxDb21tb24gfSBmcm9tICcuLi9zaC1jdGwtY29tbW9uJztcclxuaW1wb3J0IHsgU0hGb3JtQ29udHJvbCB9IGZyb20gJy4uLy4uL3V0aWxpdGllcy9TaEZvcm1Db250cm9sJ1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdzaC1jdGwtdGltZScsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL3NoLWN0bC10aW1lLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi9zaC1jdGwtdGltZS5jb21wb25lbnQuY3NzJywgJy4uLy4uLy4uL3N0eWxlLmNvbW1vbi5jc3MnXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgU0hDdGxUaW1lQ29tcG9uZW50IGV4dGVuZHMgU0hGb3JtQ29udHJvbDxzdHJpbmc+IGltcGxlbWVudHMgT25Jbml0IHtcclxuICBwdWJsaWMgb2JqOiBzdHJpbmcgPSBcIi5TaEN0bFRpbWVcIjtcclxuICBwdWJsaWMgYWRqdXN0OiBudW1iZXIgPSAxO1xyXG4gIHB1YmxpYyBpc1ZhbGlkYXRlRXJyb3I6IGJvb2xlYW4gPSBmYWxzZTtcclxuICBwdWJsaWMgZXJyb3JNZXNzYWdlOiBzdHJpbmcgPSBcIueEoeWKueOBquaXpeS7mOOBp+OBmVwiO1xyXG4gIHB1YmxpYyBzdHJpbmdWYWx1ZTogYW55O1xyXG4gIHB1YmxpYyBpc0ZpcnN0OiBib29sZWFuID0gdHJ1ZTtcclxuICBASW5wdXQoKSBwdWJsaWMgZm9ybWF0OiBudW1iZXIgPSBTSEN0bENvbW1vbi5Db25zdC50aW1lRm9ybWF0LkhITU07XHJcblxyXG4gIC8v55u05YmN44Gu5YCk5L+d5oyBXHJcbiAgcHJpdmF0ZSB0aW1lU3RyYWdlOiBzdHJpbmcgPSBudWxsO1xyXG5cclxuICBjb25zdHJ1Y3RvciggICkge1xyXG4gICAgc3VwZXIoKTtcclxuICAgIHRoaXMuY3RsTmFtZSA9IFwiU0hDdGxUaW1lXCI7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgbmdBZnRlckNvbnRlbnRDaGVja2VkKCkge1xyXG4gICAgaWYgKHRoaXMudmFsdWUgIT0gbnVsbCkge1xyXG4gICAgICB2YXIgZGF0ZSA9IHRoaXMudmFsdWUuc3BsaXQoJzonKTtcclxuICAgICAgc3dpdGNoKHRoaXMuZm9ybWF0KXtcclxuICAgICAgICBjYXNlIFNIQ3RsQ29tbW9uLkNvbnN0LnRpbWVGb3JtYXQuSEg6XHJcbiAgICAgICAgICB0aGlzLnN0cmluZ1ZhbHVlID0gYCR7ZGF0ZVswXX1gXHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFNIQ3RsQ29tbW9uLkNvbnN0LnRpbWVGb3JtYXQuSEhNTTpcclxuICAgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBgJHtkYXRlWzBdfTokeyhkYXRlLmxlbmd0aCA+IDEgPyBkYXRlWzFdIDogXCIwMFwiKX1gXHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFNIQ3RsQ29tbW9uLkNvbnN0LnRpbWVGb3JtYXQuSEg6XHJcbiAgICAgICAgICB0aGlzLnN0cmluZ1ZhbHVlID0gYCR7ZGF0ZVswXX06JHsoZGF0ZS5sZW5ndGggPiAxID8gZGF0ZVsxXSA6IFwiMDBcIil9OiR7KGRhdGUubGVuZ3RoID4gMiA/IGRhdGVbMl0gOiBcIjAwXCIpfWBcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIG5nT25Jbml0KCkge1xyXG4gICAgdGhpcy5vbkluaXQoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIG9uSW5wdXRcclxuICAgKiBAcGFyYW0gZXZlbnQgaW5wdXRcclxuICAgKi9cclxuICBwdWJsaWMgb25JbnB1dChldmVudDogYW55KSB7XHJcbiAgICB0aGlzLnRpbWVjYWxjdWxhdGlvbihldmVudCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBvbkNsaWNrXHJcbiAgICogQHBhcmFtIGV2ZW50IGNsaWNrXHJcbiAgICovXHJcbiAgcHVibGljIG9uQ2xpY2soZXZlbnQpIHtcclxuICAgIHRoaXMub25CZWZvcmVDbGljayhldmVudCk7XHJcblxyXG4gICAgdGhpcy5vbkFmdGVyQ2xpY2soZXZlbnQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogb25Gb2N1c1xyXG4gICAqIEBwYXJhbSBldmVudCBmb2N1c1xyXG4gICAqL1xyXG4gIHB1YmxpYyBvbkZvY3VzKGV2ZW50KSB7XHJcbiAgICB0aGlzLm9uQmVmb3JlRm9jdXMoZXZlbnQpO1xyXG5cclxuICAgIGV2ZW50LnRhcmdldC5zZWxlY3QoKTtcclxuXHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHt0aGlzLm9uQWZ0ZXJGb2N1cyhldmVudCl9LCAwKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIG9uQmx1clxyXG4gICAqIEBwYXJhbSBldmVudCBibHVyXHJcbiAgICovXHJcbiAgcHVibGljIG9uQmx1cihldmVudCkge1xyXG4gICAgdGhpcy5vbkJlZm9yZUJsdXIoZXZlbnQpO1xyXG5cclxuICAgIGxldCB2YWwgPSBldmVudC50YXJnZXQudmFsdWVcclxuICAgIGlmICh2YWwpIHtcclxuICAgICAgLy9ISOW9ouW8j+OBruWgtOWQiFxyXG4gICAgICBpZiAodmFsLmxlbmd0aCA9PSAyKVxyXG4gICAgICAgIHZhbCArPSBcIjowMDowMFwiO1xyXG4gICAgICAvL0hITU3lvaLlvI/jga7loLTlkIhcclxuICAgICAgaWYgKHZhbC5sZW5ndGggPT0gNSlcclxuICAgICAgICB2YWwgKz0gXCI6MDBcIjtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodGhpcy50aW1lU3RyYWdlICE9IHZhbCkge1xyXG4gICAgICB0aGlzLm9uQmVmb3JlQ2hhbmdlKGV2ZW50KTtcclxuICAgICAgdGhpcy52YWx1ZUNoYW5nZS5lbWl0KHZhbCk7XHJcbiAgICB9XHJcbiAgICB0aGlzLnRpbWVTdHJhZ2UgPSB2YWw7XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHt0aGlzLm9uQWZ0ZXJCbHVyKGV2ZW50KX0sIDApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogb25LZXlwcmVzc1xyXG4gICAqIEBwYXJhbSBldmVudCBrZXlwcmVzc1xyXG4gICAqL1xyXG4gIHB1YmxpYyBvbktleXByZXNzKGV2ZW50KSB7XHJcbiAgICB0aGlzLnRpbWVjYWxjdWxhdGlvbihldmVudCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBvbkNoYW5nZVxyXG4gICAqIEBwYXJhbSBldmVudCBjaGFuZ2VcclxuICAgKi9cclxuICBwdWJsaWMgb25DaGFuZ2UoZXZlbnQpIHtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDjgq3jg7zjgqTjg5njg7Pjg4jns7tcclxuICAgKiAv44Kt44O844KS5oq844GZ44GT44Go44Gn54++5Zyo5pmC5Yi744KS44K744OD44OIXHJcbiAgICogQHBhcmFtIGV2ZW50IGtleXByZXNzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSB0aW1lY2FsY3VsYXRpb24oZXZlbnQpIHtcclxuICAgIGlmIChldmVudC5rZXkgPT09IFNIQ3RsQ29tbW9uLkNvbnN0LmtleUNvZGVzLnNpZ25zWzE5MV0pIHtcclxuICAgICAgZXZlbnQudGFyZ2V0LnZhbHVlID0gdGhpcy5zZXRDdXJyZW50VGltZSgpO1xyXG4gICAgICB0aGlzLm9uQ2hhbmdlKGV2ZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOePvuWcqOaZguWIu+OBruioreWumlxyXG4gICAqIEBwYXJhbSBldmVudCBrZXlwcmVzc1xyXG4gICAqL1xyXG4gIHByaXZhdGUgc2V0Q3VycmVudFRpbWUoKSB7XHJcbiAgICBsZXQgbmV3RGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICBsZXQgbnVsbEZpcnN0U3RyaW5nID0gbnVsbDtcclxuICAgIGxldCBudWxsTGFzdFN0cmluZyA9IG51bGw7XHJcbiAgICBudWxsRmlyc3RTdHJpbmcgPSBTSEN0bENvbW1vbi5wYWRkaW5nKG5ld0RhdGUuZ2V0SG91cnMoKSwgMik7IC8vIEhIXHJcbiAgICBudWxsTGFzdFN0cmluZyA9IFNIQ3RsQ29tbW9uLnBhZGRpbmcobmV3RGF0ZS5nZXRNaW51dGVzKCksIDIpIC8vIEhIOk1NXHJcbiAgICBsZXQgc3RyaW5nVmFsdWUgPSBTdHJpbmcobnVsbEZpcnN0U3RyaW5nICsgXCI6XCIgKyBudWxsTGFzdFN0cmluZyk7XHJcbiAgICByZXR1cm4gc3RyaW5nVmFsdWU7XHJcbiAgfVxyXG5cclxufVxyXG4iXX0=