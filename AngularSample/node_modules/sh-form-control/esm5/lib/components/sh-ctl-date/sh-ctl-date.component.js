/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component } from "@angular/core";
import { SHFormControl } from "../../utilities/ShFormControl";
import * as moment_ from 'moment';
/** @type {?} */
var moment = moment_;
var SHCtlDateComponent = /** @class */ (function (_super) {
    tslib_1.__extends(SHCtlDateComponent, _super);
    function SHCtlDateComponent() {
        var _this = _super.call(this) || this;
        _this.ctlName = "SHCtlDate";
        return _this;
    }
    /**
     * @return {?}
     */
    SHCtlDateComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.onInit();
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    SHCtlDateComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes.value) {
            if (changes.value.currentValue) {
                /** @type {?} */
                var result = this.getfomatedDate(changes.value.currentValue.replace(/\-/g, '/'));
                this.value = result;
            }
        }
    };
    /**
     * @return {?}
     */
    SHCtlDateComponent.prototype.ngAfterContentChecked = /**
     * @return {?}
     */
    function () {
        if (this.value != null && this.isDisabled) {
            this.stringValue = this.changeFormat(this.value);
        }
    };
    /**
     * onKeypress
     * @param event keyPress
     */
    /**
     * onKeypress
     * @param {?} event keyPress
     * @return {?}
     */
    SHCtlDateComponent.prototype.onKeypress = /**
     * onKeypress
     * @param {?} event keyPress
     * @return {?}
     */
    function (event) {
        this.setCurrentDate(event);
    };
    /**
     * onClick
     * @param event click
     */
    /**
     * onClick
     * @param {?} event click
     * @return {?}
     */
    SHCtlDateComponent.prototype.onClick = /**
     * onClick
     * @param {?} event click
     * @return {?}
     */
    function (event) {
        this.onBeforeClick(event);
        this.onAfterClick(event);
    };
    /**
     * onChange
     * @param event change
     */
    /**
     * onChange
     * @param {?} event change
     * @return {?}
     */
    SHCtlDateComponent.prototype.onChange = /**
     * onChange
     * @param {?} event change
     * @return {?}
     */
    function (event) {
        var _this = this;
        this.onBeforeChange(event);
        /** @type {?} */
        var o = event.target.value;
        this.valueChange.emit(this.getfomatedDate(event.target.value));
        event.target.value = o;
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.onAfterChange(event);
        }), 0);
    };
    /**
     * onFocus
     * @param event focus
     */
    /**
     * onFocus
     * @param {?} event focus
     * @return {?}
     */
    SHCtlDateComponent.prototype.onFocus = /**
     * onFocus
     * @param {?} event focus
     * @return {?}
     */
    function (event) {
        var _this = this;
        this.onBeforeFocus(event);
        event.target.select();
        setTimeout((/**
         * @return {?}
         */
        function () { _this.onAfterFocus(event); }), 0);
    };
    /**
     * onBlur
     * @param event blur
     */
    /**
     * onBlur
     * @param {?} event blur
     * @return {?}
     */
    SHCtlDateComponent.prototype.onBlur = /**
     * onBlur
     * @param {?} event blur
     * @return {?}
     */
    function (event) {
        var _this = this;
        this.onBeforeBlur(event);
        setTimeout((/**
         * @return {?}
         */
        function () { _this.onAfterBlur(event); }), 0);
        ;
    };
    /**
     * 本日日付の設定
     */
    /**
     * 本日日付の設定
     * @param {?} event
     * @return {?}
     */
    SHCtlDateComponent.prototype.setCurrentDate = /**
     * 本日日付の設定
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (event.key === "/") {
            /** @type {?} */
            var d = moment(new Date()).format('YYYY/MM/DD');
            this.value = d;
            event.target.value = d.replace(/\//g, '-');
            this.onChange(event);
        }
    };
    /**
     * 日付データのフォーマット変更を行う
     * @param date 日付データ
     * @return 日付文字列
     */
    /**
     * 日付データのフォーマット変更を行う
     * @private
     * @param {?} date 日付データ
     * @return {?} 日付文字列
     */
    SHCtlDateComponent.prototype.getfomatedDate = /**
     * 日付データのフォーマット変更を行う
     * @private
     * @param {?} date 日付データ
     * @return {?} 日付文字列
     */
    function (date) {
        if (!date)
            return "";
        /** @type {?} */
        var toString = Object.prototype.toString;
        if (toString.call(date) == "[object Date]") {
            var _a = this.paddingDate(date.toLocaleDateString()), year = _a.year, month = _a.month, day = _a.day;
            return year + "/" + month + "/" + day;
        }
        else {
            var _b = this.paddingDate(date), year = _b.year, month = _b.month, day = _b.day;
            if (date.match(/-/))
                return year + "/" + month + "/" + day;
            else
                return year + "-" + month + "-" + day;
        }
    };
    /**
     * 日付文字列の年月日分割オブジェクトを返却する
     * @param dateStr 日付文字列
     * @return 分割オブジェクト(year, month, day)
     */
    /**
     * 日付文字列の年月日分割オブジェクトを返却する
     * @param {?} dateStr 日付文字列
     * @return {?} 分割オブジェクト(year, month, day)
     */
    SHCtlDateComponent.prototype.paddingDate = /**
     * 日付文字列の年月日分割オブジェクトを返却する
     * @param {?} dateStr 日付文字列
     * @return {?} 分割オブジェクト(year, month, day)
     */
    function (dateStr) {
        if (!dateStr)
            return;
        /** @type {?} */
        var dateArr = dateStr.split(/[-/]/);
        /** @type {?} */
        var year = (Array(4).join("0") + dateArr[0]).slice(-4);
        /** @type {?} */
        var month = (Array(2).join('0') + dateArr[1]).slice(-2);
        /** @type {?} */
        var day = (Array(2).join('0') + dateArr[2]).slice(-2);
        return { year: year, month: month, day: day };
    };
    /**
     * フォーマット編集
     * @param value
     */
    /**
     * フォーマット編集
     * @param {?} value
     * @return {?}
     */
    SHCtlDateComponent.prototype.changeFormat = /**
     * フォーマット編集
     * @param {?} value
     * @return {?}
     */
    function (value) {
        if (!value) {
            this.stringValue = "";
            return;
        }
        /** @type {?} */
        var result = moment(new Date(value)).format('YYYY年MM月DD日');
        return result;
    };
    SHCtlDateComponent.decorators = [
        { type: Component, args: [{
                    selector: "sh-ctl-date",
                    template: "<ng-container *ngIf=\"!onlyField; else onlyFieldControl\">\r\n  <div *ngIf=\"!isDisabled\" (focusin)=\"onFocusin($event)\" (focusout)=\"onFocusout($event)\">\r\n    <mat-form-field class=\"mat-validation {{strClass}}\" [floatLabel]=\"floatLabel\">\r\n      <input #inputElm [required]=\"required\" matInput type=\"date\" [placeholder]=\"title\" max=\"9999-12-31\"\r\n        attr.name=\"{{ctlName}}\" (click)=\"onClick($event)\" (change)=\"onChange($event)\" (focus)=\"onFocus($event)\"\r\n        [disabled]=\"disabled\" (keypress)=\"onKeypress($event)\" [(ngModel)]=\"value\"\r\n        maxlength=\"{{maxlength}}\" [ngStyle]=\"styles\" [ngClass]=\"objClass\" class=\"can-moved-with-the-enter-key\">\r\n      <button mat-button *ngIf=\"inputElm.value && !inputElm.readOnly && !inputElm.disabled\" matSuffix mat-icon-button\r\n        aria-label=\"Clear\" (mousedown)=\"clearValue()\" (keydown)=\"clickClearButton($event)\">\r\n        <mat-icon>close</mat-icon>\r\n      </button>\r\n    </mat-form-field>\r\n    <span class=\"custom-alert-message\">{{message.toString().split(',').join(' ')}}</span>\r\n  </div>\r\n</ng-container>\r\n\r\n<ng-template #onlyFieldControl>\r\n  <div class=\"only-field\" (focusin)=\"onFocusin($event)\" (focusout)=\"onFocusout($event)\">\r\n    <input #inputElm [required]=\"required\" matInput type=\"date\" max=\"9999-12-31\"\r\n      attr.name=\"{{ctlName}}\" (click)=\"onClick($event)\" (change)=\"onChange($event)\" (focus)=\"onFocus($event)\"\r\n      [disabled]=\"disabled\" (keypress)=\"onKeypress($event)\" [(ngModel)]=\"value\"\r\n      maxlength=\"{{maxlength}}\" [ngStyle]=\"styles\" [ngClass]=\"objClass\" class=\"can-moved-with-the-enter-key\">\r\n    <button mat-button *ngIf=\"inputElm.value && !inputElm.readOnly && !inputElm.disabled\" matSuffix mat-icon-button\r\n      aria-label=\"Clear\" (mousedown)=\"clearValue()\" (keydown)=\"clickClearButton($event)\">\r\n      <mat-icon>close</mat-icon>\r\n    </button>\r\n  </div>\r\n</ng-template>\r\n\r\n<div *ngIf=\"isDisabled\" class=\"display-ctl-view\">\r\n  <div>\r\n    <div *ngIf=\"title\" class=\"display-ctl-view\">\r\n      <div class=\"display-result\" [ngStyle]=\"{'width.px': labelWidth}\" fxLayout=\"row wrap\" fxFlex>\r\n        <div fxFlex class=\"item-title\"><strong>{{title}}:</strong></div>\r\n      </div>\r\n      <div fxFlex class=\"valueOutput\">\r\n        {{stringValue}}\r\n      </div>\r\n    </div>\r\n\r\n    <div *ngIf=\"!title\" class=\"display-ctl-view notitle-value\">\r\n      <div fxFlex class=\"valueOutput\">\r\n        {{stringValue}}\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n",
                    styles: [".input-group-text{background-color:#fff;border:none}.btn{border:none}.btn.btn-primary:disabled{background-color:#999}.btn-primary{background-color:#17a2b8}.btn-primary:hover{background-color:#1792b8}.fixed-bottom{top:708px;height:65px;max-width:1024px;margin-right:auto;margin-left:auto}.display-ctl-view{display:-webkit-box;display:flex}.display-result{margin-left:30px}.valueOutput{-webkit-box-flex:1;flex:1}.notitle-value{width:100%;margin-left:30px}", ".sh-flex{width:100%;display:-webkit-inline-box;display:inline-flex}.sh-flex-center{-webkit-box-align:center;align-items:center}.sh-flex-between{-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:center;align-items:center}.display-ctl-view{margin-top:20px}.overlay{position:fixed;display:-webkit-box;display:flex;top:0;left:0;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center;height:100%;width:100%;color:gray;background-color:rgba(0,0,0,.5);z-index:9999}.loader-text{display:block;color:#f3f3f3;margin-top:1em}.mat-dialog-content{overflow:hidden;max-height:none}.sh-dialog-content{height:85%}.sh-kbn-dialog-table-container{height:92%;overflow-y:scroll;margin-top:18px;margin-bottom:18px}.sh-dialog-table-container{display:-webkit-box;display:flex;height:83%;overflow-y:scroll;margin-top:18px;margin-bottom:18px}.sh-text-center{text-align:center}.sh-width-100{width:100%}.sh-label{display:block}.custom-alert-message{top:-20px;position:relative;font-size:.75em;color:rgba(0,0,0,.54)}.result-input,.sh-label{color:rgba(0,0,0,.87)}::ng-deep .mat-form-field-label span{color:rgba(0,0,0,.87)}::ng-deep .result-container .mat-form-field-flex{background-color:#ccdcff}.sh-ctl-state-primary::ng-deep .mat-form-field-label{color:#3f51b5}.sh-ctl-state-primary::ng-deep .mat-form-field-underline{background-color:#3f51b5}.sh-ctl-state-primary-message{color:#3f51b5}.sh-ctl-state-secondary::ng-deep .mat-form-field-label{color:#ff4081}.sh-ctl-state-secondary::ng-deep .mat-form-field-underline{background-color:#ff4081}.sh-ctl-state-secondary-message{color:#ff4081}.sh-ctl-state-success::ng-deep .mat-form-field-label{color:#0dad17}.sh-ctl-state-success::ng-deep .mat-form-field-underline{background-color:#0dad17}.sh-ctl-state-success-message{color:#0dad17}.sh-ctl-state-danger::ng-deep .mat-form-field-label{color:#f44336}.sh-ctl-state-danger::ng-deep .mat-form-field-underline{background-color:#f44336}.sh-ctl-state-danger-message{color:#f44336}.sh-ctl-state-warning::ng-deep .mat-form-field-label{color:#e29f2b}.sh-ctl-state-warning::ng-deep .mat-form-field-underline{background-color:#e29f2b}.sh-ctl-state-warning-message{color:#e29f2b}.sh-container{position:relative;width:100%;height:100%}.only-field{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;width:100%;height:100%;min-height:28px}.only-field input,.only-field textarea{font:inherit;background:0 0;color:currentColor;border:none;outline:0;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit}.only-field-danger{background-color:#f44336}.only-field-warning{background-color:#e29f2b}.only-field-success{background-color:#0dad17}::ng-deep .only-field .material-icons{font-size:13px}::ng-deep .only-field .mat-button{position:relative;width:24px;height:24px}::ng-deep .only-field .mat-icon-button{position:relative;width:24px;height:24px}::ng-deep .only-field .mat-icon{position:absolute;top:0;left:0}::ng-deep .only-field .mat-datepicker-toggle-default-icon{position:absolute;top:25%;left:0;right:0;bottom:0;margin-left:auto;margin-right:auto}::ng-deep .mat-datepicker-toggle span svg{width:16px;height:16px}.only-label{background-color:#ccdcff;position:relative}.only-label mat-icon{position:absolute;top:25%;left:0;right:0;bottom:0;margin-left:auto;font-size:16px}.bind-flg__input{opacity:0;height:0;width:0;position:absolute;z-index:-100}"]
                }] }
    ];
    /** @nocollapse */
    SHCtlDateComponent.ctorParameters = function () { return []; };
    return SHCtlDateComponent;
}(SHFormControl));
export { SHCtlDateComponent };
if (false) {
    /** @type {?} */
    SHCtlDateComponent.prototype.stringValue;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2gtY3RsLWRhdGUuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vc2gtZm9ybS1jb250cm9sLyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvc2gtY3RsLWRhdGUvc2gtY3RsLWRhdGUuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBb0MsTUFBTSxlQUFlLENBQUM7QUFDNUUsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBQzlELE9BQU8sS0FBSyxPQUFPLE1BQU0sUUFBUSxDQUFDOztJQUM1QixNQUFNLEdBQUcsT0FBTztBQUV0QjtJQUt3Qyw4Q0FBcUI7SUFHM0Q7UUFBQSxZQUNFLGlCQUFPLFNBRVI7UUFEQyxLQUFJLENBQUMsT0FBTyxHQUFHLFdBQVcsQ0FBQzs7SUFDN0IsQ0FBQzs7OztJQUVNLHFDQUFROzs7SUFBZjtRQUNFLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztJQUNoQixDQUFDOzs7OztJQUVNLHdDQUFXOzs7O0lBQWxCLFVBQW1CLE9BQXNCO1FBQ3ZDLElBQUksT0FBTyxDQUFDLEtBQUssRUFBRTtZQUNqQixJQUFJLE9BQU8sQ0FBQyxLQUFLLENBQUMsWUFBWSxFQUFFOztvQkFDeEIsTUFBTSxHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxHQUFHLENBQUMsQ0FBQztnQkFDbEYsSUFBSSxDQUFDLEtBQUssR0FBRyxNQUFNLENBQUM7YUFDckI7U0FDRjtJQUNILENBQUM7Ozs7SUFFTSxrREFBcUI7OztJQUE1QjtRQUNFLElBQUksSUFBSSxDQUFDLEtBQUssSUFBSSxJQUFJLElBQUksSUFBSSxDQUFDLFVBQVUsRUFBRTtZQUN6QyxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1NB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RCxPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDOztnQkFsSkYsU0FBUyxTQUFDO29CQUNULFFBQVEsRUFBRSxhQUFhO29CQUN2Qiw4a0ZBQTJDOztpQkFFNUM7Ozs7SUErSUQseUJBQUM7Q0FBQSxBQW5KRCxDQUt3QyxhQUFhLEdBOElwRDtTQTlJWSxrQkFBa0I7OztJQUM3Qix5Q0FBd0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uQ2hhbmdlcywgU2ltcGxlQ2hhbmdlcywgT25Jbml0IH0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcclxuaW1wb3J0IHsgU0hGb3JtQ29udHJvbCB9IGZyb20gXCIuLi8uLi91dGlsaXRpZXMvU2hGb3JtQ29udHJvbFwiO1xyXG5pbXBvcnQgKiBhcyBtb21lbnRfIGZyb20gJ21vbWVudCc7XHJcbmNvbnN0IG1vbWVudCA9IG1vbWVudF87XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogXCJzaC1jdGwtZGF0ZVwiLFxyXG4gIHRlbXBsYXRlVXJsOiBcIi4vc2gtY3RsLWRhdGUuY29tcG9uZW50Lmh0bWxcIixcclxuICBzdHlsZVVybHM6IFtcIi4vc2gtY3RsLWRhdGUuY29tcG9uZW50LmNzc1wiLCBcIi4uLy4uLy4uL3N0eWxlLmNvbW1vbi5jc3NcIl0sXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBTSEN0bERhdGVDb21wb25lbnQgZXh0ZW5kcyBTSEZvcm1Db250cm9sPHN0cmluZz4gaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcyB7XHJcbiAgcHVibGljIHN0cmluZ1ZhbHVlOiBhbnk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgc3VwZXIoKTtcclxuICAgIHRoaXMuY3RsTmFtZSA9IFwiU0hDdGxEYXRlXCI7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgbmdPbkluaXQoKSB7XHJcbiAgICB0aGlzLm9uSW5pdCgpO1xyXG4gIH1cclxuICBcclxuICBwdWJsaWMgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgaWYgKGNoYW5nZXMudmFsdWUpIHtcclxuICAgICAgaWYgKGNoYW5nZXMudmFsdWUuY3VycmVudFZhbHVlKSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5nZXRmb21hdGVkRGF0ZShjaGFuZ2VzLnZhbHVlLmN1cnJlbnRWYWx1ZS5yZXBsYWNlKC9cXC0vZywgJy8nKSk7XHJcbiAgICAgICAgdGhpcy52YWx1ZSA9IHJlc3VsdDtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIG5nQWZ0ZXJDb250ZW50Q2hlY2tlZCgpIHtcclxuICAgIGlmICh0aGlzLnZhbHVlICE9IG51bGwgJiYgdGhpcy5pc0Rpc2FibGVkKSB7XHJcbiAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSB0aGlzLmNoYW5nZUZvcm1hdCh0aGlzLnZhbHVlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG5cclxuICAvKipcclxuICAgKiBvbktleXByZXNzXHJcbiAgICogQHBhcmFtIGV2ZW50IGtleVByZXNzXHJcbiAgICovXHJcbiAgcHVibGljIG9uS2V5cHJlc3MoZXZlbnQpIHtcclxuICAgIHRoaXMuc2V0Q3VycmVudERhdGUoZXZlbnQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogb25DbGlja1xyXG4gICAqIEBwYXJhbSBldmVudCBjbGlja1xyXG4gICAqL1xyXG4gIHB1YmxpYyBvbkNsaWNrKGV2ZW50KSB7XHJcbiAgICB0aGlzLm9uQmVmb3JlQ2xpY2soZXZlbnQpO1xyXG5cclxuICAgIHRoaXMub25BZnRlckNsaWNrKGV2ZW50KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIG9uQ2hhbmdlXHJcbiAgICogQHBhcmFtIGV2ZW50IGNoYW5nZVxyXG4gICAqL1xyXG4gIHB1YmxpYyBvbkNoYW5nZShldmVudCkge1xyXG4gICAgdGhpcy5vbkJlZm9yZUNoYW5nZShldmVudCk7XHJcbiAgICBjb25zdCBvID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xyXG4gICAgdGhpcy52YWx1ZUNoYW5nZS5lbWl0KHRoaXMuZ2V0Zm9tYXRlZERhdGUoZXZlbnQudGFyZ2V0LnZhbHVlKSk7XHJcbiAgICBldmVudC50YXJnZXQudmFsdWUgPSBvO1xyXG5cclxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICB0aGlzLm9uQWZ0ZXJDaGFuZ2UoZXZlbnQpO1xyXG4gICAgfSwgMCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBvbkZvY3VzXHJcbiAgICogQHBhcmFtIGV2ZW50IGZvY3VzXHJcbiAgICovXHJcbiAgcHVibGljIG9uRm9jdXMoZXZlbnQpIHtcclxuICAgIHRoaXMub25CZWZvcmVGb2N1cyhldmVudCk7XHJcblxyXG4gICAgZXZlbnQudGFyZ2V0LnNlbGVjdCgpO1xyXG5cclxuICAgIHNldFRpbWVvdXQoKCkgPT4ge3RoaXMub25BZnRlckZvY3VzKGV2ZW50KX0sIDApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogb25CbHVyXHJcbiAgICogQHBhcmFtIGV2ZW50IGJsdXJcclxuICAgKi9cclxuICBwdWJsaWMgb25CbHVyKGV2ZW50KSB7XHJcbiAgICB0aGlzLm9uQmVmb3JlQmx1cihldmVudCk7XHJcblxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7dGhpcy5vbkFmdGVyQmx1cihldmVudCk7fSwgMCk7O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5pys5pel5pel5LuY44Gu6Kit5a6aXHJcbiAgICovXHJcbiAgcHVibGljIHNldEN1cnJlbnREYXRlKGV2ZW50KSB7XHJcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIi9cIikge1xyXG4gICAgICBjb25zdCBkICA9IG1vbWVudChuZXcgRGF0ZSgpKS5mb3JtYXQoJ1lZWVkvTU0vREQnKTtcclxuICAgICAgdGhpcy52YWx1ZSA9IGQ7XHJcbiAgICAgIGV2ZW50LnRhcmdldC52YWx1ZSA9IGQucmVwbGFjZSgvXFwvL2csICctJyk7XHJcbiAgICAgIHRoaXMub25DaGFuZ2UoZXZlbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5pel5LuY44OH44O844K/44Gu44OV44Kp44O844Oe44OD44OI5aSJ5pu044KS6KGM44GGXHJcbiAgICogQHBhcmFtIGRhdGUg5pel5LuY44OH44O844K/XHJcbiAgICogQHJldHVybiDml6Xku5jmloflrZfliJdcclxuICAgKi9cclxuICBwcml2YXRlIGdldGZvbWF0ZWREYXRlKGRhdGUpIHtcclxuICAgIGlmICghZGF0ZSkgcmV0dXJuIFwiXCI7XHJcbiAgICBjb25zdCB0b1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7XHJcbiAgICBpZiAodG9TdHJpbmcuY2FsbChkYXRlKSA9PSBcIltvYmplY3QgRGF0ZV1cIikge1xyXG4gICAgICBjb25zdCB7IHllYXIsIG1vbnRoLCBkYXkgfSA9IHRoaXMucGFkZGluZ0RhdGUoZGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoKSk7XHJcbiAgICAgIHJldHVybiBgJHt5ZWFyfS8ke21vbnRofS8ke2RheX1gO1xyXG4gICAgfSBcclxuICAgIGVsc2Uge1xyXG4gICAgICBjb25zdCB7IHllYXIsIG1vbnRoLCBkYXkgfSA9IHRoaXMucGFkZGluZ0RhdGUoZGF0ZSk7XHJcbiAgICAgIGlmIChkYXRlLm1hdGNoKC8tLykpXHJcbiAgICAgICAgcmV0dXJuIGAke3llYXJ9LyR7bW9udGh9LyR7ZGF5fWA7XHJcbiAgICAgIGVsc2VcclxuICAgICAgICByZXR1cm4gYCR7eWVhcn0tJHttb250aH0tJHtkYXl9YDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOaXpeS7mOaWh+Wtl+WIl+OBruW5tOaciOaXpeWIhuWJsuOCquODluOCuOOCp+OCr+ODiOOCkui/lOWNtOOBmeOCi1xyXG4gICAqIEBwYXJhbSBkYXRlU3RyIOaXpeS7mOaWh+Wtl+WIl1xyXG4gICAqIEByZXR1cm4g5YiG5Ymy44Kq44OW44K444Kn44Kv44OIKHllYXIsIG1vbnRoLCBkYXkpXHJcbiAgICovXHJcbiAgcHVibGljIHBhZGRpbmdEYXRlKGRhdGVTdHI6IHN0cmluZykge1xyXG4gICAgaWYgKCFkYXRlU3RyKSByZXR1cm47XHJcbiAgICBjb25zdCBkYXRlQXJyID0gZGF0ZVN0ci5zcGxpdCgvWy0vXS8pXHJcbiAgICBsZXQgeWVhciA9IChBcnJheSg0KS5qb2luKFwiMFwiKSArIGRhdGVBcnJbMF0pLnNsaWNlKC00KTtcclxuICAgIGNvbnN0IG1vbnRoID0gKEFycmF5KDIpLmpvaW4oJzAnKSArIGRhdGVBcnJbMV0pLnNsaWNlKC0yKTtcclxuICAgIGNvbnN0IGRheSA9IChBcnJheSgyKS5qb2luKCcwJykgKyBkYXRlQXJyWzJdKS5zbGljZSgtMik7XHJcbiAgICByZXR1cm4geyB5ZWFyLCBtb250aCwgZGF5IH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOODleOCqeODvOODnuODg+ODiOe3qOmbhlxyXG4gICAqIEBwYXJhbSB2YWx1ZSBcclxuICAgKi9cclxuICBwdWJsaWMgY2hhbmdlRm9ybWF0KHZhbHVlOiBzdHJpbmcpIHtcclxuICAgIGlmICghdmFsdWUpIHtcclxuICAgICAgdGhpcy5zdHJpbmdWYWx1ZSA9IFwiXCI7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IHJlc3VsdCA9IG1vbWVudChuZXcgRGF0ZSh2YWx1ZSkpLmZvcm1hdCgnWVlZWeW5tE1N5pyIRETml6UnKTtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbiAgfVxyXG59XHJcbiJdfQ==