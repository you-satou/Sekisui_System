/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Inject, Component } from '@angular/core';
import { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material';
import { SHCtlCommon } from '../sh-ctl-common';
/**
 * @record
 */
function Data() { }
if (false) {
    /** @type {?} */
    Data.prototype.dataTitle;
    /** @type {?} */
    Data.prototype.hiddenColumns;
}
var SHCtlPopupDialogComponent = /** @class */ (function () {
    function SHCtlPopupDialogComponent(dialogRef, data) {
        this.dialogRef = dialogRef;
        this.data = data;
        this.displayedColumns = [];
        this.name = "";
        this.uniqueStr = "";
    }
    /**
     * 値がバインドされる時に呼ばれる
     */
    /**
     * 値がバインドされる時に呼ばれる
     * @return {?}
     */
    SHCtlPopupDialogComponent.prototype.ngOnInit = /**
     * 値がバインドされる時に呼ばれる
     * @return {?}
     */
    function () {
        this.init();
    };
    /**
    * 値の初期化
    */
    /**
     * 値の初期化
     * @private
     * @return {?}
     */
    SHCtlPopupDialogComponent.prototype.init = /**
     * 値の初期化
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        this.dataTitle = this.data.dataTitle;
        /** @type {?} */
        var cols = [];
        this.getHashKeys().forEach((/**
         * @param {?} name
         * @param {?} idx
         * @return {?}
         */
        function (name, idx) {
            if (!_this.data.hiddenColumns.find((/**
             * @param {?} _
             * @return {?}
             */
            function (_) { return _ == (idx + 1); })))
                cols.push(name);
        }));
        this.displayedColumns = cols;
        this.uniqueStr = SHCtlCommon.getUniqueStr();
    };
    /**
    * テーブルのヘッダーを編集
    */
    /**
     * テーブルのヘッダーを編集
     * @return {?}
     */
    SHCtlPopupDialogComponent.prototype.ngAfterViewChecked = /**
     * テーブルのヘッダーを編集
     * @return {?}
     */
    function () {
        /** @type {?} */
        var headerElement = document.getElementsByTagName('th');
        /** @type {?} */
        var countBlank = 0;
        if (!this.codesHeader)
            return;
        for (var i = 0; i < headerElement.length; i++) {
            if (this.codesHeader[i] != "") {
                for (var e = 1; e <= countBlank; e++) {
                    headerElement[i - e].style.display = 'none';
                }
                countBlank = 0;
            }
            else if (this.codesHeader[i] === "") {
                countBlank += 1;
                headerElement[i - countBlank].colSpan = countBlank + 1;
                headerElement[i - countBlank].style.textAlign = 'center';
                if (i === headerElement.length - 1) {
                    for (var j = 0; j < countBlank; j++) {
                        headerElement[i - j].style.display = 'none';
                    }
                }
            }
        }
    };
    /**
     * ダイアログを閉じる
     */
    /**
     * ダイアログを閉じる
     * @return {?}
     */
    SHCtlPopupDialogComponent.prototype.closeDialog = /**
     * ダイアログを閉じる
     * @return {?}
     */
    function () {
        this.dialogRef.close();
    };
    /**
     * ポップアップから選択されたデータを親に返す
     * @param item 事業所コード一覧から選択された1つ
     */
    /**
     * ポップアップから選択されたデータを親に返す
     * @param {?} item 事業所コード一覧から選択された1つ
     * @return {?}
     */
    SHCtlPopupDialogComponent.prototype.selectCode = /**
     * ポップアップから選択されたデータを親に返す
     * @param {?} item 事業所コード一覧から選択された1つ
     * @return {?}
     */
    function (item) {
        //ダイアログを閉める時に値を親に渡す
        this.dialogRef.close(item);
    };
    /**
     * データのkeyを返す
     */
    /**
     * データのkeyを返す
     * @return {?}
     */
    SHCtlPopupDialogComponent.prototype.getHashKeys = /**
     * データのkeyを返す
     * @return {?}
     */
    function () {
        if (!this.unchangeableCodes || this.unchangeableCodes.length == 0) {
            return [];
        }
        else {
            return Object.keys(this.unchangeableCodes[0]);
        }
    };
    /**
     * ポップアップ内での曖昧検索
     * スペース区切りで1キーワードとする
     * @param event inputイベント
     */
    /**
     * ポップアップ内での曖昧検索
     * スペース区切りで1キーワードとする
     * @param {?} event inputイベント
     * @return {?}
     */
    SHCtlPopupDialogComponent.prototype.filter = /**
     * ポップアップ内での曖昧検索
     * スペース区切りで1キーワードとする
     * @param {?} event inputイベント
     * @return {?}
     */
    function (event) {
        if (!this.unchangeableCodes)
            return;
        /** @type {?} */
        var filterString = event.target.value;
        /** @type {?} */
        var fileterStrArray = filterString.replace(/　/g, " ").split(" ");
        fileterStrArray = fileterStrArray.filter((/**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            return value;
        }));
        /** @type {?} */
        var resultArray;
        resultArray = this.unchangeableCodes.concat();
        var _loop_1 = function (i) {
            /** @type {?} */
            var obj = this_1;
            resultArray = resultArray.filter((/**
             * @param {?} value
             * @return {?}
             */
            function (value) {
                /** @type {?} */
                var values = Object.values(value);
                var _loop_2 = function (j) {
                    if (obj.data.hiddenColumns.find((/**
                     * @param {?} _
                     * @return {?}
                     */
                    function (_) { return _ == (j + 1); })))
                        return "continue";
                    if (values[j] != null && values[j].toString().match(fileterStrArray[i])) {
                        return { value: true };
                    }
                };
                for (var j = 0; j < values.length; j++) {
                    var state_1 = _loop_2(j);
                    if (typeof state_1 === "object")
                        return state_1.value;
                }
                return false;
            }));
        };
        var this_1 = this;
        for (var i = 0; i < fileterStrArray.length; i++) {
            _loop_1(i);
        }
        this.codes = resultArray;
    };
    SHCtlPopupDialogComponent.decorators = [
        { type: Component, args: [{
                    selector: 'sh-ctl-popup-dialog',
                    template: "<div *ngIf=\"!unchangeableCodes\" class=\"overlay\">\r\n  <mat-spinner></mat-spinner>\r\n  <span class=\"loader-text\">Loading...</span>\r\n</div> \r\n<div class=\"sh-container\" id={{uniqueStr}}>\r\n    <h1 mat-dialog-title class=\"sh-text-center\">{{dataTitle}}</h1>\r\n    <div mat-dialog-content class=\"sh-dialog-content\">\r\n      <mat-form-field class=\"sh-width-100\">\r\n        <input matInput placeholder=\"\u691C\u7D22\u6B04\" (input)=\"filter($event)\"/>\r\n      </mat-form-field>\r\n      <div class=\"sh-dialog-table-container mat-elevation-z8\">\r\n        <table mat-table [dataSource]=\"codes\" class=\"sh-width-100\">\r\n          <span *ngFor=\"let key of getHashKeys(); let i = index\">\r\n            <ng-container matColumnDef=\"{{key}}\">\r\n              <th mat-header-cell *matHeaderCellDef>{{codesHeader[i]}}</th>\r\n              <td mat-cell *matCellDef=\"let element\">{{element[key]}}</td>\r\n            </ng-container>\r\n          </span>\r\n            <tr mat-header-row *matHeaderRowDef=\"displayedColumns; sticky: true\"></tr>\r\n            <tr mat-row *matRowDef=\"let row; columns: displayedColumns;\" (click)=\"selectCode(row)\"></tr>\r\n        </table>\r\n      </div>\r\n    </div>\r\n    <div mat-dialog-actions>\r\n      <button mat-raised-button (click)=\"closeDialog()\">\u623B\u308B</button>\r\n    </div>\r\n  </div>\r\n  ",
                    styles: ["", ".sh-flex{width:100%;display:-webkit-inline-box;display:inline-flex}.sh-flex-center{-webkit-box-align:center;align-items:center}.sh-flex-between{-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:center;align-items:center}.display-ctl-view{margin-top:20px}.overlay{position:fixed;display:-webkit-box;display:flex;top:0;left:0;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center;height:100%;width:100%;color:gray;background-color:rgba(0,0,0,.5);z-index:9999}.loader-text{display:block;color:#f3f3f3;margin-top:1em}.mat-dialog-content{overflow:hidden;max-height:none}.sh-dialog-content{height:85%}.sh-kbn-dialog-table-container{height:92%;overflow-y:scroll;margin-top:18px;margin-bottom:18px}.sh-dialog-table-container{display:-webkit-box;display:flex;height:83%;overflow-y:scroll;margin-top:18px;margin-bottom:18px}.sh-text-center{text-align:center}.sh-width-100{width:100%}.sh-label{display:block}.custom-alert-message{top:-20px;position:relative;font-size:.75em;color:rgba(0,0,0,.54)}.result-input,.sh-label{color:rgba(0,0,0,.87)}::ng-deep .mat-form-field-label span{color:rgba(0,0,0,.87)}::ng-deep .result-container .mat-form-field-flex{background-color:#ccdcff}.sh-ctl-state-primary::ng-deep .mat-form-field-label{color:#3f51b5}.sh-ctl-state-primary::ng-deep .mat-form-field-underline{background-color:#3f51b5}.sh-ctl-state-primary-message{color:#3f51b5}.sh-ctl-state-secondary::ng-deep .mat-form-field-label{color:#ff4081}.sh-ctl-state-secondary::ng-deep .mat-form-field-underline{background-color:#ff4081}.sh-ctl-state-secondary-message{color:#ff4081}.sh-ctl-state-success::ng-deep .mat-form-field-label{color:#0dad17}.sh-ctl-state-success::ng-deep .mat-form-field-underline{background-color:#0dad17}.sh-ctl-state-success-message{color:#0dad17}.sh-ctl-state-danger::ng-deep .mat-form-field-label{color:#f44336}.sh-ctl-state-danger::ng-deep .mat-form-field-underline{background-color:#f44336}.sh-ctl-state-danger-message{color:#f44336}.sh-ctl-state-warning::ng-deep .mat-form-field-label{color:#e29f2b}.sh-ctl-state-warning::ng-deep .mat-form-field-underline{background-color:#e29f2b}.sh-ctl-state-warning-message{color:#e29f2b}.sh-container{position:relative;width:100%;height:100%}.only-field{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;width:100%;height:100%;min-height:28px}.only-field input,.only-field textarea{font:inherit;background:0 0;color:currentColor;border:none;outline:0;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit}.only-field-danger{background-color:#f44336}.only-field-warning{background-color:#e29f2b}.only-field-success{background-color:#0dad17}::ng-deep .only-field .material-icons{font-size:13px}::ng-deep .only-field .mat-button{position:relative;width:24px;height:24px}::ng-deep .only-field .mat-icon-button{position:relative;width:24px;height:24px}::ng-deep .only-field .mat-icon{position:absolute;top:0;left:0}::ng-deep .only-field .mat-datepicker-toggle-default-icon{position:absolute;top:25%;left:0;right:0;bottom:0;margin-left:auto;margin-right:auto}::ng-deep .mat-datepicker-toggle span svg{width:16px;height:16px}.only-label{background-color:#ccdcff;position:relative}.only-label mat-icon{position:absolute;top:25%;left:0;right:0;bottom:0;margin-left:auto;font-size:16px}.bind-flg__input{opacity:0;height:0;width:0;position:absolute;z-index:-100}"]
                }] }
    ];
    /** @nocollapse */
    SHCtlPopupDialogComponent.ctorParameters = function () { return [
        { type: MatDialogRef },
        { type: undefined, decorators: [{ type: Inject, args: [MAT_DIALOG_DATA,] }] }
    ]; };
    return SHCtlPopupDialogComponent;
}());
export { SHCtlPopupDialogComponent };
if (false) {
    /** @type {?} */
    SHCtlPopupDialogComponent.prototype.displayedColumns;
    /** @type {?} */
    SHCtlPopupDialogComponent.prototype.name;
    /** @type {?} */
    SHCtlPopupDialogComponent.prototype.uniqueStr;
    /** @type {?} */
    SHCtlPopupDialogComponent.prototype.dataTitle;
    /** @type {?} */
    SHCtlPopupDialogComponent.prototype.codes;
    /** @type {?} */
    SHCtlPopupDialogComponent.prototype.unchangeableCodes;
    /** @type {?} */
    SHCtlPopupDialogComponent.prototype.codesHeader;
    /**
     * @type {?}
     * @private
     */
    SHCtlPopupDialogComponent.prototype.dialogRef;
    /**
     * @type {?}
     * @private
     */
    SHCtlPopupDialogComponent.prototype.data;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2gtY3RsLXBvcHVwLWRpYWxvZy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9zaC1mb3JtLWNvbnRyb2wvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9zaC1jdGwtcG9wdXAtZGlhbG9nL3NoLWN0bC1wb3B1cC1kaWFsb2cuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBNEIsTUFBTSxlQUFlLENBQUM7QUFDNUUsT0FBTyxFQUFFLFlBQVksRUFBRSxlQUFlLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUNsRSxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sa0JBQWtCLENBQUM7Ozs7QUFFL0MsbUJBR0M7OztJQUZHLHlCQUFpQjs7SUFDakIsNkJBQWtCOztBQUV0QjtJQWNJLG1DQUNZLFNBQWtELEVBQ3pCLElBQVU7UUFEbkMsY0FBUyxHQUFULFNBQVMsQ0FBeUM7UUFDekIsU0FBSSxHQUFKLElBQUksQ0FBTTtRQVZ4QyxxQkFBZ0IsR0FBYSxFQUFFLENBQUM7UUFDaEMsU0FBSSxHQUFXLEVBQUUsQ0FBQztRQUNsQixjQUFTLEdBQUcsRUFBRSxDQUFDO0lBU2xCLENBQUM7SUFFTDs7T0FFRzs7Ozs7SUFDSCw0Q0FBUTs7OztJQUFSO1FBQ0ksSUFBSSxDQUFDLElBQUksRUFBRSxDQUFBO0lBQ2YsQ0FBQztJQUVEOztNQUVFOzs7Ozs7SUFDTSx3Q0FBSTs7Ozs7SUFBWjtRQUFBLGlCQVFDO1FBUEcsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQzs7WUFDakMsSUFBSSxHQUFHLEVBQUU7UUFDYixJQUFJLENBQUMsV0FBVyxFQUFFLENBQUMsT0FBTzs7Ozs7UUFBQyxVQUFDLElBQUksRUFBRSxHQUFHO1lBQ2pDLElBQUksQ0FBQyxLQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJOzs7O1lBQUMsVUFBQSxDQUFD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NDJDQUFpRDs7aUJBRXBEOzs7O2dCQVhRLFlBQVk7Z0RBdUJaLE1BQU0sU0FBQyxlQUFlOztJQTRHL0IsZ0NBQUM7Q0FBQSxBQTVIRCxJQTRIQztTQXZIWSx5QkFBeUI7OztJQUNsQyxxREFBdUM7O0lBQ3ZDLHlDQUF5Qjs7SUFDekIsOENBQXNCOztJQUN0Qiw4Q0FBeUI7O0lBQ3pCLDBDQUFrQjs7SUFDbEIsc0RBQThCOztJQUM5QixnREFBd0I7Ozs7O0lBR3BCLDhDQUEwRDs7Ozs7SUFDMUQseUNBQTJDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0LCBDb21wb25lbnQsIE9uSW5pdCwgQWZ0ZXJWaWV3Q2hlY2tlZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBNYXREaWFsb2dSZWYsIE1BVF9ESUFMT0dfREFUQSB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsJztcclxuaW1wb3J0IHsgU0hDdGxDb21tb24gfSBmcm9tICcuLi9zaC1jdGwtY29tbW9uJztcclxuXHJcbmludGVyZmFjZSBEYXRhIHtcclxuICAgIGRhdGFUaXRsZTogc3RyaW5nXHJcbiAgICBoaWRkZW5Db2x1bW5zOiBhbnlcclxufVxyXG5AQ29tcG9uZW50KHtcclxuICAgIHNlbGVjdG9yOiAnc2gtY3RsLXBvcHVwLWRpYWxvZycsXHJcbiAgICB0ZW1wbGF0ZVVybDogJ3NoLWN0bC1wb3B1cC1kaWFsb2cuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgc3R5bGVVcmxzOiBbJ3NoLWN0bC1wb3B1cC1kaWFsb2cuY29tcG9uZW50LmNzcycsICcuLi8uLi8uLi9zdHlsZS5jb21tb24uY3NzJ11cclxufSlcclxuZXhwb3J0IGNsYXNzIFNIQ3RsUG9wdXBEaWFsb2dDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIEFmdGVyVmlld0NoZWNrZWQge1xyXG4gICAgcHVibGljIGRpc3BsYXllZENvbHVtbnM6IHN0cmluZ1tdID0gW107XHJcbiAgICBwdWJsaWMgbmFtZTogc3RyaW5nID0gXCJcIjtcclxuICAgIHB1YmxpYyB1bmlxdWVTdHIgPSBcIlwiO1xyXG4gICAgcHVibGljIGRhdGFUaXRsZTogc3RyaW5nO1xyXG4gICAgcHVibGljIGNvZGVzOiBhbnk7XHJcbiAgICBwdWJsaWMgdW5jaGFuZ2VhYmxlQ29kZXM6IGFueTtcclxuICAgIHB1YmxpYyBjb2Rlc0hlYWRlcjogYW55O1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHByaXZhdGUgZGlhbG9nUmVmOiBNYXREaWFsb2dSZWY8U0hDdGxQb3B1cERpYWxvZ0NvbXBvbmVudD4sXHJcbiAgICAgICAgQEluamVjdChNQVRfRElBTE9HX0RBVEEpIHByaXZhdGUgZGF0YTogRGF0YSxcclxuICAgICkgeyB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlgKTjgYzjg5DjgqTjg7Pjg4njgZXjgozjgovmmYLjgavlkbzjgbDjgozjgotcclxuICAgICAqL1xyXG4gICAgbmdPbkluaXQoKSB7XHJcbiAgICAgICAgdGhpcy5pbml0KClcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICog5YCk44Gu5Yid5pyf5YyWXHJcbiAgICAqL1xyXG4gICAgcHJpdmF0ZSBpbml0KCkge1xyXG4gICAgICAgIHRoaXMuZGF0YVRpdGxlID0gdGhpcy5kYXRhLmRhdGFUaXRsZTtcclxuICAgICAgICBsZXQgY29scyA9IFtdO1xyXG4gICAgICAgIHRoaXMuZ2V0SGFzaEtleXMoKS5mb3JFYWNoKChuYW1lLCBpZHgpID0+IHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmRhdGEuaGlkZGVuQ29sdW1ucy5maW5kKF8gPT4gXyA9PSAoaWR4ICsgMSkpKSBjb2xzLnB1c2gobmFtZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5kaXNwbGF5ZWRDb2x1bW5zID0gY29scztcclxuICAgICAgICB0aGlzLnVuaXF1ZVN0ciA9IFNIQ3RsQ29tbW9uLmdldFVuaXF1ZVN0cigpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgKiDjg4bjg7zjg5bjg6vjga7jg5jjg4Pjg4Djg7zjgpLnt6jpm4ZcclxuICAgICovXHJcbiAgICBuZ0FmdGVyVmlld0NoZWNrZWQoKSB7XHJcbiAgICAgICAgbGV0IGhlYWRlckVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGgnKVxyXG4gICAgICAgIGxldCBjb3VudEJsYW5rID0gMDtcclxuICAgICAgICBpZiAoIXRoaXMuY29kZXNIZWFkZXIpIHJldHVybjtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGhlYWRlckVsZW1lbnQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY29kZXNIZWFkZXJbaV0gIT0gXCJcIikge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgZSA9IDE7IGUgPD0gY291bnRCbGFuazsgZSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyRWxlbWVudFtpIC0gZV0uc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvdW50QmxhbmsgPSAwO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuY29kZXNIZWFkZXJbaV0gPT09IFwiXCIpIHtcclxuICAgICAgICAgICAgICAgIGNvdW50QmxhbmsgKz0gMTtcclxuICAgICAgICAgICAgICAgIGhlYWRlckVsZW1lbnRbaSAtIGNvdW50QmxhbmtdLmNvbFNwYW4gPSBjb3VudEJsYW5rICsgMTtcclxuICAgICAgICAgICAgICAgIGhlYWRlckVsZW1lbnRbaSAtIGNvdW50QmxhbmtdLnN0eWxlLnRleHRBbGlnbiA9ICdjZW50ZXInO1xyXG4gICAgICAgICAgICAgICAgaWYgKGkgPT09IGhlYWRlckVsZW1lbnQubGVuZ3RoIC0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgY291bnRCbGFuazsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlckVsZW1lbnRbaSAtIGpdLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOODgOOCpOOCouODreOCsOOCkumWieOBmOOCi1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgY2xvc2VEaWFsb2coKSB7XHJcbiAgICAgICAgdGhpcy5kaWFsb2dSZWYuY2xvc2UoKVxyXG5cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOODneODg+ODl+OCouODg+ODl+OBi+OCiemBuOaKnuOBleOCjOOBn+ODh+ODvOOCv+OCkuimquOBq+i/lOOBmVxyXG4gICAgICogQHBhcmFtIGl0ZW0g5LqL5qWt5omA44Kz44O844OJ5LiA6Kan44GL44KJ6YG45oqe44GV44KM44GfMeOBpFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc2VsZWN0Q29kZShpdGVtOiBhbnkpIHtcclxuICAgICAgICAvL+ODgOOCpOOCouODreOCsOOCkumWieOCgeOCi+aZguOBq+WApOOCkuimquOBq+a4oeOBmVxyXG4gICAgICAgIHRoaXMuZGlhbG9nUmVmLmNsb3NlKGl0ZW0pXHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog44OH44O844K/44Gua2V544KS6L+U44GZXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXRIYXNoS2V5cygpIHtcclxuICAgICAgICBpZiAoIXRoaXMudW5jaGFuZ2VhYmxlQ29kZXMgfHwgdGhpcy51bmNoYW5nZWFibGVDb2Rlcy5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gW107IFxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLnVuY2hhbmdlYWJsZUNvZGVzWzBdKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDjg53jg4Pjg5fjgqLjg4Pjg5flhoXjgafjga7mm5bmmKfmpJzntKJcclxuICAgICAqIOOCueODmuODvOOCueWMuuWIh+OCiuOBpzHjgq3jg7zjg6/jg7zjg4njgajjgZnjgotcclxuICAgICAqIEBwYXJhbSBldmVudCBpbnB1dOOCpOODmeODs+ODiFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZmlsdGVyKGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLnVuY2hhbmdlYWJsZUNvZGVzKSByZXR1cm47XHJcbiAgICAgICAgY29uc3QgZmlsdGVyU3RyaW5nOiBzdHJpbmcgPSBldmVudC50YXJnZXQudmFsdWU7XHJcbiAgICAgICAgbGV0IGZpbGV0ZXJTdHJBcnJheSA9IGZpbHRlclN0cmluZy5yZXBsYWNlKC/jgIAvZywgXCIgXCIpLnNwbGl0KFwiIFwiKTtcclxuICAgICAgICBmaWxldGVyU3RyQXJyYXkgPSBmaWxldGVyU3RyQXJyYXkuZmlsdGVyKCh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbGV0IHJlc3VsdEFycmF5OiBhbnlbXTtcclxuICAgICAgICByZXN1bHRBcnJheSA9IHRoaXMudW5jaGFuZ2VhYmxlQ29kZXMuY29uY2F0KCk7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmaWxldGVyU3RyQXJyYXkubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IG9iaiA9IHRoaXM7XHJcbiAgICAgICAgICAgIHJlc3VsdEFycmF5ID0gcmVzdWx0QXJyYXkuZmlsdGVyKGZ1bmN0aW9uICh2YWx1ZTogYW55KSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdmFsdWVzID0gT2JqZWN0LnZhbHVlcyh2YWx1ZSlcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdmFsdWVzLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9iai5kYXRhLmhpZGRlbkNvbHVtbnMuZmluZChfID0+IF8gPT0gKGogKyAxKSkpIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZXNbal0gIT0gbnVsbCAmJiB2YWx1ZXNbal0udG9TdHJpbmcoKS5tYXRjaChmaWxldGVyU3RyQXJyYXlbaV0pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY29kZXMgPSByZXN1bHRBcnJheTtcclxuICAgIH1cclxufSJdfQ==