/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, Input } from '@angular/core';
import { SHCtlCommon } from '../sh-ctl-common';
import { SHFormControl } from '../../utilities/ShFormControl';
import { ShCtlConst } from "../../constShCtl";
var SHCtlNumberComponent = /** @class */ (function (_super) {
    tslib_1.__extends(SHCtlNumberComponent, _super);
    function SHCtlNumberComponent() {
        var _this = _super.call(this) || this;
        _this.min = 0;
        _this.max = 99999999999;
        _this.decimaldigit = 0;
        _this.rounding = "round";
        _this.firstFlag = true;
        _this.ctlName = "SHCtlNumber";
        return _this;
    }
    /**
     * @return {?}
     */
    SHCtlNumberComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.onInit();
    };
    /**
     * ngOnChangesイベント
     * 値変更時にフォーマットを整形
     * @param event input
     */
    /**
     * ngOnChangesイベント
     * 値変更時にフォーマットを整形
     * @param {?} changes
     * @return {?}
     */
    SHCtlNumberComponent.prototype.ngOnChanges = /**
     * ngOnChangesイベント
     * 値変更時にフォーマットを整形
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes.value) {
            if (changes.value.currentValue) {
                if (changes.value.currentValue === '' || changes.value.currentValue === undefined || changes.value.currentValue === String(/[^\x01-\x7E\xA1-\xDF]+$/g)) {
                    this.value = '';
                    return;
                }
                if (parseFloat(changes.value.currentValue) < this.min) {
                    this.value = String(this.min);
                }
                if (parseFloat(changes.value.currentValue) > this.max) {
                    this.value = String(this.max);
                }
                this.stringValue = this.toText(changes.value.currentValue);
                if (this.rounding === "round") {
                    this.value = changes.value.currentValue;
                }
                if (String(changes.value.currentValue).indexOf(',') === -1) {
                    this.value = this.setMinMax(this.value);
                    this.value = this.toText(this.value);
                }
            }
        }
    };
    /**
     * ngAfterViewCheckedイベント
     * 表示画面と修正画面でカンマ編集
     */
    /**
     * ngAfterViewCheckedイベント
     * 表示画面と修正画面でカンマ編集
     * @return {?}
     */
    SHCtlNumberComponent.prototype.ngAfterViewChecked = /**
     * ngAfterViewCheckedイベント
     * 表示画面と修正画面でカンマ編集
     * @return {?}
     */
    function () {
        if (!this.firstFlag)
            return;
        //this.valueが存在するときに、カンマ編集をしなければならない。
        /** @type {?} */
        var matInputElement = document.activeElement.classList.contains('mat-input-element');
        if (this.firstFlag && this.value && !matInputElement) {
            this.value = this.toText(this.value);
        }
        //this.valueが存在するときに、firstFlagにfalseを代入しないと、カンマ編集がされなくなる
        if (this.value) {
            this.firstFlag = false;
        }
    };
    /**
     * onInput
     * @param event input
     */
    /**
     * onInput
     * @param {?} event input
     * @return {?}
     */
    SHCtlNumberComponent.prototype.onInput = /**
     * onInput
     * @param {?} event input
     * @return {?}
     */
    function (event) {
        SHCtlCommon.replaceHalfWidth(event);
        SHCtlCommon.replaceSpace(event);
        SHCtlCommon.replaceFUllSpace(event);
        SHCtlCommon.replaceSign(event, [",", "\.", "\-"]);
        //2文字目以降の「-」の入力を受け付けない
        if (event.target.value.length > 1)
            event.target.value = event.target.value.slice(0, 1) + event.target.value.slice(1).replace(/[\-]/g, "");
        SHCtlCommon.replaceFullWidth(event);
        this.checkNumbersSigns(event);
        if (event.inputType !== 'insertCompositionText') {
            SHCtlCommon.replaceSpace(event);
            SHCtlCommon.replaceFUllSpace(event);
            SHCtlCommon.replaceSign(event, [",", "\.", "\-"]);
            SHCtlCommon.replaceFullWidth(event);
            SHCtlCommon.sliceLength(event, this.maxlength);
            this.checkNumbersSigns(event);
        }
    };
    /**
     * マッチした値を記号に置き換える
     * @param event input
     */
    /**
     * マッチした値を記号に置き換える
     * @param {?} event input
     * @return {?}
     */
    SHCtlNumberComponent.prototype.checkNumbersSigns = /**
     * マッチした値を記号に置き換える
     * @param {?} event input
     * @return {?}
     */
    function (event) {
        event.target.value = event.target.value.replace(/^[\.|,]/g, "");
        event.target.value = event.target.value.replace(/[\.]{2,}/g, ".");
        event.target.value = event.target.value.replace(/[\,]{2,}/g, ",");
        event.target.value = event.target.value.replace(/[\-]{1,}/g, "-");
        if ((/\d.*\.\d.*/).test(event.target.value) && event.data === ".") {
            event.target.value = event.target.value.slice(0, event.target.value.length - 1);
        }
    };
    /**
     * onClick
     * @param event click
     */
    /**
     * onClick
     * @param {?} event click
     * @return {?}
     */
    SHCtlNumberComponent.prototype.onClick = /**
     * onClick
     * @param {?} event click
     * @return {?}
     */
    function (event) {
        this.onBeforeClick(event);
        this.onAfterClick(event);
    };
    /**
     * onKeyDown
     * @param event keydown
     */
    /**
     * onKeyDown
     * @param {?} event keydown
     * @return {?}
     */
    SHCtlNumberComponent.prototype.onKeyDown = /**
     * onKeyDown
     * @param {?} event keydown
     * @return {?}
     */
    function (event) {
        var _this = this;
        if (event.keyCode == ShCtlConst.ORDINAL.KEYS.KEY_TAB) {
            setTimeout((/**
             * @return {?}
             */
            function () {
                event.target.value = _this.toText(event.target.value);
            }), 0);
        }
    };
    /**
     * onChange
     * @param event change
     */
    /**
     * onChange
     * @param {?} event change
     * @return {?}
     */
    SHCtlNumberComponent.prototype.onChange = /**
     * onChange
     * @param {?} event change
     * @return {?}
     */
    function (event) {
        var _this = this;
        this.onBeforeChange(event);
        //emitの直前にも値の精査を行う
        this.onInput(event);
        //onChange発火時に数値でなければクリアする
        if (isNaN(Number(event.target.value)) === true) {
            event.target.value = '';
            return;
        }
        //min maxの値を反映させる
        event.target.value = this.setMinMax(event.target.value);
        event.target.value = this.toText(event.target.value);
        this.valueChange.emit(Number(this.removeComma(event.target.value)));
        setTimeout((/**
         * @return {?}
         */
        function () { _this.onAfterChange(event); }), 0);
    };
    /**
     * onFocus
     * @param event focus
     */
    /**
     * onFocus
     * @param {?} event focus
     * @return {?}
     */
    SHCtlNumberComponent.prototype.onFocus = /**
     * onFocus
     * @param {?} event focus
     * @return {?}
     */
    function (event) {
        var _this = this;
        this.onBeforeFocus(event);
        event.target.value = this.removeComma(event.target.value);
        event.target.select();
        setTimeout((/**
         * @return {?}
         */
        function () { _this.onAfterFocus(event); }), 0);
    };
    /**
     * onBlur
     * @param event blur
     */
    /**
     * onBlur
     * @param {?} event blur
     * @return {?}
     */
    SHCtlNumberComponent.prototype.onBlur = /**
     * onBlur
     * @param {?} event blur
     * @return {?}
     */
    function (event) {
        var _this = this;
        //桁数指定で値を丸める
        this.onBeforeBlur(event);
        //カンマ区切り
        setTimeout((/**
         * @return {?}
         */
        function () {
            event.target.value = _this.toText(event.target.value);
        }), 0);
        setTimeout((/**
         * @return {?}
         */
        function () { _this.onAfterBlur(event); }), 0);
        ;
    };
    /**
     * カンマ付きの値を返す
     * @param inputTargetValue event.target.value
     */
    /**
     * カンマ付きの値を返す
     * @param {?} inputTargetValue event.target.value
     * @return {?}
     */
    SHCtlNumberComponent.prototype.toText = /**
     * カンマ付きの値を返す
     * @param {?} inputTargetValue event.target.value
     * @return {?}
     */
    function (inputTargetValue) {
        var _this = this;
        inputTargetValue = this.removeComma(inputTargetValue);
        if (!inputTargetValue)
            return null;
        if (isNaN(Number(inputTargetValue)))
            return null;
        if (this.rounding === "round") {
            //桁数指定で値を丸める
            /** @type {?} */
            var ret = parseFloat(parseFloat(inputTargetValue).toFixed(this.decimaldigit)).toString();
            return parseFloat(ret).toLocaleString(undefined, {
                minimumFractionDigits: this.decimaldigit,
                maximumFractionDigits: this.decimaldigit
            });
        }
        else if (this.rounding === "floor") {
            //桁数指定で値を丸める
            /** @type {?} */
            var FLOOR = (/**
             * @param {?} value
             * @param {?} decimalDigit
             * @return {?}
             */
            function (value, decimalDigit) { return _this.decimalAdjust(_this.rounding, value, decimalDigit); });
            /** @type {?} */
            var ret = FLOOR(parseFloat(inputTargetValue), -this.decimaldigit).toString();
            return parseFloat(ret).toLocaleString(undefined, {
                minimumFractionDigits: this.decimaldigit,
                maximumFractionDigits: this.decimaldigit
            });
        }
        else if (this.rounding === "ceil") {
            //桁数指定で値を丸める
            /** @type {?} */
            var CEIL = (/**
             * @param {?} value
             * @param {?} decimalDigit
             * @return {?}
             */
            function (value, decimalDigit) { return _this.decimalAdjust(_this.rounding, value, decimalDigit); });
            /** @type {?} */
            var ret = CEIL(parseFloat(inputTargetValue), -this.decimaldigit).toString();
            return parseFloat(ret).toLocaleString(undefined, {
                minimumFractionDigits: this.decimaldigit,
                maximumFractionDigits: this.decimaldigit
            });
        }
    };
    /**
     * min maxを反映した値を返す
     * @param inputTargetValue event.target.value
     */
    /**
     * min maxを反映した値を返す
     * @param {?} inputTargetValue event.target.value
     * @return {?}
     */
    SHCtlNumberComponent.prototype.setMinMax = /**
     * min maxを反映した値を返す
     * @param {?} inputTargetValue event.target.value
     * @return {?}
     */
    function (inputTargetValue) {
        if (!inputTargetValue)
            return "";
        if (isNaN(Number(inputTargetValue)))
            return "";
        if (parseFloat(inputTargetValue) < this.min) {
            inputTargetValue = this.min.toString();
        }
        if (parseFloat(inputTargetValue) > this.max) {
            inputTargetValue = this.max.toString();
        }
        if (this.rounding === "round") {
            /** @type {?} */
            var w = Math.pow(10, this.decimaldigit);
            inputTargetValue = (Math.round(+inputTargetValue * w + 1e-10) / w).toString();
            return inputTargetValue;
        }
        else if (this.rounding === "floor" || this.rounding === "ceil") {
            return inputTargetValue;
        }
    };
    /**
     * roundingがfloorかceilの時に切り捨て切り上げ処理を行う
     * @param type floor or ceil
     * @param value value
     * @param decimalDigit decimalDigit
     */
    /**
     * roundingがfloorかceilの時に切り捨て切り上げ処理を行う
     * @param {?} type floor or ceil
     * @param {?} value value
     * @param {?} decimalDigit decimalDigit
     * @return {?}
     */
    SHCtlNumberComponent.prototype.decimalAdjust = /**
     * roundingがfloorかceilの時に切り捨て切り上げ処理を行う
     * @param {?} type floor or ceil
     * @param {?} value value
     * @param {?} decimalDigit decimalDigit
     * @return {?}
     */
    function (type, value, decimalDigit) {
        if (typeof decimalDigit === 'undefined' || +decimalDigit === 0) {
            return Math[type](value);
        }
        value = +value;
        decimalDigit = +decimalDigit;
        if (isNaN(value) || !(typeof decimalDigit === 'number' && decimalDigit % 1 === 0)) {
            return NaN;
        }
        value = value.toString().split('e');
        value = Math[type](+(value[0] + 'e' + (value[1] ? (+value[1] - decimalDigit) : -decimalDigit)));
        value = value.toString().split('e');
        value = +(value[0] + 'e' + (value[1] ? (+value[1] + decimalDigit) : decimalDigit));
        return value;
    };
    /**
     * カンマを外した値を返す
     * @param inputTargetValue event.target.value
     */
    /**
     * カンマを外した値を返す
     * @param {?} inputTargetValue event.target.value
     * @return {?}
     */
    SHCtlNumberComponent.prototype.removeComma = /**
     * カンマを外した値を返す
     * @param {?} inputTargetValue event.target.value
     * @return {?}
     */
    function (inputTargetValue) {
        inputTargetValue = new String(inputTargetValue).replace(/,/g, "");
        return inputTargetValue;
    };
    SHCtlNumberComponent.decorators = [
        { type: Component, args: [{
                    selector: 'sh-ctl-number',
                    template: "<ng-container *ngIf=\"!onlyField; else onlyFieldControl\">\r\n  <div *ngIf=\"!isDisabled\" (focusin)=\"onFocusin($event)\" (focusout)=\"onFocusout($event)\">\r\n    <mat-form-field class=\"mat-validation\" [floatLabel]=\"floatLabel\">\r\n      <input #inputElm matInput [required]=\"required\" [placeholder]=\"title\" (focus)=\"onFocus($event)\" type=\"email\" title=\"\"\r\n        [(ngModel)]=\"value\" attr.name=\"{{ctlName}}\" class=\"form-control can-moved-with-the-enter-key {{strClass}}\"\r\n        value=\"\" style=\"text-align: right; \" (input)=\"onInput($event)\" (click)=\"onClick($event)\" (keydown)=\"onKeyDown($event)\"\r\n        (change)=\"onChange($event)\" [disabled]=\"disabled\" [ngStyle]=\"styles\" [ngClass]=\"objClass\" />\r\n      <button mat-button *ngIf=\"inputElm.value && !inputElm.readOnly && !inputElm.disabled\" matSuffix mat-icon-button\r\n        aria-label=\"Clear\" (mousedown)=\"clearValue()\" (keydown)=\"clickClearButton($event)\">\r\n        <mat-icon>close</mat-icon>\r\n      </button>\r\n    </mat-form-field>\r\n    <span class=\"custom-alert-message\">{{message.toString().split(',').join(' ')}}</span>\r\n  </div>\r\n</ng-container>\r\n\r\n<ng-template #onlyFieldControl>\r\n  <div class=\"only-field\" (focusin)=\"onFocusin($event)\" (focusout)=\"onFocusout($event)\">\r\n    <input #inputElm matInput [required]=\"required\" (focus)=\"onFocus($event)\"\r\n      [(ngModel)]=\"value\" attr.name=\"{{ctlName}}\" class=\"form-control can-moved-with-the-enter-key {{strClass}}\" title=\"\"\r\n      value=\"\" style=\"text-align: right; \" (input)=\"onInput($event)\" (click)=\"onClick($event)\"\r\n      (change)=\"onChange($event)\" [disabled]=\"disabled\" [ngStyle]=\"styles\" [ngClass]=\"objClass\" />\r\n    <button mat-button *ngIf=\"inputElm.value && !inputElm.readOnly && !inputElm.disabled\" matSuffix mat-icon-button\r\n      aria-label=\"Clear\" (mousedown)=\"clearValue()\" (keydown)=\"clickClearButton($event)\">\r\n      <mat-icon>close</mat-icon>\r\n    </button>\r\n  </div>\r\n</ng-template>\r\n\r\n<div *ngIf=\"isDisabled\" class=\"display-ctl-view\">\r\n  <div>\r\n    <div *ngIf=\"title\" class=\"display-ctl-view\">\r\n      <div class=\"display-result\" [ngStyle]=\"{'width.px': labelWidth}\" fxLayout=\"row wrap\" fxFlex>\r\n        <div fxFlex class=\"item-title\"><strong>{{title}}:</strong></div>\r\n      </div>\r\n      <div fxFlex class=\"valueOutput\">\r\n        {{stringValue}}\r\n      </div>\r\n    </div>\r\n\r\n    <div *ngIf=\"!title\" class=\"display-ctl-view notitle-value\">\r\n      <div fxFlex class=\"valueOutput\">\r\n        {{stringValue}}\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n",
                    styles: [".item-title{margin-left:.5%;margin-right:25%}.display-ctl-view{display:-webkit-box;display:flex}.display-result{display:-webkit-box;display:flex;margin-left:30px}.valueOutput{-webkit-box-flex:1;flex:1;padding-top:4px}.validation-error::ng-deep .mat-form-field-label{color:red}.validation-error::ng-deep .mat-form-field-underline{background-color:red}.notitle-value{width:100%;margin-left:30px}", ".sh-flex{width:100%;display:-webkit-inline-box;display:inline-flex}.sh-flex-center{-webkit-box-align:center;align-items:center}.sh-flex-between{-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:center;align-items:center}.display-ctl-view{margin-top:20px}.overlay{position:fixed;display:-webkit-box;display:flex;top:0;left:0;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center;height:100%;width:100%;color:gray;background-color:rgba(0,0,0,.5);z-index:9999}.loader-text{display:block;color:#f3f3f3;margin-top:1em}.mat-dialog-content{overflow:hidden;max-height:none}.sh-dialog-content{height:85%}.sh-kbn-dialog-table-container{height:92%;overflow-y:scroll;margin-top:18px;margin-bottom:18px}.sh-dialog-table-container{display:-webkit-box;display:flex;height:83%;overflow-y:scroll;margin-top:18px;margin-bottom:18px}.sh-text-center{text-align:center}.sh-width-100{width:100%}.sh-label{display:block}.custom-alert-message{top:-20px;position:relative;font-size:.75em;color:rgba(0,0,0,.54)}.result-input,.sh-label{color:rgba(0,0,0,.87)}::ng-deep .mat-form-field-label span{color:rgba(0,0,0,.87)}::ng-deep .result-container .mat-form-field-flex{background-color:#ccdcff}.sh-ctl-state-primary::ng-deep .mat-form-field-label{color:#3f51b5}.sh-ctl-state-primary::ng-deep .mat-form-field-underline{background-color:#3f51b5}.sh-ctl-state-primary-message{color:#3f51b5}.sh-ctl-state-secondary::ng-deep .mat-form-field-label{color:#ff4081}.sh-ctl-state-secondary::ng-deep .mat-form-field-underline{background-color:#ff4081}.sh-ctl-state-secondary-message{color:#ff4081}.sh-ctl-state-success::ng-deep .mat-form-field-label{color:#0dad17}.sh-ctl-state-success::ng-deep .mat-form-field-underline{background-color:#0dad17}.sh-ctl-state-success-message{color:#0dad17}.sh-ctl-state-danger::ng-deep .mat-form-field-label{color:#f44336}.sh-ctl-state-danger::ng-deep .mat-form-field-underline{background-color:#f44336}.sh-ctl-state-danger-message{color:#f44336}.sh-ctl-state-warning::ng-deep .mat-form-field-label{color:#e29f2b}.sh-ctl-state-warning::ng-deep .mat-form-field-underline{background-color:#e29f2b}.sh-ctl-state-warning-message{color:#e29f2b}.sh-container{position:relative;width:100%;height:100%}.only-field{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;width:100%;height:100%;min-height:28px}.only-field input,.only-field textarea{font:inherit;background:0 0;color:currentColor;border:none;outline:0;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit}.only-field-danger{background-color:#f44336}.only-field-warning{background-color:#e29f2b}.only-field-success{background-color:#0dad17}::ng-deep .only-field .material-icons{font-size:13px}::ng-deep .only-field .mat-button{position:relative;width:24px;height:24px}::ng-deep .only-field .mat-icon-button{position:relative;width:24px;height:24px}::ng-deep .only-field .mat-icon{position:absolute;top:0;left:0}::ng-deep .only-field .mat-datepicker-toggle-default-icon{position:absolute;top:25%;left:0;right:0;bottom:0;margin-left:auto;margin-right:auto}::ng-deep .mat-datepicker-toggle span svg{width:16px;height:16px}.only-label{background-color:#ccdcff;position:relative}.only-label mat-icon{position:absolute;top:25%;left:0;right:0;bottom:0;margin-left:auto;font-size:16px}.bind-flg__input{opacity:0;height:0;width:0;position:absolute;z-index:-100}"]
                }] }
    ];
    /** @nocollapse */
    SHCtlNumberComponent.ctorParameters = function () { return []; };
    SHCtlNumberComponent.propDecorators = {
        min: [{ type: Input }],
        max: [{ type: Input }],
        decimaldigit: [{ type: Input }],
        rounding: [{ type: Input }]
    };
    return SHCtlNumberComponent;
}(SHFormControl));
export { SHCtlNumberComponent };
if (false) {
    /** @type {?} */
    SHCtlNumberComponent.prototype.min;
    /** @type {?} */
    SHCtlNumberComponent.prototype.max;
    /** @type {?} */
    SHCtlNumberComponent.prototype.decimaldigit;
    /** @type {?} */
    SHCtlNumberComponent.prototype.rounding;
    /** @type {?} */
    SHCtlNumberComponent.prototype.stringValue;
    /** @type {?} */
    SHCtlNumberComponent.prototype.firstFlag;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2gtY3RsLW51bWJlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9zaC1mb3JtLWNvbnRyb2wvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9zaC1jdGwtbnVtYmVyL3NoLWN0bC1udW1iZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBcUIsS0FBSyxFQUFtQyxNQUFNLGVBQWUsQ0FBQztBQUNyRyxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDL0MsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBQzlELE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUU5QztJQUswQyxnREFBcUI7SUFRN0Q7UUFBQSxZQUNFLGlCQUFPLFNBRVI7UUFWZSxTQUFHLEdBQVcsQ0FBQyxDQUFDO1FBQ2hCLFNBQUcsR0FBVyxXQUFXLENBQUM7UUFDMUIsa0JBQVksR0FBVyxDQUFDLENBQUM7UUFDekIsY0FBUSxHQUFXLE9BQU8sQ0FBQztRQUVwQyxlQUFTLEdBQVksSUFBSSxDQUFDO1FBSS9CLEtBQUksQ0FBQyxPQUFPLEdBQUcsYUFBYSxDQUFDOztJQUMvQixDQUFDOzs7O0lBRU0sdUNBQVE7OztJQUFmO1FBQ0UsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDO0lBQ2hCLENBQUM7SUFFRDs7OztPQUlHOzs7Ozs7O0lBQ0ksMENBQVc7Ozs7OztJQUFsQixVQUFtQixPQUFzQjtRQUN2QyxJQUFJLE9BQU8sQ0FBQyxLQUFLLEVBQUU7WUFDakIsSUFBSSxPQUFPLENBQUMsS0FBSyxDQUFDLFlBQVksRUFBRTtnQkFDOUIsSUFBSSxPQUFPLENBQUMsS0FBSyxDQUFDLFlBQVksS0FBSyxFQUFFLElBQUksT0FBTyxDQUFDLEtBQUssQ0FBQyxZQUFZLEtBQUssU0FBUyxJQUFJLE9BQU8sQ0FBQyxLQUFLLENBQUMsWUFBWSxLQUFLLE1BQU0sQ0FBQywwQkFBMEIsQ0FBQyxFQUFFO29CQUN0SixJQUFJLENBQUMsS0FBSyxHQUFHLEVBQUUsQ0FBQztvQkFDaEIsT0FBTztpQkFDUjtnQkFDRCxJQUFJLFVBQVUsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUU7b0JBQ3JELElBQUksQ0FBQyxLQUFLLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztpQkFDL0I7Z0JBQ0QsSUFBSSxVQUFVLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFO29CQUNyRCxJQUFJLENBQUMsS0FBSyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7aUJBQy9CO2dCQUNELElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDO2dCQUMzRCxJQUFJLElBQUksQ0FBQyxRQUFRLEtBQUssT0FBTyxFQUFFO29CQUM3QixJQUFJLENBQUMsS0FBSyxHQUFHLE9BQU8sQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDO2lCQUN6QztnQkFDRCxJQUFJLE1BQU0sQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRTtvQkFDMUQsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztvQkFDeEMsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztpQkFDdEM7YUFDRjtTQUNGO0lBQ0gsQ0FBQztJQUVEOzs7T0FHRzs7Ozs7O0lBQ0gsaURBQWtCOzs7OztJQUFsQjtRQUNFLElBQUcsQ0FBQyxJQUFJLENBQUMsU0FBUztZQUFFLE9BQU87OztZQUd2QixlQUFlLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLG1CQUFtQixDQUFDO1FBQ3BGLElBQUksSUFBSSxDQUFDLFNBQVMsSUFBSSxJQUFJLENBQUMsS0FBSyxJQUFJLENBQUMsZUFBZSxFQUFFO1lBQ3BELElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7U0FDdEM7UUFFRCx3REFBd0Q7UUFDeEQsSUFBRyxJQUFJLENBQUMsS0FBSyxFQUFFO1lBQ2IsSUFBSSxDQUFDLFNBQVMsR0FBRyxLQUFLLENBQUM7U0FDeEI7SUFFSCxDQUFDO0lBRUQ7OztPQUdHOzs7Ozs7SUFDSSxzQ0FBTzs7Ozs7SUFBZCxVQUFlLEtBQVU7UUFDdkIsV0FBVyxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3BDLFdBQVcsQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDaEMsV0FBVyxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3BDLFdBQVcsQ0FBQyxXQUFXLENBQUMsS0FBSyxFQUFFLENBQUMsR0FBRyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDO1FBQ2xELHNCQUFzQjtRQUN0QixJQUFJLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLE1BQU0sR0FBRyxDQUFDO1lBQy9CLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFDekcsV0FBVyxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3BDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUM5QixJQUFJLEtBQUssQ0FBQyxTQUFTLEtBQUssdUJBQXVCLEVBQUU7WUFDL0MsV0FBVyxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNoQyxXQUFXLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDcEMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxHQUFHLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDbEQsV0FBVyxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ3BDLFdBQVcsQ0FBQyxXQUFXLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUMvQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsS0FBSyxDQUFDLENBQUM7U0FDL0I7SUFDSCxDQUFDO0lBRUQ7OztPQUdHOzs7Ozs7SUFDSSxnREFBaUI7Ozs7O0lBQXhCLFVBQXlCLEtBQVU7UUFDakMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUNoRSxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQ2xFLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUUsR0FBRyxDQUFDLENBQUM7UUFDbEUsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUNsRSxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksS0FBSyxDQUFDLElBQUksS0FBSyxHQUFHLEVBQUU7WUFDakUsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUM7U0FDakY7SUFDSCxDQUFDO0lBRUQ7OztPQUdHOzs7Ozs7SUFDSSxzQ0FBTzs7Ozs7SUFBZCxVQUFlLEtBQUs7UUFDbEIsSUFBSSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUUxQixJQUFJLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQzNCLENBQUM7SUFFRDs7O09BR0c7Ozs7OztJQUNILHdDQUFTOzs7OztJQUFULFVBQVUsS0FBSztRQUFmLGlCQU1DO1FBTEMsSUFBRyxLQUFLLENBQUMsT0FBTyxJQUFJLFVBQVUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRTtZQUNuRCxVQUFVOzs7WUFBQztnQkFDVCxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssR0FBRyxLQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDdkQsQ0FBQyxHQUFFLENBQUMsQ0FBQyxDQUFDO1NBQ1A7SUFDSCxDQUFDO0lBRUQ7OztPQUdHOzs7Ozs7SUFDSSx1Q0FBUTs7Ozs7SUFBZixVQUFnQixLQUFLO1FBQXJCLGlCQWtCQztRQWpCQyxJQUFJLENBQUMsY0FBYyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBRTNCLGtCQUFrQjtRQUNsQixJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBRXBCLDBCQUEwQjtRQUMxQixJQUFJLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxLQUFLLElBQUksRUFBRTtZQUM5QyxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUM7WUFDeEIsT0FBTztTQUNSO1FBRUQsaUJBQWlCO1FBQ2pCLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUN4RCxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDckQsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFcEUsVUFBVTs7O1FBQUMsY0FBTyxLQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFBLENBQUEsQ0FBQyxHQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ25ELENBQUM7SUFFRDs7O09BR0c7Ozs7OztJQUNJLHNDQUFPOzs7OztJQUFkLFVBQWUsS0FBVTtRQUF6QixpQkFPQztRQU5DLElBQUksQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLENBQUM7UUFFMUIsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzFELEtBQUssQ0FBQyxNQUFNLENBQUMsTUFBTSxFQUFFLENBQUM7UUFFdEIsVUFBVTs7O1FBQUMsY0FBTyxLQUFJLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQyxDQUFBLENBQUEsQ0FBQyxHQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ2xELENBQUM7SUFFRDs7O09BR0c7Ozs7OztJQUNJLHFDQUFNOzs7OztJQUFiLFVBQWMsS0FBVTtRQUF4QixpQkFVQztRQVRDLFlBQVk7UUFDWixJQUFJLENBQUMsWUFBWSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBRXpCLFFBQVE7UUFDUixVQUFVOzs7UUFBQztZQUNULEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxHQUFHLEtBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUN2RCxDQUFDLEdBQUUsQ0FBQyxDQUFDLENBQUM7UUFFTixVQUFVOzs7UUFBQyxjQUFPLEtBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQSxDQUFDLEdBQUUsQ0FBQyxDQUFDLENBQUM7UUFBQSxDQUFDO0lBQ25ELENBQUM7SUFFRDs7O09BR0c7Ozs7OztJQUNJLHFDQUFNOzs7OztJQUFiLFVBQWMsZ0JBQXdCO1FBQXRDLGlCQTRCQztRQTNCQyxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLGdCQUFnQixDQUFDLENBQUE7UUFDckQsSUFBSSxDQUFDLGdCQUFnQjtZQUFFLE9BQU8sSUFBSSxDQUFDO1FBQ25DLElBQUksS0FBSyxDQUFDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1lBQUUsT0FBTyxJQUFJLENBQUM7UUFDakQsSUFBRyxJQUFJLENBQUMsUUFBUSxLQUFLLE9BQU8sRUFBRTs7O2dCQUV4QixHQUFHLEdBQUksVUFBVSxDQUFDLFVBQVUsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQUU7WUFDekYsT0FBTyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUMsY0FBYyxDQUFDLFNBQVMsRUFBRTtnQkFDL0MscUJBQXFCLEVBQUUsSUFBSSxDQUFDLFlBQVk7Z0JBQ3hDLHFCQUFxQixFQUFFLElBQUksQ0FBQyxZQUFZO2FBQ3pDLENBQUMsQ0FBQztTQUNKO2FBQU0sSUFBSSxJQUFJLENBQUMsUUFBUSxLQUFLLE9BQU8sRUFBRTs7O2dCQUU5QixLQUFLOzs7OztZQUFHLFVBQUMsS0FBSyxFQUFFLFlBQVksSUFBSyxPQUFBLEtBQUksQ0FBQyxhQUFhLENBQUMsS0FBSSxDQUFDLFFBQVEsRUFBRSxLQUFLLEVBQUUsWUFBWSxDQUFDLEVBQXRELENBQXNELENBQUE7O2dCQUN6RixHQUFHLEdBQUksS0FBSyxDQUFDLFVBQVUsQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLFFBQVEsRUFBRTtZQUM3RSxPQUFPLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxjQUFjLENBQUMsU0FBUyxFQUFFO2dCQUMvQyxxQkFBcUIsRUFBRSxJQUFJLENBQUMsWUFBWTtnQkFDeEMscUJBQXFCLEVBQUUsSUFBSSxDQUFDLFlBQVk7YUFDekMsQ0FBQyxDQUFDO1NBQ0o7YUFBTSxJQUFJLElBQUksQ0FBQyxRQUFRLEtBQUssTUFBTSxFQUFFOzs7Z0JBRTdCLElBQUk7Ozs7O1lBQUcsVUFBQyxLQUFLLEVBQUUsWUFBWSxJQUFLLE9BQUEsS0FBSSxDQUFDLGFBQWEsQ0FBQyxLQUFJLENBQUMsUUFBUSxFQUFFLEtBQUssRUFBRSxZQUFZLENBQUMsRUFBdEQsQ0FBc0QsQ0FBQTs7Z0JBQ3hGLEdBQUcsR0FBSSxJQUFJLENBQUMsVUFBVSxDQUFDLGdCQUFnQixDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsUUFBUSxFQUFFO1lBQzVFLE9BQU8sVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxTQUFTLEVBQUU7Z0JBQy9DLHFCQUFxQixFQUFFLElBQUksQ0FBQyxZQUFZO2dCQUN4QyxxQkFBcUIsRUFBRSxJQUFJLENBQUMsWUFBWTthQUN6QyxDQUFDLENBQUM7U0FDSjtJQUNILENBQUM7SUFFRDs7O09BR0c7Ozs7OztJQUNJLHdDQUFTOzs7OztJQUFoQixVQUFpQixnQkFBd0I7UUFDdkMsSUFBSSxDQUFDLGdCQUFnQjtZQUFFLE9BQU8sRUFBRSxDQUFDO1FBQ2pDLElBQUksS0FBSyxDQUFDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1lBQUUsT0FBTyxFQUFFLENBQUM7UUFDL0MsSUFBSSxVQUFVLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFO1lBQzNDLGdCQUFnQixHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFFLENBQUM7U0FDeEM7UUFDRCxJQUFJLFVBQVUsQ0FBQyxnQkFBZ0IsQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUU7WUFDM0MsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUUsQ0FBQztTQUN4QztRQUNELElBQUcsSUFBSSxDQUFDLFFBQVEsS0FBSyxPQUFPLEVBQUU7O2dCQUN4QixDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEVBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQztZQUN4QyxnQkFBZ0IsR0FBRyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxnQkFBZ0IsR0FBRyxDQUFDLEdBQUcsS0FBSyxDQUFDLEdBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDNUUsT0FBTyxnQkFBZ0IsQ0FBQztTQUN6QjthQUFNLElBQUksSUFBSSxDQUFDLFFBQVEsS0FBSyxPQUFPLElBQUksSUFBSSxDQUFDLFFBQVEsS0FBSyxNQUFNLEVBQUU7WUFDaEUsT0FBTyxnQkFBZ0IsQ0FBQztTQUN6QjtJQUNILENBQUM7SUFFRDs7Ozs7T0FLRzs7Ozs7Ozs7SUFDSSw0Q0FBYTs7Ozs7OztJQUFwQixVQUFxQixJQUFJLEVBQUUsS0FBSyxFQUFFLFlBQVk7UUFDNUMsSUFBSSxPQUFPLFlBQVksS0FBSyxXQUFXLElBQUksQ0FBQyxZQUFZLEtBQUssQ0FBQyxFQUFFO1lBQzlELE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDO1NBQzFCO1FBQ0QsS0FBSyxHQUFHLENBQUMsS0FBSyxDQUFDO1FBQ2YsWUFBWSxHQUFHLENBQUMsWUFBWSxDQUFDO1FBQzdCLElBQUksS0FBSyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxPQUFPLFlBQVksS0FBSyxRQUFRLElBQUksWUFBWSxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRTtZQUNqRixPQUFPLEdBQUcsQ0FBQztTQUNaO1FBQ0QsS0FBSyxHQUFHLEtBQUssQ0FBQyxRQUFRLEVBQUUsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDcEMsS0FBSyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDaEcsS0FBSyxHQUFHLEtBQUssQ0FBQyxRQUFRLEVBQUUsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDcEMsS0FBSyxHQUFHLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDO1FBQ25GLE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQztJQUVEOzs7T0FHRzs7Ozs7O0lBQ0ksMENBQVc7Ozs7O0lBQWxCLFVBQW1CLGdCQUF3QjtRQUN6QyxnQkFBZ0IsR0FBRyxJQUFJLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFDbEUsT0FBTyxnQkFBZ0IsQ0FBQztJQUMxQixDQUFDOztnQkE5UUYsU0FBUyxTQUFDO29CQUNULFFBQVEsRUFBRSxlQUFlO29CQUN6Qiwwb0ZBQTZDOztpQkFFOUM7Ozs7O3NCQUVFLEtBQUs7c0JBQ0wsS0FBSzsrQkFDTCxLQUFLOzJCQUNMLEtBQUs7O0lBdVFSLDJCQUFDO0NBQUEsQUFoUkQsQ0FLMEMsYUFBYSxHQTJRdEQ7U0EzUVksb0JBQW9COzs7SUFDL0IsbUNBQWdDOztJQUNoQyxtQ0FBMEM7O0lBQzFDLDRDQUF5Qzs7SUFDekMsd0NBQTJDOztJQUMzQywyQ0FBd0I7O0lBQ3hCLHlDQUFpQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBPbkNoYW5nZXMsIElucHV0LCBTaW1wbGVDaGFuZ2VzLCBBZnRlclZpZXdDaGVja2VkIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFNIQ3RsQ29tbW9uIH0gZnJvbSAnLi4vc2gtY3RsLWNvbW1vbic7XHJcbmltcG9ydCB7IFNIRm9ybUNvbnRyb2wgfSBmcm9tICcuLi8uLi91dGlsaXRpZXMvU2hGb3JtQ29udHJvbCc7XHJcbmltcG9ydCB7IFNoQ3RsQ29uc3QgfSBmcm9tIFwiLi4vLi4vY29uc3RTaEN0bFwiO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdzaC1jdGwtbnVtYmVyJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vc2gtY3RsLW51bWJlci5jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vc2gtY3RsLW51bWJlci5jb21wb25lbnQuY3NzJywgJy4uLy4uLy4uL3N0eWxlLmNvbW1vbi5jc3MnXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgU0hDdGxOdW1iZXJDb21wb25lbnQgZXh0ZW5kcyBTSEZvcm1Db250cm9sPHN0cmluZz4gaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcywgQWZ0ZXJWaWV3Q2hlY2tlZCB7XHJcbiAgQElucHV0KCkgcHVibGljIG1pbjogbnVtYmVyID0gMDtcclxuICBASW5wdXQoKSBwdWJsaWMgbWF4OiBudW1iZXIgPSA5OTk5OTk5OTk5OTtcclxuICBASW5wdXQoKSBwdWJsaWMgZGVjaW1hbGRpZ2l0OiBudW1iZXIgPSAwO1xyXG4gIEBJbnB1dCgpIHB1YmxpYyByb3VuZGluZzogc3RyaW5nID0gXCJyb3VuZFwiO1xyXG4gIHB1YmxpYyBzdHJpbmdWYWx1ZTogYW55O1xyXG4gIHB1YmxpYyBmaXJzdEZsYWc6IGJvb2xlYW4gPSB0cnVlO1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHN1cGVyKCk7XHJcbiAgICB0aGlzLmN0bE5hbWUgPSBcIlNIQ3RsTnVtYmVyXCI7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgbmdPbkluaXQoKSB7XHJcbiAgICB0aGlzLm9uSW5pdCgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogbmdPbkNoYW5nZXPjgqTjg5njg7Pjg4hcclxuICAgKiDlgKTlpInmm7TmmYLjgavjg5Xjgqnjg7zjg57jg4Pjg4jjgpLmlbTlvaJcclxuICAgKiBAcGFyYW0gZXZlbnQgaW5wdXRcclxuICAgKi9cclxuICBwdWJsaWMgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xyXG4gICAgaWYgKGNoYW5nZXMudmFsdWUpIHtcclxuICAgICAgaWYgKGNoYW5nZXMudmFsdWUuY3VycmVudFZhbHVlKSB7XHJcbiAgICAgICAgaWYgKGNoYW5nZXMudmFsdWUuY3VycmVudFZhbHVlID09PSAnJyB8fCBjaGFuZ2VzLnZhbHVlLmN1cnJlbnRWYWx1ZSA9PT0gdW5kZWZpbmVkIHx8IGNoYW5nZXMudmFsdWUuY3VycmVudFZhbHVlID09PSBTdHJpbmcoL1teXFx4MDEtXFx4N0VcXHhBMS1cXHhERl0rJC9nKSkge1xyXG4gICAgICAgICAgdGhpcy52YWx1ZSA9ICcnO1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocGFyc2VGbG9hdChjaGFuZ2VzLnZhbHVlLmN1cnJlbnRWYWx1ZSkgPCB0aGlzLm1pbikge1xyXG4gICAgICAgICAgdGhpcy52YWx1ZSA9IFN0cmluZyh0aGlzLm1pbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChwYXJzZUZsb2F0KGNoYW5nZXMudmFsdWUuY3VycmVudFZhbHVlKSA+IHRoaXMubWF4KSB7XHJcbiAgICAgICAgICB0aGlzLnZhbHVlID0gU3RyaW5nKHRoaXMubWF4KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zdHJpbmdWYWx1ZSA9IHRoaXMudG9UZXh0KGNoYW5nZXMudmFsdWUuY3VycmVudFZhbHVlKTtcclxuICAgICAgICBpZiAodGhpcy5yb3VuZGluZyA9PT0gXCJyb3VuZFwiKSB7XHJcbiAgICAgICAgICB0aGlzLnZhbHVlID0gY2hhbmdlcy52YWx1ZS5jdXJyZW50VmFsdWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChTdHJpbmcoY2hhbmdlcy52YWx1ZS5jdXJyZW50VmFsdWUpLmluZGV4T2YoJywnKSA9PT0gLTEpIHtcclxuICAgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnNldE1pbk1heCh0aGlzLnZhbHVlKTtcclxuICAgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnRvVGV4dCh0aGlzLnZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIG5nQWZ0ZXJWaWV3Q2hlY2tlZOOCpOODmeODs+ODiFxyXG4gICAqIOihqOekuueUu+mdouOBqOS/ruato+eUu+mdouOBp+OCq+ODs+ODnue3qOmbhlxyXG4gICAqL1xyXG4gIG5nQWZ0ZXJWaWV3Q2hlY2tlZCgpIHtcclxuICAgIGlmKCF0aGlzLmZpcnN0RmxhZykgcmV0dXJuO1xyXG5cclxuICAgIC8vdGhpcy52YWx1ZeOBjOWtmOWcqOOBmeOCi+OBqOOBjeOBq+OAgeOCq+ODs+ODnue3qOmbhuOCkuOBl+OBquOBkeOCjOOBsOOBquOCieOBquOBhOOAglxyXG4gICAgbGV0IG1hdElucHV0RWxlbWVudCA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtYXQtaW5wdXQtZWxlbWVudCcpO1xyXG4gICAgaWYgKHRoaXMuZmlyc3RGbGFnICYmIHRoaXMudmFsdWUgJiYgIW1hdElucHV0RWxlbWVudCkge1xyXG4gICAgICB0aGlzLnZhbHVlID0gdGhpcy50b1RleHQodGhpcy52YWx1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy90aGlzLnZhbHVl44GM5a2Y5Zyo44GZ44KL44Go44GN44Gr44CBZmlyc3RGbGFn44GrZmFsc2XjgpLku6PlhaXjgZfjgarjgYTjgajjgIHjgqvjg7Pjg57nt6jpm4bjgYzjgZXjgozjgarjgY/jgarjgotcclxuICAgIGlmKHRoaXMudmFsdWUpIHtcclxuICAgICAgdGhpcy5maXJzdEZsYWcgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBvbklucHV0XHJcbiAgICogQHBhcmFtIGV2ZW50IGlucHV0XHJcbiAgICovXHJcbiAgcHVibGljIG9uSW5wdXQoZXZlbnQ6IGFueSkge1xyXG4gICAgU0hDdGxDb21tb24ucmVwbGFjZUhhbGZXaWR0aChldmVudCk7XHJcbiAgICBTSEN0bENvbW1vbi5yZXBsYWNlU3BhY2UoZXZlbnQpO1xyXG4gICAgU0hDdGxDb21tb24ucmVwbGFjZUZVbGxTcGFjZShldmVudCk7XHJcbiAgICBTSEN0bENvbW1vbi5yZXBsYWNlU2lnbihldmVudCwgW1wiLFwiLCBcIlxcLlwiLCBcIlxcLVwiXSk7XHJcbiAgICAvLzLmloflrZfnm67ku6XpmY3jga7jgIwt44CN44Gu5YWl5Yqb44KS5Y+X44GR5LuY44GR44Gq44GEXHJcbiAgICBpZiAoZXZlbnQudGFyZ2V0LnZhbHVlLmxlbmd0aCA+IDEpXHJcbiAgICAgIGV2ZW50LnRhcmdldC52YWx1ZSA9IGV2ZW50LnRhcmdldC52YWx1ZS5zbGljZSgwLCAxKSArIGV2ZW50LnRhcmdldC52YWx1ZS5zbGljZSgxKS5yZXBsYWNlKC9bXFwtXS9nLCBcIlwiKTtcclxuICAgIFNIQ3RsQ29tbW9uLnJlcGxhY2VGdWxsV2lkdGgoZXZlbnQpO1xyXG4gICAgdGhpcy5jaGVja051bWJlcnNTaWducyhldmVudCk7XHJcbiAgICBpZiAoZXZlbnQuaW5wdXRUeXBlICE9PSAnaW5zZXJ0Q29tcG9zaXRpb25UZXh0JykgeyAgXHJcbiAgICAgIFNIQ3RsQ29tbW9uLnJlcGxhY2VTcGFjZShldmVudCk7XHJcbiAgICAgIFNIQ3RsQ29tbW9uLnJlcGxhY2VGVWxsU3BhY2UoZXZlbnQpO1xyXG4gICAgICBTSEN0bENvbW1vbi5yZXBsYWNlU2lnbihldmVudCwgW1wiLFwiLCBcIlxcLlwiLCBcIlxcLVwiXSk7XHJcbiAgICAgIFNIQ3RsQ29tbW9uLnJlcGxhY2VGdWxsV2lkdGgoZXZlbnQpO1xyXG4gICAgICBTSEN0bENvbW1vbi5zbGljZUxlbmd0aChldmVudCwgdGhpcy5tYXhsZW5ndGgpO1xyXG4gICAgICB0aGlzLmNoZWNrTnVtYmVyc1NpZ25zKGV2ZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOODnuODg+ODgeOBl+OBn+WApOOCkuiomOWPt+OBq+e9ruOBjeaPm+OBiOOCi1xyXG4gICAqIEBwYXJhbSBldmVudCBpbnB1dFxyXG4gICAqL1xyXG4gIHB1YmxpYyBjaGVja051bWJlcnNTaWducyhldmVudDogYW55KSB7XHJcbiAgICBldmVudC50YXJnZXQudmFsdWUgPSBldmVudC50YXJnZXQudmFsdWUucmVwbGFjZSgvXltcXC58LF0vZywgXCJcIik7XHJcbiAgICBldmVudC50YXJnZXQudmFsdWUgPSBldmVudC50YXJnZXQudmFsdWUucmVwbGFjZSgvW1xcLl17Mix9L2csIFwiLlwiKTtcclxuICAgIGV2ZW50LnRhcmdldC52YWx1ZSA9IGV2ZW50LnRhcmdldC52YWx1ZS5yZXBsYWNlKC9bXFwsXXsyLH0vZywgXCIsXCIpO1xyXG4gICAgZXZlbnQudGFyZ2V0LnZhbHVlID0gZXZlbnQudGFyZ2V0LnZhbHVlLnJlcGxhY2UoL1tcXC1dezEsfS9nLCBcIi1cIik7XHJcbiAgICBpZiAoKC9cXGQuKlxcLlxcZC4qLykudGVzdChldmVudC50YXJnZXQudmFsdWUpICYmIGV2ZW50LmRhdGEgPT09IFwiLlwiKSB7XHJcbiAgICAgIGV2ZW50LnRhcmdldC52YWx1ZSA9IGV2ZW50LnRhcmdldC52YWx1ZS5zbGljZSgwLCBldmVudC50YXJnZXQudmFsdWUubGVuZ3RoIC0gMSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBvbkNsaWNrXHJcbiAgICogQHBhcmFtIGV2ZW50IGNsaWNrXHJcbiAgICovXHJcbiAgcHVibGljIG9uQ2xpY2soZXZlbnQpIHtcclxuICAgIHRoaXMub25CZWZvcmVDbGljayhldmVudCk7XHJcblxyXG4gICAgdGhpcy5vbkFmdGVyQ2xpY2soZXZlbnQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogb25LZXlEb3duXHJcbiAgICogQHBhcmFtIGV2ZW50IGtleWRvd25cclxuICAgKi9cclxuICBvbktleURvd24oZXZlbnQpIHtcclxuICAgIGlmKGV2ZW50LmtleUNvZGUgPT0gU2hDdGxDb25zdC5PUkRJTkFMLktFWVMuS0VZX1RBQikge1xyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICBldmVudC50YXJnZXQudmFsdWUgPSB0aGlzLnRvVGV4dChldmVudC50YXJnZXQudmFsdWUpO1xyXG4gICAgICB9LCAwKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIG9uQ2hhbmdlXHJcbiAgICogQHBhcmFtIGV2ZW50IGNoYW5nZVxyXG4gICAqL1xyXG4gIHB1YmxpYyBvbkNoYW5nZShldmVudCkge1xyXG4gICAgdGhpcy5vbkJlZm9yZUNoYW5nZShldmVudCk7XHJcblxyXG4gICAgLy9lbWl044Gu55u05YmN44Gr44KC5YCk44Gu57K+5p+744KS6KGM44GGXHJcbiAgICB0aGlzLm9uSW5wdXQoZXZlbnQpO1xyXG5cclxuICAgIC8vb25DaGFuZ2XnmbrngavmmYLjgavmlbDlgKTjgafjgarjgZHjgozjgbDjgq/jg6rjgqLjgZnjgotcclxuICAgIGlmIChpc05hTihOdW1iZXIoZXZlbnQudGFyZ2V0LnZhbHVlKSkgPT09IHRydWUpIHtcclxuICAgICAgZXZlbnQudGFyZ2V0LnZhbHVlID0gJyc7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvL21pbiBtYXjjga7lgKTjgpLlj43mmKDjgZXjgZvjgotcclxuICAgIGV2ZW50LnRhcmdldC52YWx1ZSA9IHRoaXMuc2V0TWluTWF4KGV2ZW50LnRhcmdldC52YWx1ZSk7XHJcbiAgICBldmVudC50YXJnZXQudmFsdWUgPSB0aGlzLnRvVGV4dChldmVudC50YXJnZXQudmFsdWUpO1xyXG4gICAgdGhpcy52YWx1ZUNoYW5nZS5lbWl0KE51bWJlcih0aGlzLnJlbW92ZUNvbW1hKGV2ZW50LnRhcmdldC52YWx1ZSkpKTtcclxuXHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHt0aGlzLm9uQWZ0ZXJDaGFuZ2UoZXZlbnQpfSwgMCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBvbkZvY3VzXHJcbiAgICogQHBhcmFtIGV2ZW50IGZvY3VzXHJcbiAgICovXHJcbiAgcHVibGljIG9uRm9jdXMoZXZlbnQ6IGFueSkge1xyXG4gICAgdGhpcy5vbkJlZm9yZUZvY3VzKGV2ZW50KTtcclxuXHJcbiAgICBldmVudC50YXJnZXQudmFsdWUgPSB0aGlzLnJlbW92ZUNvbW1hKGV2ZW50LnRhcmdldC52YWx1ZSk7XHJcbiAgICBldmVudC50YXJnZXQuc2VsZWN0KCk7XHJcblxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7dGhpcy5vbkFmdGVyRm9jdXMoZXZlbnQpfSwgMCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBvbkJsdXJcclxuICAgKiBAcGFyYW0gZXZlbnQgYmx1clxyXG4gICAqL1xyXG4gIHB1YmxpYyBvbkJsdXIoZXZlbnQ6IGFueSkge1xyXG4gICAgLy/moYHmlbDmjIflrprjgaflgKTjgpLkuLjjgoHjgotcclxuICAgIHRoaXMub25CZWZvcmVCbHVyKGV2ZW50KTtcclxuICAgIFxyXG4gICAgLy/jgqvjg7Pjg57ljLrliIfjgopcclxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICBldmVudC50YXJnZXQudmFsdWUgPSB0aGlzLnRvVGV4dChldmVudC50YXJnZXQudmFsdWUpO1xyXG4gICAgfSwgMCk7XHJcblxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7dGhpcy5vbkFmdGVyQmx1cihldmVudCk7fSwgMCk7O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog44Kr44Oz44Oe5LuY44GN44Gu5YCk44KS6L+U44GZXHJcbiAgICogQHBhcmFtIGlucHV0VGFyZ2V0VmFsdWUgZXZlbnQudGFyZ2V0LnZhbHVlXHJcbiAgICovXHJcbiAgcHVibGljIHRvVGV4dChpbnB1dFRhcmdldFZhbHVlOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgaW5wdXRUYXJnZXRWYWx1ZSA9IHRoaXMucmVtb3ZlQ29tbWEoaW5wdXRUYXJnZXRWYWx1ZSlcclxuICAgIGlmICghaW5wdXRUYXJnZXRWYWx1ZSkgcmV0dXJuIG51bGw7XHJcbiAgICBpZiAoaXNOYU4oTnVtYmVyKGlucHV0VGFyZ2V0VmFsdWUpKSkgcmV0dXJuIG51bGw7XHJcbiAgICBpZih0aGlzLnJvdW5kaW5nID09PSBcInJvdW5kXCIpIHtcclxuICAgICAgLy/moYHmlbDmjIflrprjgaflgKTjgpLkuLjjgoHjgotcclxuICAgICAgbGV0IHJldCA9ICBwYXJzZUZsb2F0KHBhcnNlRmxvYXQoaW5wdXRUYXJnZXRWYWx1ZSkudG9GaXhlZCh0aGlzLmRlY2ltYWxkaWdpdCkpLnRvU3RyaW5nKCk7XHJcbiAgICAgIHJldHVybiBwYXJzZUZsb2F0KHJldCkudG9Mb2NhbGVTdHJpbmcodW5kZWZpbmVkLCB7XHJcbiAgICAgICAgbWluaW11bUZyYWN0aW9uRGlnaXRzOiB0aGlzLmRlY2ltYWxkaWdpdCxcclxuICAgICAgICBtYXhpbXVtRnJhY3Rpb25EaWdpdHM6IHRoaXMuZGVjaW1hbGRpZ2l0XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIGlmICh0aGlzLnJvdW5kaW5nID09PSBcImZsb29yXCIpIHtcclxuICAgICAgLy/moYHmlbDmjIflrprjgaflgKTjgpLkuLjjgoHjgotcclxuICAgICAgY29uc3QgRkxPT1IgPSAodmFsdWUsIGRlY2ltYWxEaWdpdCkgPT4gdGhpcy5kZWNpbWFsQWRqdXN0KHRoaXMucm91bmRpbmcsIHZhbHVlLCBkZWNpbWFsRGlnaXQpO1xyXG4gICAgICBsZXQgcmV0ID0gIEZMT09SKHBhcnNlRmxvYXQoaW5wdXRUYXJnZXRWYWx1ZSksIC10aGlzLmRlY2ltYWxkaWdpdCkudG9TdHJpbmcoKTtcclxuICAgICAgcmV0dXJuIHBhcnNlRmxvYXQocmV0KS50b0xvY2FsZVN0cmluZyh1bmRlZmluZWQsIHtcclxuICAgICAgICBtaW5pbXVtRnJhY3Rpb25EaWdpdHM6IHRoaXMuZGVjaW1hbGRpZ2l0LFxyXG4gICAgICAgIG1heGltdW1GcmFjdGlvbkRpZ2l0czogdGhpcy5kZWNpbWFsZGlnaXRcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMucm91bmRpbmcgPT09IFwiY2VpbFwiKSB7XHJcbiAgICAgIC8v5qGB5pWw5oyH5a6a44Gn5YCk44KS5Li444KB44KLXHJcbiAgICAgIGNvbnN0IENFSUwgPSAodmFsdWUsIGRlY2ltYWxEaWdpdCkgPT4gdGhpcy5kZWNpbWFsQWRqdXN0KHRoaXMucm91bmRpbmcsIHZhbHVlLCBkZWNpbWFsRGlnaXQpO1xyXG4gICAgICBsZXQgcmV0ID0gIENFSUwocGFyc2VGbG9hdChpbnB1dFRhcmdldFZhbHVlKSwgLXRoaXMuZGVjaW1hbGRpZ2l0KS50b1N0cmluZygpO1xyXG4gICAgICByZXR1cm4gcGFyc2VGbG9hdChyZXQpLnRvTG9jYWxlU3RyaW5nKHVuZGVmaW5lZCwge1xyXG4gICAgICAgIG1pbmltdW1GcmFjdGlvbkRpZ2l0czogdGhpcy5kZWNpbWFsZGlnaXQsXHJcbiAgICAgICAgbWF4aW11bUZyYWN0aW9uRGlnaXRzOiB0aGlzLmRlY2ltYWxkaWdpdFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIG1pbiBtYXjjgpLlj43mmKDjgZfjgZ/lgKTjgpLov5TjgZlcclxuICAgKiBAcGFyYW0gaW5wdXRUYXJnZXRWYWx1ZSBldmVudC50YXJnZXQudmFsdWVcclxuICAgKi9cclxuICBwdWJsaWMgc2V0TWluTWF4KGlucHV0VGFyZ2V0VmFsdWU6IHN0cmluZykge1xyXG4gICAgaWYgKCFpbnB1dFRhcmdldFZhbHVlKSByZXR1cm4gXCJcIjtcclxuICAgIGlmIChpc05hTihOdW1iZXIoaW5wdXRUYXJnZXRWYWx1ZSkpKSByZXR1cm4gXCJcIjtcclxuICAgIGlmIChwYXJzZUZsb2F0KGlucHV0VGFyZ2V0VmFsdWUpIDwgdGhpcy5taW4pIHtcclxuICAgICAgaW5wdXRUYXJnZXRWYWx1ZSA9IHRoaXMubWluLnRvU3RyaW5nKCk7XHJcbiAgICB9XHJcbiAgICBpZiAocGFyc2VGbG9hdChpbnB1dFRhcmdldFZhbHVlKSA+IHRoaXMubWF4KSB7XHJcbiAgICAgIGlucHV0VGFyZ2V0VmFsdWUgPSB0aGlzLm1heC50b1N0cmluZygpO1xyXG4gICAgfVxyXG4gICAgaWYodGhpcy5yb3VuZGluZyA9PT0gXCJyb3VuZFwiKSB7XHJcbiAgICAgIGxldCB3ID0gTWF0aC5wb3coMTAgLCB0aGlzLmRlY2ltYWxkaWdpdCk7XHJcbiAgICAgIGlucHV0VGFyZ2V0VmFsdWUgPSAoTWF0aC5yb3VuZCgraW5wdXRUYXJnZXRWYWx1ZSAqIHcgKyAxZS0xMCkvdykudG9TdHJpbmcoKTtcclxuICAgICAgcmV0dXJuIGlucHV0VGFyZ2V0VmFsdWU7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMucm91bmRpbmcgPT09IFwiZmxvb3JcIiB8fCB0aGlzLnJvdW5kaW5nID09PSBcImNlaWxcIikge1xyXG4gICAgICByZXR1cm4gaW5wdXRUYXJnZXRWYWx1ZTtcclxuICAgIH0gXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiByb3VuZGluZ+OBjGZsb29y44GLY2VpbOOBruaZguOBq+WIh+OCiuaNqOOBpuWIh+OCiuS4iuOBkuWHpueQhuOCkuihjOOBhlxyXG4gICAqIEBwYXJhbSB0eXBlIGZsb29yIG9yIGNlaWwgXHJcbiAgICogQHBhcmFtIHZhbHVlIHZhbHVlXHJcbiAgICogQHBhcmFtIGRlY2ltYWxEaWdpdCBkZWNpbWFsRGlnaXRcclxuICAgKi9cclxuICBwdWJsaWMgZGVjaW1hbEFkanVzdCh0eXBlLCB2YWx1ZSwgZGVjaW1hbERpZ2l0KSB7XHJcbiAgICBpZiAodHlwZW9mIGRlY2ltYWxEaWdpdCA9PT0gJ3VuZGVmaW5lZCcgfHwgK2RlY2ltYWxEaWdpdCA9PT0gMCkge1xyXG4gICAgICByZXR1cm4gTWF0aFt0eXBlXSh2YWx1ZSk7XHJcbiAgICB9XHJcbiAgICB2YWx1ZSA9ICt2YWx1ZTtcclxuICAgIGRlY2ltYWxEaWdpdCA9ICtkZWNpbWFsRGlnaXQ7XHJcbiAgICBpZiAoaXNOYU4odmFsdWUpIHx8ICEodHlwZW9mIGRlY2ltYWxEaWdpdCA9PT0gJ251bWJlcicgJiYgZGVjaW1hbERpZ2l0ICUgMSA9PT0gMCkpIHtcclxuICAgICAgcmV0dXJuIE5hTjtcclxuICAgIH1cclxuICAgIHZhbHVlID0gdmFsdWUudG9TdHJpbmcoKS5zcGxpdCgnZScpO1xyXG4gICAgdmFsdWUgPSBNYXRoW3R5cGVdKCsodmFsdWVbMF0gKyAnZScgKyAodmFsdWVbMV0gPyAoK3ZhbHVlWzFdIC0gZGVjaW1hbERpZ2l0KSA6IC1kZWNpbWFsRGlnaXQpKSk7XHJcbiAgICB2YWx1ZSA9IHZhbHVlLnRvU3RyaW5nKCkuc3BsaXQoJ2UnKTtcclxuICAgIHZhbHVlID0gKyh2YWx1ZVswXSArICdlJyArICh2YWx1ZVsxXSA/ICgrdmFsdWVbMV0gKyBkZWNpbWFsRGlnaXQpIDogZGVjaW1hbERpZ2l0KSk7XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDjgqvjg7Pjg57jgpLlpJbjgZfjgZ/lgKTjgpLov5TjgZlcclxuICAgKiBAcGFyYW0gaW5wdXRUYXJnZXRWYWx1ZSBldmVudC50YXJnZXQudmFsdWVcclxuICAgKi9cclxuICBwdWJsaWMgcmVtb3ZlQ29tbWEoaW5wdXRUYXJnZXRWYWx1ZTogc3RyaW5nKSB7XHJcbiAgICBpbnB1dFRhcmdldFZhbHVlID0gbmV3IFN0cmluZyhpbnB1dFRhcmdldFZhbHVlKS5yZXBsYWNlKC8sL2csIFwiXCIpO1xyXG4gICAgcmV0dXJuIGlucHV0VGFyZ2V0VmFsdWU7XHJcbiAgfVxyXG5cclxufVxyXG4iXX0=