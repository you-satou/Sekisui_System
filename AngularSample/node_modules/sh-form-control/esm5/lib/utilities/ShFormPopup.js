/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Input } from "@angular/core";
import { SHCtlCommon } from "../components/sh-ctl-common";
import { ShCtlConst } from "../constShCtl";
import { SHFormControl } from "./ShFormControl";
import { SHCtlPopupDialogComponent } from "../components/sh-ctl-popup-dialog/sh-ctl-popup-dialog.component";
var SHFormPopup = /** @class */ (function (_super) {
    tslib_1.__extends(SHFormPopup, _super);
    function SHFormPopup(SmplPopupService, dialog, bindCtlService, lockScreenService) {
        var _this = _super.call(this) || this;
        _this.SmplPopupService = SmplPopupService;
        _this.dialog = dialog;
        _this.bindCtlService = bindCtlService;
        _this.lockScreenService = lockScreenService;
        //データタイトル名
        _this.dataTitle = "";
        //データ区分名
        _this.dataKbnName = "";
        //API URL
        _this.apiUrl = "/api/";
        //入力コントロールに紐づく列番号
        _this.bindColumnKey = 1;
        //ラベルコントロールに紐づく列番号
        _this.bindColumnValue = 2;
        //入力コントロールを非表示にするモードフラグ
        _this.hiddenInput = false;
        //ラベルを非表示にするモードフラグ
        _this.hiddenLabel = false;
        //虫眼鏡アイコンを非表示にするモードフラグ
        _this.hiddenPopupButton = false;
        //データキャッシュON/OFF機能フラグ
        _this.dataCache = false;
        //ポップアップ上非表示となる列番号
        _this.hiddenColumns = [];
        _this.name = "";
        _this.codes = [];
        _this.codesHeader = [];
        _this.extendWidth = ShCtlConst.DIALOG_WIDTH;
        //Dialogの結果を受け取る
        _this.dialogRef = null;
        // 初回通信用フラグ
        _this.initFetchFlg = false;
        // bindColumnArrayを利用し値が設定された場合にチェンジを止める
        _this.noChangeFlg = "OFF";
        // 通信中かどうか
        _this.isBusy = false;
        _this.ctlName = "SHCtlPopup";
        return _this;
    }
    Object.defineProperty(SHFormPopup.prototype, "noChangeFlgCtlName", {
        // bindColumnArrayを利用し値が設定された場合にチェンジを止める
        get: 
        // bindColumnArrayを利用し値が設定された場合にチェンジを止める
        /**
         * @return {?}
         */
        function () {
            return this.ctlName + "_" + ShCtlConst.NO_CHANGE.FLG_SUFFIX;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SHFormPopup.prototype, "ownValueInputElm", {
        // inputの参照
        get: 
        // inputの参照
        /**
         * @return {?}
         */
        function () {
            return ((/** @type {?} */ ((document.querySelector("textarea[name=" + this.ctlName + "], input[name=" + this.ctlName + "]")))) || null);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SHFormPopup.prototype, "ownLabelInputElm", {
        get: /**
         * @return {?}
         */
        function () {
            return (/** @type {?} */ (((document.querySelector("textarea[name=" + this.popupLabelName + "], input[name=" + this.popupLabelName + "]") || null))));
        },
        enumerable: true,
        configurable: true
    });
    /**
     *
     */
    /**
     *
     * @param {?} event
     * @return {?}
     */
    SHFormPopup.prototype.noChangeFlgChange = /**
     *
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var _this = this;
        this.noChangeFlg = event.target.value;
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.noChangeFlg = "OFF";
        }), 1000);
    };
    /**
     * 入力コントロールの幅を指定
     */
    /**
     * 入力コントロールの幅を指定
     * @return {?}
     */
    SHFormPopup.prototype.setInputWidth = /**
     * 入力コントロールの幅を指定
     * @return {?}
     */
    function () {
        return this.hiddenLabel ? { width: "100%" } : { width: "33.3%" };
    };
    /**
     * ラベルコントロールの幅を指定
     */
    /**
     * ラベルコントロールの幅を指定
     * @return {?}
     */
    SHFormPopup.prototype.setLabelWidth = /**
     * ラベルコントロールの幅を指定
     * @return {?}
     */
    function () {
        return this.hiddenInput ? { width: "100%" } : { width: "66.6%" };
    };
    /**
     * データバインドされた値を再設定する際に値を検証し
     * 親コンポーネントに渡す
     * @param changes 現在の値と直前の値を取得出来る
     */
    /**
     * データバインドされた値を再設定する際に値を検証し
     * 親コンポーネントに渡す
     * @param {?} changes 現在の値と直前の値を取得出来る
     * @return {?}
     */
    SHFormPopup.prototype.ngOnChanges = /**
     * データバインドされた値を再設定する際に値を検証し
     * 親コンポーネントに渡す
     * @param {?} changes 現在の値と直前の値を取得出来る
     * @return {?}
     */
    function (changes) {
        var _this = this;
        if (changes.value && !changes.value.currentValue) {
            this.name = "";
            this.value = "";
            return;
        }
        if (this.noChangeFlg == "OFF") {
            if (changes.value && changes.value.currentValue) {
                if (changes.value.currentValue != changes.value.previousValue) {
                    this.fetchCodes(this.apiUrl);
                    return;
                }
            }
            if (changes.value && changes.value.firstChange) {
                this.initFetchFlg = true;
            }
            if (this.initFetchFlg) {
                if (!this.value || !changes.value.currentValue)
                    return;
                this.fetchCodes(this.apiUrl);
                this.initFetchFlg = false;
            }
            if (changes.apiUrl &&
                changes.apiUrl.previousValue != changes.apiUrl.currentValue &&
                !this.isBindInputNull(this.bindColumnArray)) {
                if (this.SmplPopupService.getMasterData(changes.apiUrl.currentValue)
                    .length == 0) {
                    if (changes.value &&
                        changes.value.currentValue == changes.value.previousValue)
                        return;
                    this.fetchCodes(changes.apiUrl.currentValue);
                }
                else {
                    this.codes = Object(this.SmplPopupService.getMasterData(changes.apiUrl.currentValue)).data;
                    this.value = this.setName(this.value);
                }
            }
        }
        setTimeout((/**
         * @return {?}
         */
        function () {
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.noChangeFlg = "OFF";
            }), 1000);
        }), 0);
    };
    /**
     *プロパティの初期化
     *通常サービスにキャッシュしているが、無ければ再度マスタより取得
     */
    /**
     * プロパティの初期化
     * 通常サービスにキャッシュしているが、無ければ再度マスタより取得
     * @return {?}
     */
    SHFormPopup.prototype.ngOnInit = /**
     * プロパティの初期化
     * 通常サービスにキャッシュしているが、無ければ再度マスタより取得
     * @return {?}
     */
    function () {
        var _this = this;
        this.onInit();
        if (this.popupWidth) {
            this.extendWidth = this.popupWidth;
        }
        // //ユニークな文字列
        if (this.isDisabled) {
            if (this.SmplPopupService.getMasterData(this.apiUrl).length <= 0) {
                this.SmplPopupService.fetchAll(this.apiUrl).then((/**
                 * @param {?} response
                 * @return {?}
                 */
                function (response) {
                    _this.codes = response.data;
                    _this.codesHeader = Object.values(response.header);
                }));
            }
        }
    };
    /**
     *api 通信 マスタから取得
     */
    /**
     * api 通信 マスタから取得
     * @param {?} url
     * @param {?=} value
     * @return {?}
     */
    SHFormPopup.prototype.fetchCodes = /**
     * api 通信 マスタから取得
     * @param {?} url
     * @param {?=} value
     * @return {?}
     */
    function (url, value) {
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            var _this = this;
            return tslib_1.__generator(this, function (_a) {
                if (this.isBusy)
                    return [2 /*return*/];
                this.isBusy = true;
                this.lockScreenService.lockScreen();
                ((/** @type {?} */ (document.activeElement))).blur();
                return [2 /*return*/, Promise.resolve(this.SmplPopupService.fetchAll(url)).catch((/**
                     * @param {?} _
                     * @return {?}
                     */
                    function (_) { _this.lockScreenService.unlock(); })).then((/**
                     * @param {?} response
                     * @return {?}
                     */
                    function (response) {
                        _this.codes = response.data;
                        _this.codesHeader = Object.values(response.header);
                        _this.dataTitle = response.title;
                        /** @type {?} */
                        var ok = _this.checkValue(value || _this.value);
                        /** @type {?} */
                        var result = "";
                        if (ok) {
                            if (value || _this.value) {
                                result = _this.setName(value || _this.value);
                            }
                            if (_this.dataCache) {
                                _this.SmplPopupService.setMasterData(url, response);
                            }
                        }
                        _this.isBusy = false;
                        return new Promise((/**
                         * @param {?} resolve
                         * @return {?}
                         */
                        function (resolve) {
                            resolve(result);
                            _this.lockScreenService.unlock();
                        }));
                    }))];
            });
        });
    };
    /**
     * onInput
     * @param event input
     */
    /**
     * onInput
     * @param {?} event input
     * @return {?}
     */
    SHFormPopup.prototype.onInput = /**
     * onInput
     * @param {?} event input
     * @return {?}
     */
    function (event) {
        SHCtlCommon.replaceSpace(event);
        SHCtlCommon.replaceFullWidth(event);
        SHCtlCommon.replaceSign(event);
    };
    /**
     * ダイアログを開いて閉じる時に値を親に返す
     */
    /**
     * ダイアログを開いて閉じる時に値を親に返す
     * @return {?}
     */
    SHFormPopup.prototype.openDialog = /**
     * ダイアログを開いて閉じる時に値を親に返す
     * @return {?}
     */
    function () {
        var _this = this;
        // valueの値を一時対比　ダイアログを閉じる際に比較します
        /** @type {?} */
        var tmp = this.value;
        if (!this.popupWidth &&
            this.codes.length != 0 &&
            Object.values(this.codes[0]).length >= 4) {
            this.extendWidth = ShCtlConst.DIALOG_MAX_WIDTH;
        }
        this.dialogRef = this.dialog.open(SHCtlPopupDialogComponent, {
            height: ShCtlConst.DIALOG_HEIGHT,
            width: this.extendWidth,
            data: {
                dataTitle: this.dataTitle,
                codes: this.codes,
                codesHeader: this.codesHeader,
                hiddenColumns: this.hiddenColumns,
            },
        });
        this.dialogRef.afterClosed().subscribe((/**
         * @param {?} result
         * @return {?}
         */
        function (result) {
            if (result) {
                _this.setValueName(result);
                //this.allocateToInputValue(result);
                _this.bindCtlService.setNoChangeFlg({
                    bindColumnArray: _this.bindColumnArray,
                    record: result,
                });
                _this.bindCtlService.setBindValue({
                    bindColumnArray: _this.bindColumnArray,
                    record: result,
                });
                _this.noChangeFlg = "ON";
                //changeイベント経由でemitすると無条件でafterChangeイベントが呼ばれるので
                //値を比較し変更がなければこのタイミングでemitする
                /** @type {?} */
                var resultValues = Object.values(result);
                if (resultValues && resultValues.includes(tmp)) {
                    _this.valueChange.emit(_this.value);
                    return;
                }
                setTimeout((/**
                 * @return {?}
                 */
                function () {
                    _this.dispatchOwnValueInputChangeEvent();
                }), 0);
            }
        }));
    };
    /**
     *@ 自身のvalueに紐づくinputのチェンジイベントを発火
     */
    /**
     * \@ 自身のvalueに紐づくinputのチェンジイベントを発火
     * @private
     * @return {?}
     */
    SHFormPopup.prototype.dispatchOwnValueInputChangeEvent = /**
     * \@ 自身のvalueに紐づくinputのチェンジイベントを発火
     * @private
     * @return {?}
     */
    function () {
        if (this.ownValueInputElm) {
            this.ownValueInputElm.dispatchEvent(new Event("change"));
        }
    };
    /**
     *@ bind先のinputがnullかどうか
     */
    /**
     * \@ bind先のinputがnullかどうか
     * @param {?} bindColumnArray
     * @return {?}
     */
    SHFormPopup.prototype.isBindInputNull = /**
     * \@ bind先のinputがnullかどうか
     * @param {?} bindColumnArray
     * @return {?}
     */
    function (bindColumnArray) {
        if (!bindColumnArray || bindColumnArray.length == 0)
            return true;
        return bindColumnArray
            .map((/**
         * @param {?} bindColumnData
         * @return {?}
         */
        function (bindColumnData) {
            return (/** @type {?} */ (document.querySelector("input[name=" + Object.keys(bindColumnData)[0] + "]")));
        }))
            .map((/**
         * @param {?} bindInput
         * @return {?}
         */
        function (bindInput) {
            if (!bindInput)
                return false;
            return !!bindInput.value;
        }))
            .includes(false);
    };
    /**
     * onClick
     * @param event click
     */
    /**
     * onClick
     * @param {?} event click
     * @return {?}
     */
    SHFormPopup.prototype.onClick = /**
     * onClick
     * @param {?} event click
     * @return {?}
     */
    function (event) {
        var _this = this;
        this.onBeforeClick(event);
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.onAfterClick(event);
        }), 0);
    };
    /**
     * onFocus
     * @param event focus
     */
    /**
     * onFocus
     * @param {?} event focus
     * @return {?}
     */
    SHFormPopup.prototype.onFocus = /**
     * onFocus
     * @param {?} event focus
     * @return {?}
     */
    function (event) {
        var _this = this;
        this.onBeforeFocus(event);
        event.target.select();
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.onAfterFocus(event);
        }), 0);
    };
    /**
     * @return {?}
     */
    SHFormPopup.prototype.clearAll = /**
     * @return {?}
     */
    function () {
        this.value = "";
        this.name = "";
        if (this.ownLabelInputElm) {
            this.ownLabelInputElm.value = "";
        }
        this.valueChange.emit("");
    };
    /**
     * onChange
     * @param event change
     */
    /**
     * onChange
     * @param {?} event change
     * @return {?}
     */
    SHFormPopup.prototype.onChange = /**
     * onChange
     * @param {?} event change
     * @return {?}
     */
    function (event) {
        var _this = this;
        this.onBeforeChange(event);
        if (!event.target.value) {
            this.clearAll();
        }
        /** @type {?} */
        var flg = false;
        if (this.noChangeFlg == "OFF") {
            flg = true;
            if (this.SmplPopupService.getMasterData(this.apiUrl).length == 0 &&
                event.target.value) {
                this.noChangeFlg = "ON";
                this.fetchCodes(this.apiUrl, this.toText(event.target.value)).then((/**
                 * @param {?} value
                 * @return {?}
                 */
                function (value) {
                    _this.valueChange.emit(value);
                    event.target.value = _this.toText(event.target.value);
                    setTimeout((/**
                     * @return {?}
                     */
                    function () {
                        _this.onAfterChange(event);
                    }), 0);
                }));
            }
            else {
                event.target.value = this.setName(event.target.value);
                this.valueChange.emit(event.target.value);
                setTimeout((/**
                 * @return {?}
                 */
                function () {
                    _this.onAfterChange(event);
                }), 0);
            }
        }
        if (!flg) {
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.valueChange.emit(event.target.value);
                _this.onAfterChange(event);
                setTimeout((/**
                 * @return {?}
                 */
                function () {
                    _this.noChangeFlg = "OFF";
                }), 1000);
            }), 0);
        }
    };
    /**
     * onBlur
     * @param event blur
     */
    /**
     * onBlur
     * @param {?} event blur
     * @return {?}
     */
    SHFormPopup.prototype.onBlur = /**
     * onBlur
     * @param {?} event blur
     * @return {?}
     */
    function (event) {
        var _this = this;
        this.onBeforeBlur(event);
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.onAfterBlur(event);
        }), 0);
    };
    /**
     *手入力の値からの検索結果が複数あった場合はアラートを出す
     */
    /**
     * 手入力の値からの検索結果が複数あった場合はアラートを出す
     * @param {?} value
     * @return {?}
     */
    SHFormPopup.prototype.checkValue = /**
     * 手入力の値からの検索結果が複数あった場合はアラートを出す
     * @param {?} value
     * @return {?}
     */
    function (value) {
        var _this = this;
        if (!value)
            return false;
        //let matchedArray = [];
        if (this.codes[0]) {
            /** @type {?} */
            var filterResult = this.codes.filter((/**
             * @param {?} element
             * @return {?}
             */
            function (element) {
                //this.hasMatchRecords(element, value)
                return Object.values(element)[_this.bindColumnKey - 1] == value;
            }));
            if (filterResult.length == 0) {
                this.clearValue();
                this.valueChange.emit("");
                return false;
            }
            if (filterResult.length >= 2) {
                alert(value + "に複数の候補が検出されました");
                this.clearValue();
                this.valueChange.emit("");
                return false;
            }
        }
        return true;
    };
    /**
     * マスタ情報よりコードを取得
     */
    /**
     * マスタ情報よりコードを取得
     * @return {?}
     */
    SHFormPopup.prototype.getCodes = /**
     * マスタ情報よりコードを取得
     * @return {?}
     */
    function () {
        var _this = this;
        this.openDialog();
        if (this.SmplPopupService.getMasterData(this.apiUrl).length == 0) {
            this.SmplPopupService.fetchAll(this.apiUrl).then((/**
             * @param {?} response
             * @return {?}
             */
            function (response) {
                _this.codes = response.data;
                _this.codesHeader = Object.values(response.header);
                _this.dataTitle = response.title;
                if (_this.dataCache)
                    _this.SmplPopupService.setMasterData(_this.apiUrl, response);
                if (!_this.dialogRef)
                    return;
                if (_this.dialogRef.componentInstance) {
                    _this.dialogRef.componentInstance.codesHeader = _this.codesHeader;
                    _this.dialogRef.componentInstance.unchangeableCodes = _this.codes;
                    _this.dialogRef.componentInstance.codes = _this.codes;
                    _this.dialogRef.componentInstance.dataTitle = _this.dataTitle;
                    if (!_this.popupWidth && Object.values(_this.codes[0]).length >= 4) {
                        _this.extendWidth = ShCtlConst.DIALOG_MAX_WIDTH;
                    }
                    _this.dialogRef.updateSize(_this.extendWidth, ShCtlConst.DIALOG_HEIGHT);
                    /** @type {?} */
                    var cols_1 = [];
                    _this.dialogRef.componentInstance
                        .getHashKeys()
                        .forEach((/**
                     * @param {?} name
                     * @param {?} idx
                     * @return {?}
                     */
                    function (name, idx) {
                        if (!_this.hiddenColumns.find((/**
                         * @param {?} _
                         * @return {?}
                         */
                        function (_) { return _ == idx + 1; })))
                            cols_1.push(name);
                    }));
                    _this.dialogRef.componentInstance.displayedColumns = cols_1;
                }
            }));
        }
        else {
            this.codes = Object(this.SmplPopupService.getMasterData(this.apiUrl)).data;
            this.codesHeader = Object.values(Object(this.SmplPopupService.getMasterData(this.apiUrl)).header);
            if (this.dialogRef.componentInstance) {
                this.dialogRef.componentInstance.codesHeader = this.codesHeader;
                this.dialogRef.componentInstance.unchangeableCodes = this.codes;
                this.dialogRef.componentInstance.codes = this.codes;
                this.dialogRef.componentInstance.dataTitle = this.dataTitle;
                if (!this.popupWidth && Object.values(this.codes[0]).length >= 4) {
                    this.extendWidth = ShCtlConst.DIALOG_MAX_WIDTH;
                }
                this.dialogRef.updateSize(this.extendWidth, ShCtlConst.DIALOG_HEIGHT);
                /** @type {?} */
                var cols_2 = [];
                this.dialogRef.componentInstance.getHashKeys().forEach((/**
                 * @param {?} name
                 * @param {?} idx
                 * @return {?}
                 */
                function (name, idx) {
                    if (!_this.hiddenColumns.find((/**
                     * @param {?} _
                     * @return {?}
                     */
                    function (_) { return _ == idx + 1; })))
                        cols_2.push(name);
                }));
                this.dialogRef.componentInstance.displayedColumns = cols_2;
            }
        }
    };
    /**
     * 自コントロールのinput value に値を渡す
     * @param matchedArray
     */
    /**
     * 自コントロールのinput value に値を渡す
     * @param {?} matchedArray
     * @return {?}
     */
    SHFormPopup.prototype.setValueName = /**
     * 自コントロールのinput value に値を渡す
     * @param {?} matchedArray
     * @return {?}
     */
    function (matchedArray) {
        if (Object.values(matchedArray)[this.bindColumnKey - 1]) {
            /** @type {?} */
            var val = Object.values(matchedArray)[this.bindColumnKey - 1].toString();
            this.value = val;
        }
        else {
            this.value = "";
        }
        if (Object.values(matchedArray)[this.bindColumnValue - 1]) {
            this.name = Object.values(matchedArray)[this.bindColumnValue - 1].toString();
        }
        else {
            this.name = "";
        }
    };
    /**
     *親子関係になっているinputがある場合に検索対象を親まで広げる
     */
    /**
     * 親子関係になっているinputがある場合に検索対象を親まで広げる
     * @private
     * @param {?} element
     * @param {?} val
     * @return {?}
     */
    SHFormPopup.prototype.hasMatchRecords = /**
     * 親子関係になっているinputがある場合に検索対象を親まで広げる
     * @private
     * @param {?} element
     * @param {?} val
     * @return {?}
     */
    function (element, val) {
        // 検索結果一行分の比較すべき列の値
        /** @type {?} */
        var searchs = [];
        // 現在の比較すべき値
        /** @type {?} */
        var values = [val];
        searchs.push(Object.values(element)[this.bindColumnKey - 1]);
        if (this.bindColumnArray && this.bindColumnArray.length != 0) {
            this.bindColumnArray.forEach((/**
             * @param {?} data
             * @return {?}
             */
            function (data) {
                /** @type {?} */
                var bindIndex = ((/** @type {?} */ (Object.values(data)[0]))) - 1;
                searchs.push(Object.values(element)[bindIndex]);
                /** @type {?} */
                var targetInput = (/** @type {?} */ (document.querySelector("input[name=" + Object.keys(data)[0] + "]")));
                if (targetInput) {
                    if (targetInput.value) {
                        values.push(targetInput.value);
                    }
                    else {
                        searchs = searchs.filter((/**
                         * @param {?} val
                         * @return {?}
                         */
                        function (val) { return val != Object.values(element)[bindIndex]; }));
                    }
                }
            }));
        }
        /** @type {?} */
        var result = searchs.map((/**
         * @param {?} val
         * @return {?}
         */
        function (val) { return values.includes(val); }));
        return !result.includes(false);
    };
    /**
     * 選択された区分コードに紐づく区分名を設定
     */
    /**
     * 選択された区分コードに紐づく区分名を設定
     * @param {?} val
     * @return {?}
     */
    SHFormPopup.prototype.setName = /**
     * 選択された区分コードに紐づく区分名を設定
     * @param {?} val
     * @return {?}
     */
    function (val) {
        var _this = this;
        /** @type {?} */
        var record = this.codes
            ? this.codes.find((/**
             * @param {?} element
             * @return {?}
             */
            function (element) { return Object.values(element)[_this.bindColumnKey - 1] == val; }))
            : null;
        if (record) {
            /** @type {?} */
            var kbnValue = Object.values(record)[this.bindColumnValue - 1];
            this.name = kbnValue ? kbnValue.toString() : "";
            this.bindCtlService.setBindValue({
                bindColumnArray: this.bindColumnArray,
                record: record,
            });
        }
        else {
            val = "";
            this.clearAll();
        }
        return val;
    };
    /**
     * 入力のクリア
     */
    /**
     * 入力のクリア
     * @return {?}
     */
    SHFormPopup.prototype.clearValue = /**
     * 入力のクリア
     * @return {?}
     */
    function () {
        var _this = this;
        this.value = "";
        this.name = "";
        if (this.ctlName) {
            this.ownValueInputElm.value = "";
            //タイミングを遅らせないとchangeイベント内のevent.target.valueが前の値になる
            setTimeout((/**
             * @return {?}
             */
            function () {
                _this.ownValueInputElm.dispatchEvent(new Event("change"));
                _this.ownValueInputElm.dispatchEvent(new Event("focus"));
            }), 0);
        }
        if (this.popupLabelName) {
            this.ownLabelInputElm.value = "";
        }
    };
    /**
     * サブクラスでオーバーライドして使うので消さない
     */
    /**
     * サブクラスでオーバーライドして使うので消さない
     * @param {?} s
     * @return {?}
     */
    SHFormPopup.prototype.toText = /**
     * サブクラスでオーバーライドして使うので消さない
     * @param {?} s
     * @return {?}
     */
    function (s) {
        return s;
    };
    /**
     * @param {?} result
     * @return {?}
     */
    SHFormPopup.prototype.extractBindValue = /**
     * @param {?} result
     * @return {?}
     */
    function (result) {
        if (!result)
            return;
        return Object.values(result)[this.bindColumnKey - 1];
    };
    SHFormPopup.propDecorators = {
        dataTitle: [{ type: Input }],
        dataKbnName: [{ type: Input }],
        apiUrl: [{ type: Input }],
        bindColumnKey: [{ type: Input }],
        bindColumnValue: [{ type: Input }],
        ctlName: [{ type: Input }],
        popupLabelName: [{ type: Input }],
        bindColumnArray: [{ type: Input }],
        hiddenInput: [{ type: Input }],
        hiddenLabel: [{ type: Input }],
        hiddenPopupButton: [{ type: Input }],
        dataCache: [{ type: Input }],
        hiddenColumns: [{ type: Input }],
        popupWidth: [{ type: Input }]
    };
    return SHFormPopup;
}(SHFormControl));
export { SHFormPopup };
if (false) {
    /** @type {?} */
    SHFormPopup.prototype.dataTitle;
    /** @type {?} */
    SHFormPopup.prototype.dataKbnName;
    /** @type {?} */
    SHFormPopup.prototype.apiUrl;
    /** @type {?} */
    SHFormPopup.prototype.bindColumnKey;
    /** @type {?} */
    SHFormPopup.prototype.bindColumnValue;
    /** @type {?} */
    SHFormPopup.prototype.ctlName;
    /** @type {?} */
    SHFormPopup.prototype.popupLabelName;
    /** @type {?} */
    SHFormPopup.prototype.bindColumnArray;
    /** @type {?} */
    SHFormPopup.prototype.hiddenInput;
    /** @type {?} */
    SHFormPopup.prototype.hiddenLabel;
    /** @type {?} */
    SHFormPopup.prototype.hiddenPopupButton;
    /** @type {?} */
    SHFormPopup.prototype.dataCache;
    /** @type {?} */
    SHFormPopup.prototype.hiddenColumns;
    /** @type {?} */
    SHFormPopup.prototype.popupWidth;
    /** @type {?} */
    SHFormPopup.prototype.name;
    /** @type {?} */
    SHFormPopup.prototype.event;
    /** @type {?} */
    SHFormPopup.prototype.codes;
    /** @type {?} */
    SHFormPopup.prototype.codesHeader;
    /** @type {?} */
    SHFormPopup.prototype.extendWidth;
    /** @type {?} */
    SHFormPopup.prototype.dialogRef;
    /** @type {?} */
    SHFormPopup.prototype.initFetchFlg;
    /** @type {?} */
    SHFormPopup.prototype.noChangeFlg;
    /** @type {?} */
    SHFormPopup.prototype.isBusy;
    /**
     * @type {?}
     * @protected
     */
    SHFormPopup.prototype.SmplPopupService;
    /**
     * @type {?}
     * @protected
     */
    SHFormPopup.prototype.dialog;
    /**
     * @type {?}
     * @protected
     */
    SHFormPopup.prototype.bindCtlService;
    /**
     * @type {?}
     * @protected
     */
    SHFormPopup.prototype.lockScreenService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU2hGb3JtUG9wdXAuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9zaC1mb3JtLWNvbnRyb2wvIiwic291cmNlcyI6WyJsaWIvdXRpbGl0aWVzL1NoRm9ybVBvcHVwLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLEtBQUssRUFBaUIsTUFBTSxlQUFlLENBQUM7QUFDckQsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQzFELE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFHM0MsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ2hELE9BQU8sRUFBRSx5QkFBeUIsRUFBRSxNQUFNLGlFQUFpRSxDQUFDO0FBTTVHO0lBQWlDLHVDQUFrQjtJQW1FakQscUJBQ1ksZ0JBQWtDLEVBQ2xDLE1BQWlCLEVBQ2pCLGNBQThCLEVBQzlCLGlCQUFvQztRQUpoRCxZQU1FLGlCQUFPLFNBRVI7UUFQVyxzQkFBZ0IsR0FBaEIsZ0JBQWdCLENBQWtCO1FBQ2xDLFlBQU0sR0FBTixNQUFNLENBQVc7UUFDakIsb0JBQWMsR0FBZCxjQUFjLENBQWdCO1FBQzlCLHVCQUFpQixHQUFqQixpQkFBaUIsQ0FBbUI7O1FBckVoQyxlQUFTLEdBQVcsRUFBRSxDQUFDOztRQUV2QixpQkFBVyxHQUFXLEVBQUUsQ0FBQzs7UUFFekIsWUFBTSxHQUFXLE9BQU8sQ0FBQzs7UUFFekIsbUJBQWEsR0FBVyxDQUFDLENBQUM7O1FBRTFCLHFCQUFlLEdBQVcsQ0FBQyxDQUFDOztRQVE1QixpQkFBVyxHQUFZLEtBQUssQ0FBQzs7UUFFN0IsaUJBQVcsR0FBWSxLQUFLLENBQUM7O1FBRTdCLHVCQUFpQixHQUFZLEtBQUssQ0FBQzs7UUFFbkMsZUFBUyxHQUFZLEtBQUssQ0FBQzs7UUFFM0IsbUJBQWEsR0FBYSxFQUFFLENBQUM7UUFJdEMsVUFBSSxHQUFXLEVBQUUsQ0FBQztRQUVsQixXQUFLLEdBQUcsRUFBRSxD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akJBLEtBQUs7OEJBRUwsS0FBSzt5QkFFTCxLQUFLO2dDQUVMLEtBQUs7a0NBRUwsS0FBSzswQkFFTCxLQUFLO2lDQUVMLEtBQUs7a0NBRUwsS0FBSzs4QkFFTCxLQUFLOzhCQUVMLEtBQUs7b0NBRUwsS0FBSzs0QkFFTCxLQUFLO2dDQUVMLEtBQUs7NkJBRUwsS0FBSzs7SUE2aEJSLGtCQUFDO0NBQUEsQUF6akJELENBQWlDLGFBQWEsR0F5akI3QztTQXpqQlksV0FBVzs7O0lBRXRCLGdDQUF1Qzs7SUFFdkMsa0NBQXlDOztJQUV6Qyw2QkFBeUM7O0lBRXpDLG9DQUEwQzs7SUFFMUMsc0NBQTRDOztJQUU1Qyw4QkFBd0I7O0lBRXhCLHFDQUErQjs7SUFFL0Isc0NBQXFDOztJQUVyQyxrQ0FBNkM7O0lBRTdDLGtDQUE2Qzs7SUFFN0Msd0NBQW1EOztJQUVuRCxnQ0FBMkM7O0lBRTNDLG9DQUE2Qzs7SUFFN0MsaUNBQW1DOztJQUVuQywyQkFBeUI7O0lBQ3pCLDRCQUFrQjs7SUFDbEIsNEJBQWtCOztJQUNsQixrQ0FBd0I7O0lBRXhCLGtDQUE2Qzs7SUFHN0MsZ0NBQXNFOztJQUV0RSxtQ0FBcUM7O0lBd0JyQyxrQ0FBd0M7O0lBRXhDLDZCQUFzQjs7Ozs7SUFFcEIsdUNBQTRDOzs7OztJQUM1Qyw2QkFBMkI7Ozs7O0lBQzNCLHFDQUF3Qzs7Ozs7SUFDeEMsd0NBQThDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5wdXQsIFNpbXBsZUNoYW5nZXMgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xyXG5pbXBvcnQgeyBTSEN0bENvbW1vbiB9IGZyb20gXCIuLi9jb21wb25lbnRzL3NoLWN0bC1jb21tb25cIjtcclxuaW1wb3J0IHsgU2hDdGxDb25zdCB9IGZyb20gXCIuLi9jb25zdFNoQ3RsXCI7XHJcbmltcG9ydCB7IFNtcGxQb3B1cFNlcnZpY2UgfSBmcm9tIFwiLi4vc2VydmljZXMvc21wbC1wb3B1cC5zZXJ2aWNlXCI7XHJcbmltcG9ydCB7IE1hdERpYWxvZywgTWF0RGlhbG9nUmVmIH0gZnJvbSBcIkBhbmd1bGFyL21hdGVyaWFsXCI7XHJcbmltcG9ydCB7IFNIRm9ybUNvbnRyb2wgfSBmcm9tIFwiLi9TaEZvcm1Db250cm9sXCI7XHJcbmltcG9ydCB7IFNIQ3RsUG9wdXBEaWFsb2dDb21wb25lbnQgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9zaC1jdGwtcG9wdXAtZGlhbG9nL3NoLWN0bC1wb3B1cC1kaWFsb2cuY29tcG9uZW50XCI7XHJcbmltcG9ydCB7IEJpbmRDdGxTZXJ2aWNlIH0gZnJvbSBcIi4uL3NlcnZpY2VzL2JpbmQtY3RsLnNlcnZpY2VcIjtcclxuaW1wb3J0IHsgTG9ja1NjcmVlblNlcnZpY2UgfSBmcm9tIFwiLi4vc2VydmljZXMvbG9jay1zY3JlZW4uc2VydmljZVwiO1xyXG5pbXBvcnQgeyBOb0NoYW5nZUZsZyB9IGZyb20gXCIuLi90eXBlcy9Ob0NoYW5nZUZsZ1wiO1xyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBTSEZvcm1Qb3B1cCBleHRlbmRzIFNIRm9ybUNvbnRyb2w8YW55PiB7XHJcbiAgLy/jg4fjg7zjgr/jgr/jgqTjg4jjg6vlkI1cclxuICBASW5wdXQoKSBwdWJsaWMgZGF0YVRpdGxlOiBzdHJpbmcgPSBcIlwiO1xyXG4gIC8v44OH44O844K/5Yy65YiG5ZCNXHJcbiAgQElucHV0KCkgcHVibGljIGRhdGFLYm5OYW1lOiBzdHJpbmcgPSBcIlwiO1xyXG4gIC8vQVBJIFVSTFxyXG4gIEBJbnB1dCgpIHB1YmxpYyBhcGlVcmw6IHN0cmluZyA9IFwiL2FwaS9cIjtcclxuICAvL+WFpeWKm+OCs+ODs+ODiOODreODvOODq+OBq+e0kOOBpeOBj+WIl+eVquWPt1xyXG4gIEBJbnB1dCgpIHB1YmxpYyBiaW5kQ29sdW1uS2V5OiBudW1iZXIgPSAxO1xyXG4gIC8v44Op44OZ44Or44Kz44Oz44OI44Ot44O844Or44Gr57SQ44Gl44GP5YiX55Wq5Y+3XHJcbiAgQElucHV0KCkgcHVibGljIGJpbmRDb2x1bW5WYWx1ZTogbnVtYmVyID0gMjtcclxuICAvL+WFpeWKm+OCs+ODs+ODiOODreODvOODq+WQjVxyXG4gIEBJbnB1dCgpIHB1YmxpYyBjdGxOYW1lO1xyXG4gIC8v44Op44OZ44Or44Kz44Oz44OI44Ot44O844Or5ZCNXHJcbiAgQElucHV0KCkgcHVibGljIHBvcHVwTGFiZWxOYW1lO1xyXG4gIC8v5LuW44Gu44Kz44Oz44OI44Ot44O844Or44Go44Gu5YCk6YCj5pC644KS6Kit5a6a44GZ44KLXHJcbiAgQElucHV0KCkgcHVibGljIGJpbmRDb2x1bW5BcnJheTogYW55O1xyXG4gIC8v5YWl5Yqb44Kz44Oz44OI44Ot44O844Or44KS6Z2e6KGo56S644Gr44GZ44KL44Oi44O844OJ44OV44Op44KwXHJcbiAgQElucHV0KCkgcHVibGljIGhpZGRlbklucHV0OiBib29sZWFuID0gZmFsc2U7XHJcbiAgLy/jg6njg5njg6vjgpLpnZ7ooajnpLrjgavjgZnjgovjg6Ljg7zjg4njg5Xjg6njgrBcclxuICBASW5wdXQoKSBwdWJsaWMgaGlkZGVuTGFiZWw6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAvL+iZq+ecvOmPoeOCouOCpOOCs+ODs+OCkumdnuihqOekuuOBq+OBmeOCi+ODouODvOODieODleODqeOCsFxyXG4gIEBJbnB1dCgpIHB1YmxpYyBoaWRkZW5Qb3B1cEJ1dHRvbjogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIC8v44OH44O844K/44Kt44Oj44OD44K344OlT04vT0ZG5qmf6IO944OV44Op44KwXHJcbiAgQElucHV0KCkgcHVibGljIGRhdGFDYWNoZTogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIC8v44Od44OD44OX44Ki44OD44OX5LiK6Z2e6KGo56S644Go44Gq44KL5YiX55Wq5Y+3XHJcbiAgQElucHV0KCkgcHVibGljIGhpZGRlbkNvbHVtbnM6IG51bWJlcltdID0gW107XHJcbiAgLy8g44OA44Kk44Ki44Ot44Kw44Gu5bmF44KS5oyH5a6aXHJcbiAgQElucHV0KCkgcHVibGljIHBvcHVwV2lkdGg6IHN0cmluZztcclxuXHJcbiAgcHVibGljIG5hbWU6IHN0cmluZyA9IFwiXCI7XHJcbiAgcHVibGljIGV2ZW50OiBhbnk7XHJcbiAgcHVibGljIGNvZGVzID0gW107XHJcbiAgcHVibGljIGNvZGVzSGVhZGVyID0gW107XHJcblxyXG4gIHB1YmxpYyBleHRlbmRXaWR0aCA9IFNoQ3RsQ29uc3QuRElBTE9HX1dJRFRIO1xyXG5cclxuICAvL0RpYWxvZ+OBrue1kOaenOOCkuWPl+OBkeWPluOCi1xyXG4gIHB1YmxpYyBkaWFsb2dSZWY6IE1hdERpYWxvZ1JlZjxTSEN0bFBvcHVwRGlhbG9nQ29tcG9uZW50LCBhbnk+ID0gbnVsbDtcclxuICAvLyDliJ3lm57pgJrkv6HnlKjjg5Xjg6njgrBcclxuICBwdWJsaWMgaW5pdEZldGNoRmxnOiBib29sZWFuID0gZmFsc2U7XHJcbiAgLy8gYmluZENvbHVtbkFycmF544KS5Yip55So44GX5YCk44GM6Kit5a6a44GV44KM44Gf5aC05ZCI44Gr44OB44Kn44Oz44K444KS5q2i44KB44KLXHJcbiAgZ2V0IG5vQ2hhbmdlRmxnQ3RsTmFtZSgpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIGAke3RoaXMuY3RsTmFtZX1fJHtTaEN0bENvbnN0Lk5PX0NIQU5HRS5GTEdfU1VGRklYfWA7XHJcbiAgfVxyXG4gIC8vIGlucHV044Gu5Y+C54WnXHJcbiAgZ2V0IG93blZhbHVlSW5wdXRFbG0oKTogSFRNTElucHV0RWxlbWVudCB8IG51bGwge1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgPEhUTUxJbnB1dEVsZW1lbnQ+KFxyXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgICAgICBgdGV4dGFyZWFbbmFtZT0ke3RoaXMuY3RsTmFtZX1dLCBpbnB1dFtuYW1lPSR7dGhpcy5jdGxOYW1lfV1gXHJcbiAgICAgICAgKVxyXG4gICAgICApIHx8IG51bGxcclxuICAgICk7XHJcbiAgfVxyXG4gIGdldCBvd25MYWJlbElucHV0RWxtKCk6IEhUTUxJbnB1dEVsZW1lbnQgfCBudWxsIHtcclxuICAgIHJldHVybiA8SFRNTElucHV0RWxlbWVudD4oXHJcbiAgICAgIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICAgIGB0ZXh0YXJlYVtuYW1lPSR7dGhpcy5wb3B1cExhYmVsTmFtZX1dLCBpbnB1dFtuYW1lPSR7dGhpcy5wb3B1cExhYmVsTmFtZX1dYFxyXG4gICAgICApIHx8IG51bGwpXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLy8gYmluZENvbHVtbkFycmF544KS5Yip55So44GX5YCk44GM6Kit5a6a44GV44KM44Gf5aC05ZCI44Gr44OB44Kn44Oz44K444KS5q2i44KB44KLXHJcbiAgcHVibGljIG5vQ2hhbmdlRmxnOiBOb0NoYW5nZUZsZyA9IGBPRkZgO1xyXG4gIC8vIOmAmuS/oeS4reOBi+OBqeOBhuOBi1xyXG4gIHB1YmxpYyBpc0J1c3kgPSBmYWxzZTtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByb3RlY3RlZCBTbXBsUG9wdXBTZXJ2aWNlOiBTbXBsUG9wdXBTZXJ2aWNlLFxyXG4gICAgcHJvdGVjdGVkIGRpYWxvZzogTWF0RGlhbG9nLFxyXG4gICAgcHJvdGVjdGVkIGJpbmRDdGxTZXJ2aWNlOiBCaW5kQ3RsU2VydmljZSxcclxuICAgIHByb3RlY3RlZCBsb2NrU2NyZWVuU2VydmljZTogTG9ja1NjcmVlblNlcnZpY2VcclxuICApIHtcclxuICAgIHN1cGVyKCk7XHJcbiAgICB0aGlzLmN0bE5hbWUgPSBcIlNIQ3RsUG9wdXBcIjtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqXHJcbiAgICovXHJcbiAgcHVibGljIG5vQ2hhbmdlRmxnQ2hhbmdlKGV2ZW50KSB7XHJcbiAgICB0aGlzLm5vQ2hhbmdlRmxnID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIHRoaXMubm9DaGFuZ2VGbGcgPSBgT0ZGYDtcclxuICAgIH0sIDEwMDApO1xyXG4gIH1cclxuICAvKipcclxuICAgKiDlhaXlipvjgrPjg7Pjg4jjg63jg7zjg6vjga7luYXjgpLmjIflrppcclxuICAgKi9cclxuICBwdWJsaWMgc2V0SW5wdXRXaWR0aCgpIHtcclxuICAgIHJldHVybiB0aGlzLmhpZGRlbkxhYmVsID8geyB3aWR0aDogXCIxMDAlXCIgfSA6IHsgd2lkdGg6IFwiMzMuMyVcIiB9O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog44Op44OZ44Or44Kz44Oz44OI44Ot44O844Or44Gu5bmF44KS5oyH5a6aXHJcbiAgICovXHJcbiAgcHVibGljIHNldExhYmVsV2lkdGgoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5oaWRkZW5JbnB1dCA/IHsgd2lkdGg6IFwiMTAwJVwiIH0gOiB7IHdpZHRoOiBcIjY2LjYlXCIgfTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOODh+ODvOOCv+ODkOOCpOODs+ODieOBleOCjOOBn+WApOOCkuWGjeioreWumuOBmeOCi+mam+OBq+WApOOCkuaknOiovOOBl1xyXG4gICAqIOimquOCs+ODs+ODneODvOODjeODs+ODiOOBq+a4oeOBmVxyXG4gICAqIEBwYXJhbSBjaGFuZ2VzIOePvuWcqOOBruWApOOBqOebtOWJjeOBruWApOOCkuWPluW+l+WHuuadpeOCi1xyXG4gICAqL1xyXG4gIHB1YmxpYyBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XHJcbiAgICBpZiAoY2hhbmdlcy52YWx1ZSAmJiAhY2hhbmdlcy52YWx1ZS5jdXJyZW50VmFsdWUpIHtcclxuICAgICAgdGhpcy5uYW1lID0gXCJcIjtcclxuICAgICAgdGhpcy52YWx1ZSA9IFwiXCI7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLm5vQ2hhbmdlRmxnID09IFwiT0ZGXCIpIHtcclxuICAgICAgaWYgKGNoYW5nZXMudmFsdWUgJiYgY2hhbmdlcy52YWx1ZS5jdXJyZW50VmFsdWUpIHtcclxuICAgICAgICBpZiAoY2hhbmdlcy52YWx1ZS5jdXJyZW50VmFsdWUgIT0gY2hhbmdlcy52YWx1ZS5wcmV2aW91c1ZhbHVlKSB7XHJcbiAgICAgICAgICB0aGlzLmZldGNoQ29kZXModGhpcy5hcGlVcmwpO1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBpZiAoY2hhbmdlcy52YWx1ZSAmJiBjaGFuZ2VzLnZhbHVlLmZpcnN0Q2hhbmdlKSB7XHJcbiAgICAgICAgdGhpcy5pbml0RmV0Y2hGbGcgPSB0cnVlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAodGhpcy5pbml0RmV0Y2hGbGcpIHtcclxuICAgICAgICBpZiAoIXRoaXMudmFsdWUgfHwgIWNoYW5nZXMudmFsdWUuY3VycmVudFZhbHVlKSByZXR1cm47XHJcbiAgICAgICAgdGhpcy5mZXRjaENvZGVzKHRoaXMuYXBpVXJsKTtcclxuICAgICAgICB0aGlzLmluaXRGZXRjaEZsZyA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChcclxuICAgICAgICBjaGFuZ2VzLmFwaVVybCAmJlxyXG4gICAgICAgIGNoYW5nZXMuYXBpVXJsLnByZXZpb3VzVmFsdWUgIT0gY2hhbmdlcy5hcGlVcmwuY3VycmVudFZhbHVlICYmXHJcbiAgICAgICAgIXRoaXMuaXNCaW5kSW5wdXROdWxsKHRoaXMuYmluZENvbHVtbkFycmF5KVxyXG4gICAgICApIHtcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICB0aGlzLlNtcGxQb3B1cFNlcnZpY2UuZ2V0TWFzdGVyRGF0YShjaGFuZ2VzLmFwaVVybC5jdXJyZW50VmFsdWUpXHJcbiAgICAgICAgICAgIC5sZW5ndGggPT0gMFxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICBjaGFuZ2VzLnZhbHVlICYmXHJcbiAgICAgICAgICAgIGNoYW5nZXMudmFsdWUuY3VycmVudFZhbHVlID09IGNoYW5nZXMudmFsdWUucHJldmlvdXNWYWx1ZVxyXG4gICAgICAgICAgKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICB0aGlzLmZldGNoQ29kZXMoY2hhbmdlcy5hcGlVcmwuY3VycmVudFZhbHVlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5jb2RlcyA9IE9iamVjdChcclxuICAgICAgICAgICAgdGhpcy5TbXBsUG9wdXBTZXJ2aWNlLmdldE1hc3RlckRhdGEoY2hhbmdlcy5hcGlVcmwuY3VycmVudFZhbHVlKVxyXG4gICAgICAgICAgKS5kYXRhO1xyXG4gICAgICAgICAgdGhpcy52YWx1ZSA9IHRoaXMuc2V0TmFtZSh0aGlzLnZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICB0aGlzLm5vQ2hhbmdlRmxnID0gYE9GRmA7XHJcbiAgICAgIH0sIDEwMDApO1xyXG4gICAgfSwgMCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKuODl+ODreODkeODhuOCo+OBruWIneacn+WMllxyXG4gICAq6YCa5bi444K144O844OT44K544Gr44Kt44Oj44OD44K344Ol44GX44Gm44GE44KL44GM44CB54Sh44GR44KM44Gw5YaN5bqm44Oe44K544K/44KI44KK5Y+W5b6XXHJcbiAgICovXHJcbiAgcHVibGljIG5nT25Jbml0KCkge1xyXG4gICAgdGhpcy5vbkluaXQoKTtcclxuICAgIGlmICh0aGlzLnBvcHVwV2lkdGgpIHtcclxuICAgICAgdGhpcy5leHRlbmRXaWR0aCA9IHRoaXMucG9wdXBXaWR0aDtcclxuICAgIH1cclxuICAgIC8vIC8v44Om44OL44O844Kv44Gq5paH5a2X5YiXXHJcbiAgICBpZiAodGhpcy5pc0Rpc2FibGVkKSB7XHJcbiAgICAgIGlmICh0aGlzLlNtcGxQb3B1cFNlcnZpY2UuZ2V0TWFzdGVyRGF0YSh0aGlzLmFwaVVybCkubGVuZ3RoIDw9IDApIHtcclxuICAgICAgICB0aGlzLlNtcGxQb3B1cFNlcnZpY2UuZmV0Y2hBbGwodGhpcy5hcGlVcmwpLnRoZW4oKHJlc3BvbnNlKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLmNvZGVzID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICAgIHRoaXMuY29kZXNIZWFkZXIgPSBPYmplY3QudmFsdWVzKHJlc3BvbnNlLmhlYWRlcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqYXBpIOmAmuS/oSDjg57jgrnjgr/jgYvjgonlj5blvpdcclxuICAgKi9cclxuICBwdWJsaWMgYXN5bmMgZmV0Y2hDb2Rlcyh1cmw6IHN0cmluZywgdmFsdWU/OiBzdHJpbmcpIHtcclxuICAgIGlmICh0aGlzLmlzQnVzeSkgcmV0dXJuO1xyXG4gICAgdGhpcy5pc0J1c3kgPSB0cnVlO1xyXG4gICAgdGhpcy5sb2NrU2NyZWVuU2VydmljZS5sb2NrU2NyZWVuKCk7XHJcbiAgICAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCBhcyBIVE1MRWxlbWVudCkuYmx1cigpO1xyXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLlNtcGxQb3B1cFNlcnZpY2UuZmV0Y2hBbGwodXJsKSkuY2F0Y2goXyA9PiB7dGhpcy5sb2NrU2NyZWVuU2VydmljZS51bmxvY2soKX0pLnRoZW4oXHJcbiAgICAgIChyZXNwb25zZSkgPT4ge1xyXG4gICAgICAgIHRoaXMuY29kZXMgPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICAgIHRoaXMuY29kZXNIZWFkZXIgPSBPYmplY3QudmFsdWVzKHJlc3BvbnNlLmhlYWRlcik7XHJcbiAgICAgICAgdGhpcy5kYXRhVGl0bGUgPSByZXNwb25zZS50aXRsZTtcclxuICAgICAgICBjb25zdCBvayA9IHRoaXMuY2hlY2tWYWx1ZSh2YWx1ZSB8fCB0aGlzLnZhbHVlKTtcclxuICAgICAgICBsZXQgcmVzdWx0ID0gXCJcIjtcclxuICAgICAgICBpZiAob2spIHtcclxuICAgICAgICAgIGlmICh2YWx1ZSB8fCB0aGlzLnZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMuc2V0TmFtZSh2YWx1ZSB8fCB0aGlzLnZhbHVlKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmICh0aGlzLmRhdGFDYWNoZSkge1xyXG4gICAgICAgICAgICB0aGlzLlNtcGxQb3B1cFNlcnZpY2Uuc2V0TWFzdGVyRGF0YSh1cmwsIHJlc3BvbnNlKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pc0J1c3kgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcbiAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgICB0aGlzLmxvY2tTY3JlZW5TZXJ2aWNlLnVubG9jaygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICApXHJcblxyXG4gIH1cclxuICAvKipcclxuICAgKiBvbklucHV0XHJcbiAgICogQHBhcmFtIGV2ZW50IGlucHV0XHJcbiAgICovXHJcbiAgcHVibGljIG9uSW5wdXQoZXZlbnQpIHtcclxuICAgIFNIQ3RsQ29tbW9uLnJlcGxhY2VTcGFjZShldmVudCk7XHJcbiAgICBTSEN0bENvbW1vbi5yZXBsYWNlRnVsbFdpZHRoKGV2ZW50KTtcclxuICAgIFNIQ3RsQ29tbW9uLnJlcGxhY2VTaWduKGV2ZW50KTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICog44OA44Kk44Ki44Ot44Kw44KS6ZaL44GE44Gm6ZaJ44GY44KL5pmC44Gr5YCk44KS6Kaq44Gr6L+U44GZXHJcbiAgICovXHJcbiAgcHVibGljIG9wZW5EaWFsb2coKSB7XHJcbiAgICAvLyB2YWx1ZeOBruWApOOCkuS4gOaZguWvvuavlOOAgOODgOOCpOOCouODreOCsOOCkumWieOBmOOCi+mam+OBq+avlOi8g+OBl+OBvuOBmVxyXG4gICAgY29uc3QgdG1wID0gdGhpcy52YWx1ZTtcclxuICAgIGlmIChcclxuICAgICAgIXRoaXMucG9wdXBXaWR0aCAmJlxyXG4gICAgICB0aGlzLmNvZGVzLmxlbmd0aCAhPSAwICYmXHJcbiAgICAgIE9iamVjdC52YWx1ZXModGhpcy5jb2Rlc1swXSkubGVuZ3RoID49IDRcclxuICAgICkge1xyXG4gICAgICB0aGlzLmV4dGVuZFdpZHRoID0gU2hDdGxDb25zdC5ESUFMT0dfTUFYX1dJRFRIO1xyXG4gICAgfVxyXG4gICAgdGhpcy5kaWFsb2dSZWYgPSB0aGlzLmRpYWxvZy5vcGVuKFNIQ3RsUG9wdXBEaWFsb2dDb21wb25lbnQsIHtcclxuICAgICAgaGVpZ2h0OiBTaEN0bENvbnN0LkRJQUxPR19IRUlHSFQsXHJcbiAgICAgIHdpZHRoOiB0aGlzLmV4dGVuZFdpZHRoLFxyXG4gICAgICBkYXRhOiB7XHJcbiAgICAgICAgZGF0YVRpdGxlOiB0aGlzLmRhdGFUaXRsZSxcclxuICAgICAgICBjb2RlczogdGhpcy5jb2RlcyxcclxuICAgICAgICBjb2Rlc0hlYWRlcjogdGhpcy5jb2Rlc0hlYWRlcixcclxuICAgICAgICBoaWRkZW5Db2x1bW5zOiB0aGlzLmhpZGRlbkNvbHVtbnMsXHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuICAgIHRoaXMuZGlhbG9nUmVmLmFmdGVyQ2xvc2VkKCkuc3Vic2NyaWJlKChyZXN1bHQpID0+IHtcclxuICAgICAgaWYgKHJlc3VsdCkge1xyXG4gICAgICAgIHRoaXMuc2V0VmFsdWVOYW1lKHJlc3VsdCk7XHJcbiAgICAgICAgLy90aGlzLmFsbG9jYXRlVG9JbnB1dFZhbHVlKHJlc3VsdCk7XHJcbiAgICAgICAgdGhpcy5iaW5kQ3RsU2VydmljZS5zZXROb0NoYW5nZUZsZyh7XHJcbiAgICAgICAgICBiaW5kQ29sdW1uQXJyYXk6IHRoaXMuYmluZENvbHVtbkFycmF5LFxyXG4gICAgICAgICAgcmVjb3JkOiByZXN1bHQsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5iaW5kQ3RsU2VydmljZS5zZXRCaW5kVmFsdWUoe1xyXG4gICAgICAgICAgYmluZENvbHVtbkFycmF5OiB0aGlzLmJpbmRDb2x1bW5BcnJheSxcclxuICAgICAgICAgIHJlY29yZDogcmVzdWx0LFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMubm9DaGFuZ2VGbGcgPSBgT05gO1xyXG4gICAgICAgIC8vY2hhbmdl44Kk44OZ44Oz44OI57WM55Sx44GnZW1pdOOBmeOCi+OBqOeEoeadoeS7tuOBp2FmdGVyQ2hhbmdl44Kk44OZ44Oz44OI44GM5ZG844Gw44KM44KL44Gu44GnXHJcbiAgICAgICAgLy/lgKTjgpLmr5TovIPjgZflpInmm7TjgYzjgarjgZHjgozjgbDjgZPjga7jgr/jgqTjg5/jg7PjgrDjgadlbWl044GZ44KLXHJcbiAgICAgICAgY29uc3QgcmVzdWx0VmFsdWVzID0gT2JqZWN0LnZhbHVlcyhyZXN1bHQpO1xyXG4gICAgICAgIGlmIChyZXN1bHRWYWx1ZXMgJiYgcmVzdWx0VmFsdWVzLmluY2x1ZGVzKHRtcCkpIHtcclxuICAgICAgICAgIHRoaXMudmFsdWVDaGFuZ2UuZW1pdCh0aGlzLnZhbHVlKTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLmRpc3BhdGNoT3duVmFsdWVJbnB1dENoYW5nZUV2ZW50KCk7XHJcbiAgICAgICAgfSwgMCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuICAvKipcclxuICAgKkAg6Ieq6Lqr44GudmFsdWXjgavntJDjgaXjgY9pbnB1dOOBruODgeOCp+ODs+OCuOOCpOODmeODs+ODiOOCkueZuueBq1xyXG4gICAqL1xyXG4gIHByaXZhdGUgZGlzcGF0Y2hPd25WYWx1ZUlucHV0Q2hhbmdlRXZlbnQoKSB7XHJcbiAgICBpZiAodGhpcy5vd25WYWx1ZUlucHV0RWxtKSB7XHJcbiAgICAgIHRoaXMub3duVmFsdWVJbnB1dEVsbS5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudChcImNoYW5nZVwiKSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqQCBiaW5k5YWI44GuaW5wdXTjgYxudWxs44GL44Gp44GG44GLXHJcbiAgICovXHJcbiAgcHVibGljIGlzQmluZElucHV0TnVsbChiaW5kQ29sdW1uQXJyYXk6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH1bXSkge1xyXG4gICAgaWYgKCFiaW5kQ29sdW1uQXJyYXkgfHwgYmluZENvbHVtbkFycmF5Lmxlbmd0aCA9PSAwKSByZXR1cm4gdHJ1ZTtcclxuICAgIHJldHVybiBiaW5kQ29sdW1uQXJyYXlcclxuICAgICAgLm1hcCgoYmluZENvbHVtbkRhdGEpID0+IHtcclxuICAgICAgICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgICAgIGBpbnB1dFtuYW1lPSR7T2JqZWN0LmtleXMoYmluZENvbHVtbkRhdGEpWzBdfV1gXHJcbiAgICAgICAgKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgICB9KVxyXG4gICAgICAubWFwKChiaW5kSW5wdXQpID0+IHtcclxuICAgICAgICBpZiAoIWJpbmRJbnB1dCkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIHJldHVybiAhIWJpbmRJbnB1dC52YWx1ZTtcclxuICAgICAgfSlcclxuICAgICAgLmluY2x1ZGVzKGZhbHNlKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIG9uQ2xpY2tcclxuICAgKiBAcGFyYW0gZXZlbnQgY2xpY2tcclxuICAgKi9cclxuICBwdWJsaWMgb25DbGljayhldmVudCkge1xyXG4gICAgdGhpcy5vbkJlZm9yZUNsaWNrKGV2ZW50KTtcclxuXHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgdGhpcy5vbkFmdGVyQ2xpY2soZXZlbnQpO1xyXG4gICAgfSwgMCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBvbkZvY3VzXHJcbiAgICogQHBhcmFtIGV2ZW50IGZvY3VzXHJcbiAgICovXHJcbiAgcHVibGljIG9uRm9jdXMoZXZlbnQpIHtcclxuICAgIHRoaXMub25CZWZvcmVGb2N1cyhldmVudCk7XHJcblxyXG4gICAgZXZlbnQudGFyZ2V0LnNlbGVjdCgpO1xyXG5cclxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICB0aGlzLm9uQWZ0ZXJGb2N1cyhldmVudCk7XHJcbiAgICB9LCAwKTtcclxuICB9XHJcbiAgcHVibGljIGNsZWFyQWxsKCkge1xyXG4gICAgdGhpcy52YWx1ZSA9IFwiXCI7XHJcbiAgICB0aGlzLm5hbWUgPSBcIlwiO1xyXG4gICAgaWYgKHRoaXMub3duTGFiZWxJbnB1dEVsbSkge1xyXG4gICAgICB0aGlzLm93bkxhYmVsSW5wdXRFbG0udmFsdWUgPSBcIlwiO1xyXG4gICAgfVxyXG4gICAgdGhpcy52YWx1ZUNoYW5nZS5lbWl0KFwiXCIpO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBvbkNoYW5nZVxyXG4gICAqIEBwYXJhbSBldmVudCBjaGFuZ2VcclxuICAgKi9cclxuICBwdWJsaWMgb25DaGFuZ2UoZXZlbnQpIHtcclxuICAgIHRoaXMub25CZWZvcmVDaGFuZ2UoZXZlbnQpO1xyXG4gICAgaWYgKCFldmVudC50YXJnZXQudmFsdWUpIHtcclxuICAgICAgdGhpcy5jbGVhckFsbCgpO1xyXG4gICAgfVxyXG4gICAgbGV0IGZsZyA9IGZhbHNlO1xyXG4gICAgaWYgKHRoaXMubm9DaGFuZ2VGbGcgPT0gXCJPRkZcIikge1xyXG4gICAgICBmbGcgPSB0cnVlO1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgdGhpcy5TbXBsUG9wdXBTZXJ2aWNlLmdldE1hc3RlckRhdGEodGhpcy5hcGlVcmwpLmxlbmd0aCA9PSAwICYmXHJcbiAgICAgICAgZXZlbnQudGFyZ2V0LnZhbHVlXHJcbiAgICAgICkge1xyXG4gICAgICAgIHRoaXMubm9DaGFuZ2VGbGcgPSBcIk9OXCI7XHJcbiAgICAgICAgdGhpcy5mZXRjaENvZGVzKHRoaXMuYXBpVXJsLCB0aGlzLnRvVGV4dChldmVudC50YXJnZXQudmFsdWUpKS50aGVuKFxyXG4gICAgICAgICAgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWVDaGFuZ2UuZW1pdCh2YWx1ZSk7XHJcbiAgICAgICAgICAgIGV2ZW50LnRhcmdldC52YWx1ZSA9IHRoaXMudG9UZXh0KGV2ZW50LnRhcmdldC52YWx1ZSk7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMub25BZnRlckNoYW5nZShldmVudCk7XHJcbiAgICAgICAgICAgIH0sIDApO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZXZlbnQudGFyZ2V0LnZhbHVlID0gdGhpcy5zZXROYW1lKGV2ZW50LnRhcmdldC52YWx1ZSk7XHJcbiAgICAgICAgdGhpcy52YWx1ZUNoYW5nZS5lbWl0KGV2ZW50LnRhcmdldC52YWx1ZSk7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLm9uQWZ0ZXJDaGFuZ2UoZXZlbnQpO1xyXG4gICAgICAgIH0sIDApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoIWZsZykge1xyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICB0aGlzLnZhbHVlQ2hhbmdlLmVtaXQoZXZlbnQudGFyZ2V0LnZhbHVlKTtcclxuICAgICAgICB0aGlzLm9uQWZ0ZXJDaGFuZ2UoZXZlbnQpO1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5ub0NoYW5nZUZsZyA9IGBPRkZgO1xyXG4gICAgICAgIH0sIDEwMDApO1xyXG4gICAgICB9LCAwKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIG9uQmx1clxyXG4gICAqIEBwYXJhbSBldmVudCBibHVyXHJcbiAgICovXHJcbiAgcHVibGljIG9uQmx1cihldmVudCkge1xyXG4gICAgdGhpcy5vbkJlZm9yZUJsdXIoZXZlbnQpO1xyXG5cclxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICB0aGlzLm9uQWZ0ZXJCbHVyKGV2ZW50KTtcclxuICAgIH0sIDApO1xyXG4gIH1cclxuICAvKipcclxuICAgKuaJi+WFpeWKm+OBruWApOOBi+OCieOBruaknOe0oue1kOaenOOBjOikh+aVsOOBguOBo+OBn+WgtOWQiOOBr+OCouODqeODvOODiOOCkuWHuuOBmVxyXG4gICAqL1xyXG4gIHB1YmxpYyBjaGVja1ZhbHVlKHZhbHVlKSB7XHJcbiAgICBpZiAoIXZhbHVlKSByZXR1cm4gZmFsc2U7XHJcbiAgICAvL2xldCBtYXRjaGVkQXJyYXkgPSBbXTtcclxuICAgIGlmICh0aGlzLmNvZGVzWzBdKSB7XHJcbiAgICAgIGNvbnN0IGZpbHRlclJlc3VsdCA9IHRoaXMuY29kZXMuZmlsdGVyKFxyXG4gICAgICAgIChlbGVtZW50KSA9PlxyXG4gICAgICAgICAgLy90aGlzLmhhc01hdGNoUmVjb3JkcyhlbGVtZW50LCB2YWx1ZSlcclxuICAgICAgICAgIE9iamVjdC52YWx1ZXMoZWxlbWVudClbdGhpcy5iaW5kQ29sdW1uS2V5IC0gMV0gPT0gdmFsdWVcclxuICAgICAgKTtcclxuICAgICAgaWYgKGZpbHRlclJlc3VsdC5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgIHRoaXMuY2xlYXJWYWx1ZSgpO1xyXG4gICAgICAgIHRoaXMudmFsdWVDaGFuZ2UuZW1pdChcIlwiKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChmaWx0ZXJSZXN1bHQubGVuZ3RoID49IDIpIHtcclxuICAgICAgICBhbGVydCh2YWx1ZSArIFwi44Gr6KSH5pWw44Gu5YCZ6KOc44GM5qSc5Ye644GV44KM44G+44GX44GfXCIpO1xyXG4gICAgICAgIHRoaXMuY2xlYXJWYWx1ZSgpO1xyXG4gICAgICAgIHRoaXMudmFsdWVDaGFuZ2UuZW1pdChcIlwiKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuICAvKipcclxuICAgKiDjg57jgrnjgr/mg4XloLHjgojjgorjgrPjg7zjg4njgpLlj5blvpdcclxuICAgKi9cclxuICBwdWJsaWMgZ2V0Q29kZXMoKSB7XHJcbiAgICB0aGlzLm9wZW5EaWFsb2coKTtcclxuICAgIGlmICh0aGlzLlNtcGxQb3B1cFNlcnZpY2UuZ2V0TWFzdGVyRGF0YSh0aGlzLmFwaVVybCkubGVuZ3RoID09IDApIHtcclxuICAgICAgdGhpcy5TbXBsUG9wdXBTZXJ2aWNlLmZldGNoQWxsKHRoaXMuYXBpVXJsKS50aGVuKChyZXNwb25zZSkgPT4ge1xyXG4gICAgICAgIHRoaXMuY29kZXMgPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICAgIHRoaXMuY29kZXNIZWFkZXIgPSBPYmplY3QudmFsdWVzKHJlc3BvbnNlLmhlYWRlcik7XHJcbiAgICAgICAgdGhpcy5kYXRhVGl0bGUgPSByZXNwb25zZS50aXRsZTtcclxuICAgICAgICBpZiAodGhpcy5kYXRhQ2FjaGUpXHJcbiAgICAgICAgICB0aGlzLlNtcGxQb3B1cFNlcnZpY2Uuc2V0TWFzdGVyRGF0YSh0aGlzLmFwaVVybCwgcmVzcG9uc2UpO1xyXG4gICAgICAgIGlmICghdGhpcy5kaWFsb2dSZWYpIHJldHVybjtcclxuICAgICAgICBpZiAodGhpcy5kaWFsb2dSZWYuY29tcG9uZW50SW5zdGFuY2UpIHtcclxuICAgICAgICAgIHRoaXMuZGlhbG9nUmVmLmNvbXBvbmVudEluc3RhbmNlLmNvZGVzSGVhZGVyID0gdGhpcy5jb2Rlc0hlYWRlcjtcclxuICAgICAgICAgIHRoaXMuZGlhbG9nUmVmLmNvbXBvbmVudEluc3RhbmNlLnVuY2hhbmdlYWJsZUNvZGVzID0gdGhpcy5jb2RlcztcclxuICAgICAgICAgIHRoaXMuZGlhbG9nUmVmLmNvbXBvbmVudEluc3RhbmNlLmNvZGVzID0gdGhpcy5jb2RlcztcclxuICAgICAgICAgIHRoaXMuZGlhbG9nUmVmLmNvbXBvbmVudEluc3RhbmNlLmRhdGFUaXRsZSA9IHRoaXMuZGF0YVRpdGxlO1xyXG4gICAgICAgICAgaWYgKCF0aGlzLnBvcHVwV2lkdGggJiYgT2JqZWN0LnZhbHVlcyh0aGlzLmNvZGVzWzBdKS5sZW5ndGggPj0gNCkge1xyXG4gICAgICAgICAgICB0aGlzLmV4dGVuZFdpZHRoID0gU2hDdGxDb25zdC5ESUFMT0dfTUFYX1dJRFRIO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy5kaWFsb2dSZWYudXBkYXRlU2l6ZSh0aGlzLmV4dGVuZFdpZHRoLCBTaEN0bENvbnN0LkRJQUxPR19IRUlHSFQpO1xyXG4gICAgICAgICAgbGV0IGNvbHMgPSBbXTtcclxuICAgICAgICAgIHRoaXMuZGlhbG9nUmVmLmNvbXBvbmVudEluc3RhbmNlXHJcbiAgICAgICAgICAgIC5nZXRIYXNoS2V5cygpXHJcbiAgICAgICAgICAgIC5mb3JFYWNoKChuYW1lLCBpZHgpID0+IHtcclxuICAgICAgICAgICAgICBpZiAoIXRoaXMuaGlkZGVuQ29sdW1ucy5maW5kKChfKSA9PiBfID09IGlkeCArIDEpKVxyXG4gICAgICAgICAgICAgICAgY29scy5wdXNoKG5hbWUpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIHRoaXMuZGlhbG9nUmVmLmNvbXBvbmVudEluc3RhbmNlLmRpc3BsYXllZENvbHVtbnMgPSBjb2xzO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmNvZGVzID0gT2JqZWN0KFxyXG4gICAgICAgIHRoaXMuU21wbFBvcHVwU2VydmljZS5nZXRNYXN0ZXJEYXRhKHRoaXMuYXBpVXJsKVxyXG4gICAgICApLmRhdGE7XHJcbiAgICAgIHRoaXMuY29kZXNIZWFkZXIgPSBPYmplY3QudmFsdWVzKFxyXG4gICAgICAgIE9iamVjdCh0aGlzLlNtcGxQb3B1cFNlcnZpY2UuZ2V0TWFzdGVyRGF0YSh0aGlzLmFwaVVybCkpLmhlYWRlclxyXG4gICAgICApO1xyXG4gICAgICBpZiAodGhpcy5kaWFsb2dSZWYuY29tcG9uZW50SW5zdGFuY2UpIHtcclxuICAgICAgICB0aGlzLmRpYWxvZ1JlZi5jb21wb25lbnRJbnN0YW5jZS5jb2Rlc0hlYWRlciA9IHRoaXMuY29kZXNIZWFkZXI7XHJcbiAgICAgICAgdGhpcy5kaWFsb2dSZWYuY29tcG9uZW50SW5zdGFuY2UudW5jaGFuZ2VhYmxlQ29kZXMgPSB0aGlzLmNvZGVzO1xyXG4gICAgICAgIHRoaXMuZGlhbG9nUmVmLmNvbXBvbmVudEluc3RhbmNlLmNvZGVzID0gdGhpcy5jb2RlcztcclxuICAgICAgICB0aGlzLmRpYWxvZ1JlZi5jb21wb25lbnRJbnN0YW5jZS5kYXRhVGl0bGUgPSB0aGlzLmRhdGFUaXRsZTtcclxuICAgICAgICBpZiAoIXRoaXMucG9wdXBXaWR0aCAmJiBPYmplY3QudmFsdWVzKHRoaXMuY29kZXNbMF0pLmxlbmd0aCA+PSA0KSB7XHJcbiAgICAgICAgICB0aGlzLmV4dGVuZFdpZHRoID0gU2hDdGxDb25zdC5ESUFMT0dfTUFYX1dJRFRIO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmRpYWxvZ1JlZi51cGRhdGVTaXplKHRoaXMuZXh0ZW5kV2lkdGgsIFNoQ3RsQ29uc3QuRElBTE9HX0hFSUdIVCk7XHJcbiAgICAgICAgbGV0IGNvbHMgPSBbXTtcclxuICAgICAgICB0aGlzLmRpYWxvZ1JlZi5jb21wb25lbnRJbnN0YW5jZS5nZXRIYXNoS2V5cygpLmZvckVhY2goKG5hbWUsIGlkeCkgPT4ge1xyXG4gICAgICAgICAgaWYgKCF0aGlzLmhpZGRlbkNvbHVtbnMuZmluZCgoXykgPT4gXyA9PSBpZHggKyAxKSkgY29scy5wdXNoKG5hbWUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuZGlhbG9nUmVmLmNvbXBvbmVudEluc3RhbmNlLmRpc3BsYXllZENvbHVtbnMgPSBjb2xzO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDoh6rjgrPjg7Pjg4jjg63jg7zjg6vjga5pbnB1dCB2YWx1ZSDjgavlgKTjgpLmuKHjgZlcclxuICAgKiBAcGFyYW0gbWF0Y2hlZEFycmF5XHJcbiAgICovXHJcbiAgcHVibGljIHNldFZhbHVlTmFtZShtYXRjaGVkQXJyYXkpIHtcclxuICAgIGlmIChPYmplY3QudmFsdWVzKG1hdGNoZWRBcnJheSlbdGhpcy5iaW5kQ29sdW1uS2V5IC0gMV0pIHtcclxuICAgICAgY29uc3QgdmFsID0gT2JqZWN0LnZhbHVlcyhtYXRjaGVkQXJyYXkpW1xyXG4gICAgICAgIHRoaXMuYmluZENvbHVtbktleSAtIDFcclxuICAgICAgXS50b1N0cmluZygpO1xyXG4gICAgICB0aGlzLnZhbHVlID0gdmFsO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy52YWx1ZSA9IFwiXCI7XHJcbiAgICB9XHJcbiAgICBpZiAoT2JqZWN0LnZhbHVlcyhtYXRjaGVkQXJyYXkpW3RoaXMuYmluZENvbHVtblZhbHVlIC0gMV0pIHtcclxuICAgICAgdGhpcy5uYW1lID0gT2JqZWN0LnZhbHVlcyhtYXRjaGVkQXJyYXkpW1xyXG4gICAgICAgIHRoaXMuYmluZENvbHVtblZhbHVlIC0gMVxyXG4gICAgICBdLnRvU3RyaW5nKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLm5hbWUgPSBcIlwiO1xyXG4gICAgfVxyXG4gIH1cclxuICAvKipcclxuICAgKuimquWtkOmWouS/guOBq+OBquOBo+OBpuOBhOOCi2lucHV044GM44GC44KL5aC05ZCI44Gr5qSc57Si5a++6LGh44KS6Kaq44G+44Gn5bqD44GS44KLXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBoYXNNYXRjaFJlY29yZHMoZWxlbWVudDogYW55LCB2YWw6IGFueSk6IGJvb2xlYW4ge1xyXG4gICAgLy8g5qSc57Si57WQ5p6c5LiA6KGM5YiG44Gu5q+U6LyD44GZ44G544GN5YiX44Gu5YCkXHJcbiAgICBsZXQgc2VhcmNocyA9IFtdO1xyXG4gICAgLy8g54++5Zyo44Gu5q+U6LyD44GZ44G544GN5YCkXHJcbiAgICBsZXQgdmFsdWVzID0gW3ZhbF07XHJcbiAgICBzZWFyY2hzLnB1c2goT2JqZWN0LnZhbHVlcyhlbGVtZW50KVt0aGlzLmJpbmRDb2x1bW5LZXkgLSAxXSk7XHJcbiAgICBpZiAodGhpcy5iaW5kQ29sdW1uQXJyYXkgJiYgdGhpcy5iaW5kQ29sdW1uQXJyYXkubGVuZ3RoICE9IDApIHtcclxuICAgICAgdGhpcy5iaW5kQ29sdW1uQXJyYXkuZm9yRWFjaCgoZGF0YSkgPT4ge1xyXG4gICAgICAgIGxldCBiaW5kSW5kZXggPSAoT2JqZWN0LnZhbHVlcyhkYXRhKVswXSBhcyBudW1iZXIpIC0gMTtcclxuICAgICAgICBzZWFyY2hzLnB1c2goT2JqZWN0LnZhbHVlcyhlbGVtZW50KVtiaW5kSW5kZXhdKTtcclxuICAgICAgICBsZXQgdGFyZ2V0SW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICAgICAgYGlucHV0W25hbWU9JHtPYmplY3Qua2V5cyhkYXRhKVswXX1dYFxyXG4gICAgICAgICkgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICBpZiAodGFyZ2V0SW5wdXQpIHtcclxuICAgICAgICAgIGlmICh0YXJnZXRJbnB1dC52YWx1ZSkge1xyXG4gICAgICAgICAgICB2YWx1ZXMucHVzaCh0YXJnZXRJbnB1dC52YWx1ZSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzZWFyY2hzID0gc2VhcmNocy5maWx0ZXIoXHJcbiAgICAgICAgICAgICAgKHZhbCkgPT4gdmFsICE9IE9iamVjdC52YWx1ZXMoZWxlbWVudClbYmluZEluZGV4XVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBjb25zdCByZXN1bHQgPSBzZWFyY2hzLm1hcCgodmFsKSA9PiB2YWx1ZXMuaW5jbHVkZXModmFsKSk7XHJcbiAgICByZXR1cm4gIXJlc3VsdC5pbmNsdWRlcyhmYWxzZSk7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIOmBuOaKnuOBleOCjOOBn+WMuuWIhuOCs+ODvOODieOBq+e0kOOBpeOBj+WMuuWIhuWQjeOCkuioreWumlxyXG4gICAqL1xyXG4gIHB1YmxpYyBzZXROYW1lKHZhbCkge1xyXG4gICAgY29uc3QgcmVjb3JkID0gdGhpcy5jb2Rlc1xyXG4gICAgICA/IHRoaXMuY29kZXMuZmluZChcclxuICAgICAgICAgIChlbGVtZW50KSA9PiBPYmplY3QudmFsdWVzKGVsZW1lbnQpW3RoaXMuYmluZENvbHVtbktleSAtIDFdID09IHZhbFxyXG4gICAgICAgIClcclxuICAgICAgOiBudWxsO1xyXG4gICAgaWYgKHJlY29yZCkge1xyXG4gICAgICBsZXQga2JuVmFsdWUgPSBPYmplY3QudmFsdWVzKHJlY29yZClbdGhpcy5iaW5kQ29sdW1uVmFsdWUgLSAxXTtcclxuICAgICAgdGhpcy5uYW1lID0ga2JuVmFsdWUgPyBrYm5WYWx1ZS50b1N0cmluZygpIDogXCJcIjtcclxuICAgICAgdGhpcy5iaW5kQ3RsU2VydmljZS5zZXRCaW5kVmFsdWUoe1xyXG4gICAgICAgIGJpbmRDb2x1bW5BcnJheTogdGhpcy5iaW5kQ29sdW1uQXJyYXksXHJcbiAgICAgICAgcmVjb3JkLFxyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHZhbCA9IFwiXCI7XHJcbiAgICAgIHRoaXMuY2xlYXJBbGwoKTtcclxuICAgIH1cclxuICAgIHJldHVybiB2YWw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDlhaXlipvjga7jgq/jg6rjgqJcclxuICAgKi9cclxuICBwdWJsaWMgY2xlYXJWYWx1ZSgpIHtcclxuICAgIHRoaXMudmFsdWUgPSBcIlwiO1xyXG4gICAgdGhpcy5uYW1lID0gXCJcIjtcclxuICAgIGlmICh0aGlzLmN0bE5hbWUpIHtcclxuICAgICAgdGhpcy5vd25WYWx1ZUlucHV0RWxtLnZhbHVlID0gXCJcIjtcclxuICAgICAgLy/jgr/jgqTjg5/jg7PjgrDjgpLpgYXjgonjgZvjgarjgYTjgahjaGFuZ2XjgqTjg5njg7Pjg4jlhoXjga5ldmVudC50YXJnZXQudmFsdWXjgYzliY3jga7lgKTjgavjgarjgotcclxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5vd25WYWx1ZUlucHV0RWxtLmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KFwiY2hhbmdlXCIpKTtcclxuICAgICAgICB0aGlzLm93blZhbHVlSW5wdXRFbG0uZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoXCJmb2N1c1wiKSk7XHJcbiAgICAgIH0sIDApO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMucG9wdXBMYWJlbE5hbWUpIHtcclxuICAgICAgdGhpcy5vd25MYWJlbElucHV0RWxtLnZhbHVlID0gXCJcIjtcclxuICAgIH1cclxuICB9XHJcbiAgLyoqXHJcbiAgICog44K144OW44Kv44Op44K544Gn44Kq44O844OQ44O844Op44Kk44OJ44GX44Gm5L2/44GG44Gu44Gn5raI44GV44Gq44GEXHJcbiAgICovXHJcbiAgcHVibGljIHRvVGV4dChzOiBzdHJpbmcpIHtcclxuICAgIHJldHVybiBzO1xyXG4gIH1cclxuICBwdWJsaWMgZXh0cmFjdEJpbmRWYWx1ZShyZXN1bHQ6IGFueSkge1xyXG4gICAgaWYgKCFyZXN1bHQpIHJldHVybjtcclxuICAgIHJldHVybiBPYmplY3QudmFsdWVzKHJlc3VsdClbdGhpcy5iaW5kQ29sdW1uS2V5IC0gMV07XHJcbiAgfVxyXG59XHJcbiJdfQ==