/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input } from '@angular/core';
import { SHCtlCommon } from '../sh-ctl-common';
import { SHFormControl } from '../../utilities/ShFormControl';
import { ShCtlConst } from "../../constShCtl";
export class SHCtlNumberComponent extends SHFormControl {
    constructor() {
        super();
        this.min = 0;
        this.max = 99999999999;
        this.decimaldigit = 0;
        this.rounding = "round";
        this.firstFlag = true;
        this.ctlName = "SHCtlNumber";
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.onInit();
    }
    /**
     * ngOnChangesイベント
     * 値変更時にフォーマットを整形
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (changes.value) {
            if (changes.value.currentValue) {
                if (changes.value.currentValue === '' || changes.value.currentValue === undefined || changes.value.currentValue === String(/[^\x01-\x7E\xA1-\xDF]+$/g)) {
                    this.value = '';
                    return;
                }
                if (parseFloat(changes.value.currentValue) < this.min) {
                    this.value = String(this.min);
                }
                if (parseFloat(changes.value.currentValue) > this.max) {
                    this.value = String(this.max);
                }
                this.stringValue = this.toText(changes.value.currentValue);
                if (this.rounding === "round") {
                    this.value = changes.value.currentValue;
                }
                if (String(changes.value.currentValue).indexOf(',') === -1) {
                    this.value = this.setMinMax(this.value);
                    this.value = this.toText(this.value);
                }
            }
        }
    }
    /**
     * ngAfterViewCheckedイベント
     * 表示画面と修正画面でカンマ編集
     * @return {?}
     */
    ngAfterViewChecked() {
        if (!this.firstFlag)
            return;
        //this.valueが存在するときに、カンマ編集をしなければならない。
        /** @type {?} */
        let matInputElement = document.activeElement.classList.contains('mat-input-element');
        if (this.firstFlag && this.value && !matInputElement) {
            this.value = this.toText(this.value);
        }
        //this.valueが存在するときに、firstFlagにfalseを代入しないと、カンマ編集がされなくなる
        if (this.value) {
            this.firstFlag = false;
        }
    }
    /**
     * onInput
     * @param {?} event input
     * @return {?}
     */
    onInput(event) {
        SHCtlCommon.replaceHalfWidth(event);
        SHCtlCommon.replaceSpace(event);
        SHCtlCommon.replaceFUllSpace(event);
        SHCtlCommon.replaceSign(event, [",", "\.", "\-"]);
        //2文字目以降の「-」の入力を受け付けない
        if (event.target.value.length > 1)
            event.target.value = event.target.value.slice(0, 1) + event.target.value.slice(1).replace(/[\-]/g, "");
        SHCtlCommon.replaceFullWidth(event);
        this.checkNumbersSigns(event);
        if (event.inputType !== 'insertCompositionText') {
            SHCtlCommon.replaceSpace(event);
            SHCtlCommon.replaceFUllSpace(event);
            SHCtlCommon.replaceSign(event, [",", "\.", "\-"]);
            SHCtlCommon.replaceFullWidth(event);
            SHCtlCommon.sliceLength(event, this.maxlength);
            this.checkNumbersSigns(event);
        }
    }
    /**
     * マッチした値を記号に置き換える
     * @param {?} event input
     * @return {?}
     */
    checkNumbersSigns(event) {
        event.target.value = event.target.value.replace(/^[\.|,]/g, "");
        event.target.value = event.target.value.replace(/[\.]{2,}/g, ".");
        event.target.value = event.target.value.replace(/[\,]{2,}/g, ",");
        event.target.value = event.target.value.replace(/[\-]{1,}/g, "-");
        if ((/\d.*\.\d.*/).test(event.target.value) && event.data === ".") {
            event.target.value = event.target.value.slice(0, event.target.value.length - 1);
        }
    }
    /**
     * onClick
     * @param {?} event click
     * @return {?}
     */
    onClick(event) {
        this.onBeforeClick(event);
        this.onAfterClick(event);
    }
    /**
     * onKeyDown
     * @param {?} event keydown
     * @return {?}
     */
    onKeyDown(event) {
        if (event.keyCode == ShCtlConst.ORDINAL.KEYS.KEY_TAB) {
            setTimeout((/**
             * @return {?}
             */
            () => {
                event.target.value = this.toText(event.target.value);
            }), 0);
        }
    }
    /**
     * onChange
     * @param {?} event change
     * @return {?}
     */
    onChange(event) {
        this.onBeforeChange(event);
        //emitの直前にも値の精査を行う
        this.onInput(event);
        //onChange発火時に数値でなければクリアする
        if (isNaN(Number(event.target.value)) === true) {
            event.target.value = '';
            return;
        }
        //min maxの値を反映させる
        event.target.value = this.setMinMax(event.target.value);
        event.target.value = this.toText(event.target.value);
        this.valueChange.emit(Number(this.removeComma(event.target.value)));
        setTimeout((/**
         * @return {?}
         */
        () => { this.onAfterChange(event); }), 0);
    }
    /**
     * onFocus
     * @param {?} event focus
     * @return {?}
     */
    onFocus(event) {
        this.onBeforeFocus(event);
        event.target.value = this.removeComma(event.target.value);
        event.target.select();
        setTimeout((/**
         * @return {?}
         */
        () => { this.onAfterFocus(event); }), 0);
    }
    /**
     * onBlur
     * @param {?} event blur
     * @return {?}
     */
    onBlur(event) {
        //桁数指定で値を丸める
        this.onBeforeBlur(event);
        //カンマ区切り
        setTimeout((/**
         * @return {?}
         */
        () => {
            event.target.value = this.toText(event.target.value);
        }), 0);
        setTimeout((/**
         * @return {?}
         */
        () => { this.onAfterBlur(event); }), 0);
        ;
    }
    /**
     * カンマ付きの値を返す
     * @param {?} inputTargetValue event.target.value
     * @return {?}
     */
    toText(inputTargetValue) {
        inputTargetValue = this.removeComma(inputTargetValue);
        if (!inputTargetValue)
            return null;
        if (isNaN(Number(inputTargetValue)))
            return null;
        if (this.rounding === "round") {
            //桁数指定で値を丸める
            /** @type {?} */
            let ret = parseFloat(parseFloat(inputTargetValue).toFixed(this.decimaldigit)).toString();
            return parseFloat(ret).toLocaleString(undefined, {
                minimumFractionDigits: this.decimaldigit,
                maximumFractionDigits: this.decimaldigit
            });
        }
        else if (this.rounding === "floor") {
            //桁数指定で値を丸める
            /** @type {?} */
            const FLOOR = (/**
             * @param {?} value
             * @param {?} decimalDigit
             * @return {?}
             */
            (value, decimalDigit) => this.decimalAdjust(this.rounding, value, decimalDigit));
            /** @type {?} */
            let ret = FLOOR(parseFloat(inputTargetValue), -this.decimaldigit).toString();
            return parseFloat(ret).toLocaleString(undefined, {
                minimumFractionDigits: this.decimaldigit,
                maximumFractionDigits: this.decimaldigit
            });
        }
        else if (this.rounding === "ceil") {
            //桁数指定で値を丸める
            /** @type {?} */
            const CEIL = (/**
             * @param {?} value
             * @param {?} decimalDigit
             * @return {?}
             */
            (value, decimalDigit) => this.decimalAdjust(this.rounding, value, decimalDigit));
            /** @type {?} */
            let ret = CEIL(parseFloat(inputTargetValue), -this.decimaldigit).toString();
            return parseFloat(ret).toLocaleString(undefined, {
                minimumFractionDigits: this.decimaldigit,
                maximumFractionDigits: this.decimaldigit
            });
        }
    }
    /**
     * min maxを反映した値を返す
     * @param {?} inputTargetValue event.target.value
     * @return {?}
     */
    setMinMax(inputTargetValue) {
        if (!inputTargetValue)
            return "";
        if (isNaN(Number(inputTargetValue)))
            return "";
        if (parseFloat(inputTargetValue) < this.min) {
            inputTargetValue = this.min.toString();
        }
        if (parseFloat(inputTargetValue) > this.max) {
            inputTargetValue = this.max.toString();
        }
        if (this.rounding === "round") {
            /** @type {?} */
            let w = Math.pow(10, this.decimaldigit);
            inputTargetValue = (Math.round(+inputTargetValue * w + 1e-10) / w).toString();
            return inputTargetValue;
        }
        else if (this.rounding === "floor" || this.rounding === "ceil") {
            return inputTargetValue;
        }
    }
    /**
     * roundingがfloorかceilの時に切り捨て切り上げ処理を行う
     * @param {?} type floor or ceil
     * @param {?} value value
     * @param {?} decimalDigit decimalDigit
     * @return {?}
     */
    decimalAdjust(type, value, decimalDigit) {
        if (typeof decimalDigit === 'undefined' || +decimalDigit === 0) {
            return Math[type](value);
        }
        value = +value;
        decimalDigit = +decimalDigit;
        if (isNaN(value) || !(typeof decimalDigit === 'number' && decimalDigit % 1 === 0)) {
            return NaN;
        }
        value = value.toString().split('e');
        value = Math[type](+(value[0] + 'e' + (value[1] ? (+value[1] - decimalDigit) : -decimalDigit)));
        value = value.toString().split('e');
        value = +(value[0] + 'e' + (value[1] ? (+value[1] + decimalDigit) : decimalDigit));
        return value;
    }
    /**
     * カンマを外した値を返す
     * @param {?} inputTargetValue event.target.value
     * @return {?}
     */
    removeComma(inputTargetValue) {
        inputTargetValue = new String(inputTargetValue).replace(/,/g, "");
        return inputTargetValue;
    }
}
SHCtlNumberComponent.decorators = [
    { type: Component, args: [{
                selector: 'sh-ctl-number',
                template: "<ng-container *ngIf=\"!onlyField; else onlyFieldControl\">\r\n  <div *ngIf=\"!isDisabled\" (focusin)=\"onFocusin($event)\" (focusout)=\"onFocusout($event)\">\r\n    <mat-form-field class=\"mat-validation\" [floatLabel]=\"floatLabel\">\r\n      <input #inputElm matInput [required]=\"required\" [placeholder]=\"title\" (focus)=\"onFocus($event)\" type=\"email\" title=\"\"\r\n        [(ngModel)]=\"value\" attr.name=\"{{ctlName}}\" class=\"form-control can-moved-with-the-enter-key {{strClass}}\"\r\n        value=\"\" style=\"text-align: right; \" (input)=\"onInput($event)\" (click)=\"onClick($event)\" (keydown)=\"onKeyDown($event)\"\r\n        (change)=\"onChange($event)\" [disabled]=\"disabled\" [ngStyle]=\"styles\" [ngClass]=\"objClass\" />\r\n      <button mat-button *ngIf=\"inputElm.value && !inputElm.readOnly && !inputElm.disabled\" matSuffix mat-icon-button\r\n        aria-label=\"Clear\" (mousedown)=\"clearValue()\" (keydown)=\"clickClearButton($event)\">\r\n        <mat-icon>close</mat-icon>\r\n      </button>\r\n    </mat-form-field>\r\n    <span class=\"custom-alert-message\">{{message.toString().split(',').join(' ')}}</span>\r\n  </div>\r\n</ng-container>\r\n\r\n<ng-template #onlyFieldControl>\r\n  <div class=\"only-field\" (focusin)=\"onFocusin($event)\" (focusout)=\"onFocusout($event)\">\r\n    <input #inputElm matInput [required]=\"required\" (focus)=\"onFocus($event)\"\r\n      [(ngModel)]=\"value\" attr.name=\"{{ctlName}}\" class=\"form-control can-moved-with-the-enter-key {{strClass}}\" title=\"\"\r\n      value=\"\" style=\"text-align: right; \" (input)=\"onInput($event)\" (click)=\"onClick($event)\"\r\n      (change)=\"onChange($event)\" [disabled]=\"disabled\" [ngStyle]=\"styles\" [ngClass]=\"objClass\" />\r\n    <button mat-button *ngIf=\"inputElm.value && !inputElm.readOnly && !inputElm.disabled\" matSuffix mat-icon-button\r\n      aria-label=\"Clear\" (mousedown)=\"clearValue()\" (keydown)=\"clickClearButton($event)\">\r\n      <mat-icon>close</mat-icon>\r\n    </button>\r\n  </div>\r\n</ng-template>\r\n\r\n<div *ngIf=\"isDisabled\" class=\"display-ctl-view\">\r\n  <div>\r\n    <div *ngIf=\"title\" class=\"display-ctl-view\">\r\n      <div class=\"display-result\" [ngStyle]=\"{'width.px': labelWidth}\" fxLayout=\"row wrap\" fxFlex>\r\n        <div fxFlex class=\"item-title\"><strong>{{title}}:</strong></div>\r\n      </div>\r\n      <div fxFlex class=\"valueOutput\">\r\n        {{stringValue}}\r\n      </div>\r\n    </div>\r\n\r\n    <div *ngIf=\"!title\" class=\"display-ctl-view notitle-value\">\r\n      <div fxFlex class=\"valueOutput\">\r\n        {{stringValue}}\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n",
                styles: [".item-title{margin-left:.5%;margin-right:25%}.display-ctl-view{display:-webkit-box;display:flex}.display-result{display:-webkit-box;display:flex;margin-left:30px}.valueOutput{-webkit-box-flex:1;flex:1;padding-top:4px}.validation-error::ng-deep .mat-form-field-label{color:red}.validation-error::ng-deep .mat-form-field-underline{background-color:red}.notitle-value{width:100%;margin-left:30px}", ".sh-flex{width:100%;display:-webkit-inline-box;display:inline-flex}.sh-flex-center{-webkit-box-align:center;align-items:center}.sh-flex-between{-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:center;align-items:center}.display-ctl-view{margin-top:20px}.overlay{position:fixed;display:-webkit-box;display:flex;top:0;left:0;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center;height:100%;width:100%;color:gray;background-color:rgba(0,0,0,.5);z-index:9999}.loader-text{display:block;color:#f3f3f3;margin-top:1em}.mat-dialog-content{overflow:hidden;max-height:none}.sh-dialog-content{height:85%}.sh-kbn-dialog-table-container{height:92%;overflow-y:scroll;margin-top:18px;margin-bottom:18px}.sh-dialog-table-container{display:-webkit-box;display:flex;height:83%;overflow-y:scroll;margin-top:18px;margin-bottom:18px}.sh-text-center{text-align:center}.sh-width-100{width:100%}.sh-label{display:block}.custom-alert-message{top:-20px;position:relative;font-size:.75em;color:rgba(0,0,0,.54)}.result-input,.sh-label{color:rgba(0,0,0,.87)}::ng-deep .mat-form-field-label span{color:rgba(0,0,0,.87)}::ng-deep .result-container .mat-form-field-flex{background-color:#ccdcff}.sh-ctl-state-primary::ng-deep .mat-form-field-label{color:#3f51b5}.sh-ctl-state-primary::ng-deep .mat-form-field-underline{background-color:#3f51b5}.sh-ctl-state-primary-message{color:#3f51b5}.sh-ctl-state-secondary::ng-deep .mat-form-field-label{color:#ff4081}.sh-ctl-state-secondary::ng-deep .mat-form-field-underline{background-color:#ff4081}.sh-ctl-state-secondary-message{color:#ff4081}.sh-ctl-state-success::ng-deep .mat-form-field-label{color:#0dad17}.sh-ctl-state-success::ng-deep .mat-form-field-underline{background-color:#0dad17}.sh-ctl-state-success-message{color:#0dad17}.sh-ctl-state-danger::ng-deep .mat-form-field-label{color:#f44336}.sh-ctl-state-danger::ng-deep .mat-form-field-underline{background-color:#f44336}.sh-ctl-state-danger-message{color:#f44336}.sh-ctl-state-warning::ng-deep .mat-form-field-label{color:#e29f2b}.sh-ctl-state-warning::ng-deep .mat-form-field-underline{background-color:#e29f2b}.sh-ctl-state-warning-message{color:#e29f2b}.sh-container{position:relative;width:100%;height:100%}.only-field{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;width:100%;height:100%;min-height:28px}.only-field input,.only-field textarea{font:inherit;background:0 0;color:currentColor;border:none;outline:0;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit}.only-field-danger{background-color:#f44336}.only-field-warning{background-color:#e29f2b}.only-field-success{background-color:#0dad17}::ng-deep .only-field .material-icons{font-size:13px}::ng-deep .only-field .mat-button{position:relative;width:24px;height:24px}::ng-deep .only-field .mat-icon-button{position:relative;width:24px;height:24px}::ng-deep .only-field .mat-icon{position:absolute;top:0;left:0}::ng-deep .only-field .mat-datepicker-toggle-default-icon{position:absolute;top:25%;left:0;right:0;bottom:0;margin-left:auto;margin-right:auto}::ng-deep .mat-datepicker-toggle span svg{width:16px;height:16px}.only-label{background-color:#ccdcff;position:relative}.only-label mat-icon{position:absolute;top:25%;left:0;right:0;bottom:0;margin-left:auto;font-size:16px}.bind-flg__input{opacity:0;height:0;width:0;position:absolute;z-index:-100}"]
            }] }
];
/** @nocollapse */
SHCtlNumberComponent.ctorParameters = () => [];
SHCtlNumberComponent.propDecorators = {
    min: [{ type: Input }],
    max: [{ type: Input }],
    decimaldigit: [{ type: Input }],
    rounding: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    SHCtlNumberComponent.prototype.min;
    /** @type {?} */
    SHCtlNumberComponent.prototype.max;
    /** @type {?} */
    SHCtlNumberComponent.prototype.decimaldigit;
    /** @type {?} */
    SHCtlNumberComponent.prototype.rounding;
    /** @type {?} */
    SHCtlNumberComponent.prototype.stringValue;
    /** @type {?} */
    SHCtlNumberComponent.prototype.firstFlag;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2gtY3RsLW51bWJlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9zaC1mb3JtLWNvbnRyb2wvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9zaC1jdGwtbnVtYmVyL3NoLWN0bC1udW1iZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFxQixLQUFLLEVBQW1DLE1BQU0sZUFBZSxDQUFDO0FBQ3JHLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUMvQyxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sK0JBQStCLENBQUM7QUFDOUQsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBTzlDLE1BQU0sT0FBTyxvQkFBcUIsU0FBUSxhQUFxQjtJQVE3RDtRQUNFLEtBQUssRUFBRSxDQUFDO1FBUk0sUUFBRyxHQUFXLENBQUMsQ0FBQztRQUNoQixRQUFHLEdBQVcsV0FBVyxDQUFDO1FBQzFCLGlCQUFZLEdBQVcsQ0FBQyxDQUFDO1FBQ3pCLGFBQVEsR0FBVyxPQUFPLENBQUM7UUFFcEMsY0FBUyxHQUFZLElBQUksQ0FBQztRQUkvQixJQUFJLENBQUMsT0FBTyxHQUFHLGFBQWEsQ0FBQztJQUMvQixDQUFDOzs7O0lBRU0sUUFBUTtRQUNiLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztJQUNoQixDQUFDOzs7Ozs7O0lBT00sV0FBVyxDQUFDLE9BQXNCO1FBQ3ZDLElBQUksT0FBTyxDQUFDLEtBQUssRUFBRTtZQUNqQixJQUFJLE9BQU8sQ0FBQyxLQUFLLENBQUMsWUFBWSxFQUFFO2dCQUM5QixJQUFJLE9BQU8sQ0FBQyxLQUFLLENBQUMsWUFBWSxLQUFLLEVBQUUsSUFBSSxPQUFPLENBQUMsS0FBSyxDQUFDLFlBQVksS0FBSyxTQUFTLElBQUksT0FBTyxDQUFDLEtBQUssQ0FBQyxZQUFZLEtBQUssTUFBTSxDQUFDLDBCQUEwQixDQUFDLEVB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Q0FBQyxDQUFDO1FBQ2hHLEtBQUssR0FBRyxLQUFLLENBQUMsUUFBUSxFQUFFLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3BDLEtBQUssR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQztRQUNuRixPQUFPLEtBQUssQ0FBQztJQUNmLENBQUM7Ozs7OztJQU1NLFdBQVcsQ0FBQyxnQkFBd0I7UUFDekMsZ0JBQWdCLEdBQUcsSUFBSSxNQUFNLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBQ2xFLE9BQU8sZ0JBQWdCLENBQUM7SUFDMUIsQ0FBQzs7O1lBOVFGLFNBQVMsU0FBQztnQkFDVCxRQUFRLEVBQUUsZUFBZTtnQkFDekIsMG9GQUE2Qzs7YUFFOUM7Ozs7O2tCQUVFLEtBQUs7a0JBQ0wsS0FBSzsyQkFDTCxLQUFLO3VCQUNMLEtBQUs7Ozs7SUFITixtQ0FBZ0M7O0lBQ2hDLG1DQUEwQzs7SUFDMUMsNENBQXlDOztJQUN6Qyx3Q0FBMkM7O0lBQzNDLDJDQUF3Qjs7SUFDeEIseUNBQWlDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIE9uQ2hhbmdlcywgSW5wdXQsIFNpbXBsZUNoYW5nZXMsIEFmdGVyVmlld0NoZWNrZWQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgU0hDdGxDb21tb24gfSBmcm9tICcuLi9zaC1jdGwtY29tbW9uJztcclxuaW1wb3J0IHsgU0hGb3JtQ29udHJvbCB9IGZyb20gJy4uLy4uL3V0aWxpdGllcy9TaEZvcm1Db250cm9sJztcclxuaW1wb3J0IHsgU2hDdGxDb25zdCB9IGZyb20gXCIuLi8uLi9jb25zdFNoQ3RsXCI7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ3NoLWN0bC1udW1iZXInLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi9zaC1jdGwtbnVtYmVyLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi9zaC1jdGwtbnVtYmVyLmNvbXBvbmVudC5jc3MnLCAnLi4vLi4vLi4vc3R5bGUuY29tbW9uLmNzcyddXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBTSEN0bE51bWJlckNvbXBvbmVudCBleHRlbmRzIFNIRm9ybUNvbnRyb2w8c3RyaW5nPiBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzLCBBZnRlclZpZXdDaGVja2VkIHtcclxuICBASW5wdXQoKSBwdWJsaWMgbWluOiBudW1iZXIgPSAwO1xyXG4gIEBJbnB1dCgpIHB1YmxpYyBtYXg6IG51bWJlciA9IDk5OTk5OTk5OTk5O1xyXG4gIEBJbnB1dCgpIHB1YmxpYyBkZWNpbWFsZGlnaXQ6IG51bWJlciA9IDA7XHJcbiAgQElucHV0KCkgcHVibGljIHJvdW5kaW5nOiBzdHJpbmcgPSBcInJvdW5kXCI7XHJcbiAgcHVibGljIHN0cmluZ1ZhbHVlOiBhbnk7XHJcbiAgcHVibGljIGZpcnN0RmxhZzogYm9vbGVhbiA9IHRydWU7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgc3VwZXIoKTtcclxuICAgIHRoaXMuY3RsTmFtZSA9IFwiU0hDdGxOdW1iZXJcIjtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBuZ09uSW5pdCgpIHtcclxuICAgIHRoaXMub25Jbml0KCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBuZ09uQ2hhbmdlc+OCpOODmeODs+ODiFxyXG4gICAqIOWApOWkieabtOaZguOBq+ODleOCqeODvOODnuODg+ODiOOCkuaVtOW9olxyXG4gICAqIEBwYXJhbSBldmVudCBpbnB1dFxyXG4gICAqL1xyXG4gIHB1YmxpYyBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XHJcbiAgICBpZiAoY2hhbmdlcy52YWx1ZSkge1xyXG4gICAgICBpZiAoY2hhbmdlcy52YWx1ZS5jdXJyZW50VmFsdWUpIHtcclxuICAgICAgICBpZiAoY2hhbmdlcy52YWx1ZS5jdXJyZW50VmFsdWUgPT09ICcnIHx8IGNoYW5nZXMudmFsdWUuY3VycmVudFZhbHVlID09PSB1bmRlZmluZWQgfHwgY2hhbmdlcy52YWx1ZS5jdXJyZW50VmFsdWUgPT09IFN0cmluZygvW15cXHgwMS1cXHg3RVxceEExLVxceERGXSskL2cpKSB7XHJcbiAgICAgICAgICB0aGlzLnZhbHVlID0gJyc7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChwYXJzZUZsb2F0KGNoYW5nZXMudmFsdWUuY3VycmVudFZhbHVlKSA8IHRoaXMubWluKSB7XHJcbiAgICAgICAgICB0aGlzLnZhbHVlID0gU3RyaW5nKHRoaXMubWluKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHBhcnNlRmxvYXQoY2hhbmdlcy52YWx1ZS5jdXJyZW50VmFsdWUpID4gdGhpcy5tYXgpIHtcclxuICAgICAgICAgIHRoaXMudmFsdWUgPSBTdHJpbmcodGhpcy5tYXgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnN0cmluZ1ZhbHVlID0gdGhpcy50b1RleHQoY2hhbmdlcy52YWx1ZS5jdXJyZW50VmFsdWUpO1xyXG4gICAgICAgIGlmICh0aGlzLnJvdW5kaW5nID09PSBcInJvdW5kXCIpIHtcclxuICAgICAgICAgIHRoaXMudmFsdWUgPSBjaGFuZ2VzLnZhbHVlLmN1cnJlbnRWYWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKFN0cmluZyhjaGFuZ2VzLnZhbHVlLmN1cnJlbnRWYWx1ZSkuaW5kZXhPZignLCcpID09PSAtMSkge1xyXG4gICAgICAgICAgdGhpcy52YWx1ZSA9IHRoaXMuc2V0TWluTWF4KHRoaXMudmFsdWUpO1xyXG4gICAgICAgICAgdGhpcy52YWx1ZSA9IHRoaXMudG9UZXh0KHRoaXMudmFsdWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogbmdBZnRlclZpZXdDaGVja2Vk44Kk44OZ44Oz44OIXHJcbiAgICog6KGo56S655S76Z2i44Go5L+u5q2j55S76Z2i44Gn44Kr44Oz44Oe57eo6ZuGXHJcbiAgICovXHJcbiAgbmdBZnRlclZpZXdDaGVja2VkKCkge1xyXG4gICAgaWYoIXRoaXMuZmlyc3RGbGFnKSByZXR1cm47XHJcblxyXG4gICAgLy90aGlzLnZhbHVl44GM5a2Y5Zyo44GZ44KL44Go44GN44Gr44CB44Kr44Oz44Oe57eo6ZuG44KS44GX44Gq44GR44KM44Gw44Gq44KJ44Gq44GE44CCXHJcbiAgICBsZXQgbWF0SW5wdXRFbGVtZW50ID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ21hdC1pbnB1dC1lbGVtZW50Jyk7XHJcbiAgICBpZiAodGhpcy5maXJzdEZsYWcgJiYgdGhpcy52YWx1ZSAmJiAhbWF0SW5wdXRFbGVtZW50KSB7XHJcbiAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnRvVGV4dCh0aGlzLnZhbHVlKTtcclxuICAgIH1cclxuXHJcbiAgICAvL3RoaXMudmFsdWXjgYzlrZjlnKjjgZnjgovjgajjgY3jgavjgIFmaXJzdEZsYWfjgatmYWxzZeOCkuS7o+WFpeOBl+OBquOBhOOBqOOAgeOCq+ODs+ODnue3qOmbhuOBjOOBleOCjOOBquOBj+OBquOCi1xyXG4gICAgaWYodGhpcy52YWx1ZSkge1xyXG4gICAgICB0aGlzLmZpcnN0RmxhZyA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIG9uSW5wdXRcclxuICAgKiBAcGFyYW0gZXZlbnQgaW5wdXRcclxuICAgKi9cclxuICBwdWJsaWMgb25JbnB1dChldmVudDogYW55KSB7XHJcbiAgICBTSEN0bENvbW1vbi5yZXBsYWNlSGFsZldpZHRoKGV2ZW50KTtcclxuICAgIFNIQ3RsQ29tbW9uLnJlcGxhY2VTcGFjZShldmVudCk7XHJcbiAgICBTSEN0bENvbW1vbi5yZXBsYWNlRlVsbFNwYWNlKGV2ZW50KTtcclxuICAgIFNIQ3RsQ29tbW9uLnJlcGxhY2VTaWduKGV2ZW50LCBbXCIsXCIsIFwiXFwuXCIsIFwiXFwtXCJdKTtcclxuICAgIC8vMuaWh+Wtl+ebruS7pemZjeOBruOAjC3jgI3jga7lhaXlipvjgpLlj5fjgZHku5jjgZHjgarjgYRcclxuICAgIGlmIChldmVudC50YXJnZXQudmFsdWUubGVuZ3RoID4gMSlcclxuICAgICAgZXZlbnQudGFyZ2V0LnZhbHVlID0gZXZlbnQudGFyZ2V0LnZhbHVlLnNsaWNlKDAsIDEpICsgZXZlbnQudGFyZ2V0LnZhbHVlLnNsaWNlKDEpLnJlcGxhY2UoL1tcXC1dL2csIFwiXCIpO1xyXG4gICAgU0hDdGxDb21tb24ucmVwbGFjZUZ1bGxXaWR0aChldmVudCk7XHJcbiAgICB0aGlzLmNoZWNrTnVtYmVyc1NpZ25zKGV2ZW50KTtcclxuICAgIGlmIChldmVudC5pbnB1dFR5cGUgIT09ICdpbnNlcnRDb21wb3NpdGlvblRleHQnKSB7ICBcclxuICAgICAgU0hDdGxDb21tb24ucmVwbGFjZVNwYWNlKGV2ZW50KTtcclxuICAgICAgU0hDdGxDb21tb24ucmVwbGFjZUZVbGxTcGFjZShldmVudCk7XHJcbiAgICAgIFNIQ3RsQ29tbW9uLnJlcGxhY2VTaWduKGV2ZW50LCBbXCIsXCIsIFwiXFwuXCIsIFwiXFwtXCJdKTtcclxuICAgICAgU0hDdGxDb21tb24ucmVwbGFjZUZ1bGxXaWR0aChldmVudCk7XHJcbiAgICAgIFNIQ3RsQ29tbW9uLnNsaWNlTGVuZ3RoKGV2ZW50LCB0aGlzLm1heGxlbmd0aCk7XHJcbiAgICAgIHRoaXMuY2hlY2tOdW1iZXJzU2lnbnMoZXZlbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog44Oe44OD44OB44GX44Gf5YCk44KS6KiY5Y+344Gr572u44GN5o+b44GI44KLXHJcbiAgICogQHBhcmFtIGV2ZW50IGlucHV0XHJcbiAgICovXHJcbiAgcHVibGljIGNoZWNrTnVtYmVyc1NpZ25zKGV2ZW50OiBhbnkpIHtcclxuICAgIGV2ZW50LnRhcmdldC52YWx1ZSA9IGV2ZW50LnRhcmdldC52YWx1ZS5yZXBsYWNlKC9eW1xcLnwsXS9nLCBcIlwiKTtcclxuICAgIGV2ZW50LnRhcmdldC52YWx1ZSA9IGV2ZW50LnRhcmdldC52YWx1ZS5yZXBsYWNlKC9bXFwuXXsyLH0vZywgXCIuXCIpO1xyXG4gICAgZXZlbnQudGFyZ2V0LnZhbHVlID0gZXZlbnQudGFyZ2V0LnZhbHVlLnJlcGxhY2UoL1tcXCxdezIsfS9nLCBcIixcIik7XHJcbiAgICBldmVudC50YXJnZXQudmFsdWUgPSBldmVudC50YXJnZXQudmFsdWUucmVwbGFjZSgvW1xcLV17MSx9L2csIFwiLVwiKTtcclxuICAgIGlmICgoL1xcZC4qXFwuXFxkLiovKS50ZXN0KGV2ZW50LnRhcmdldC52YWx1ZSkgJiYgZXZlbnQuZGF0YSA9PT0gXCIuXCIpIHtcclxuICAgICAgZXZlbnQudGFyZ2V0LnZhbHVlID0gZXZlbnQudGFyZ2V0LnZhbHVlLnNsaWNlKDAsIGV2ZW50LnRhcmdldC52YWx1ZS5sZW5ndGggLSAxKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIG9uQ2xpY2tcclxuICAgKiBAcGFyYW0gZXZlbnQgY2xpY2tcclxuICAgKi9cclxuICBwdWJsaWMgb25DbGljayhldmVudCkge1xyXG4gICAgdGhpcy5vbkJlZm9yZUNsaWNrKGV2ZW50KTtcclxuXHJcbiAgICB0aGlzLm9uQWZ0ZXJDbGljayhldmVudCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBvbktleURvd25cclxuICAgKiBAcGFyYW0gZXZlbnQga2V5ZG93blxyXG4gICAqL1xyXG4gIG9uS2V5RG93bihldmVudCkge1xyXG4gICAgaWYoZXZlbnQua2V5Q29kZSA9PSBTaEN0bENvbnN0Lk9SRElOQUwuS0VZUy5LRVlfVEFCKSB7XHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIGV2ZW50LnRhcmdldC52YWx1ZSA9IHRoaXMudG9UZXh0KGV2ZW50LnRhcmdldC52YWx1ZSk7XHJcbiAgICAgIH0sIDApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogb25DaGFuZ2VcclxuICAgKiBAcGFyYW0gZXZlbnQgY2hhbmdlXHJcbiAgICovXHJcbiAgcHVibGljIG9uQ2hhbmdlKGV2ZW50KSB7XHJcbiAgICB0aGlzLm9uQmVmb3JlQ2hhbmdlKGV2ZW50KTtcclxuXHJcbiAgICAvL2VtaXTjga7nm7TliY3jgavjgoLlgKTjga7nsr7mn7vjgpLooYzjgYZcclxuICAgIHRoaXMub25JbnB1dChldmVudCk7XHJcblxyXG4gICAgLy9vbkNoYW5nZeeZuueBq+aZguOBq+aVsOWApOOBp+OBquOBkeOCjOOBsOOCr+ODquOCouOBmeOCi1xyXG4gICAgaWYgKGlzTmFOKE51bWJlcihldmVudC50YXJnZXQudmFsdWUpKSA9PT0gdHJ1ZSkge1xyXG4gICAgICBldmVudC50YXJnZXQudmFsdWUgPSAnJztcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vbWluIG1heOOBruWApOOCkuWPjeaYoOOBleOBm+OCi1xyXG4gICAgZXZlbnQudGFyZ2V0LnZhbHVlID0gdGhpcy5zZXRNaW5NYXgoZXZlbnQudGFyZ2V0LnZhbHVlKTtcclxuICAgIGV2ZW50LnRhcmdldC52YWx1ZSA9IHRoaXMudG9UZXh0KGV2ZW50LnRhcmdldC52YWx1ZSk7XHJcbiAgICB0aGlzLnZhbHVlQ2hhbmdlLmVtaXQoTnVtYmVyKHRoaXMucmVtb3ZlQ29tbWEoZXZlbnQudGFyZ2V0LnZhbHVlKSkpO1xyXG5cclxuICAgIHNldFRpbWVvdXQoKCkgPT4ge3RoaXMub25BZnRlckNoYW5nZShldmVudCl9LCAwKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIG9uRm9jdXNcclxuICAgKiBAcGFyYW0gZXZlbnQgZm9jdXNcclxuICAgKi9cclxuICBwdWJsaWMgb25Gb2N1cyhldmVudDogYW55KSB7XHJcbiAgICB0aGlzLm9uQmVmb3JlRm9jdXMoZXZlbnQpO1xyXG5cclxuICAgIGV2ZW50LnRhcmdldC52YWx1ZSA9IHRoaXMucmVtb3ZlQ29tbWEoZXZlbnQudGFyZ2V0LnZhbHVlKTtcclxuICAgIGV2ZW50LnRhcmdldC5zZWxlY3QoKTtcclxuXHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHt0aGlzLm9uQWZ0ZXJGb2N1cyhldmVudCl9LCAwKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIG9uQmx1clxyXG4gICAqIEBwYXJhbSBldmVudCBibHVyXHJcbiAgICovXHJcbiAgcHVibGljIG9uQmx1cihldmVudDogYW55KSB7XHJcbiAgICAvL+ahgeaVsOaMh+WumuOBp+WApOOCkuS4uOOCgeOCi1xyXG4gICAgdGhpcy5vbkJlZm9yZUJsdXIoZXZlbnQpO1xyXG4gICAgXHJcbiAgICAvL+OCq+ODs+ODnuWMuuWIh+OCilxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIGV2ZW50LnRhcmdldC52YWx1ZSA9IHRoaXMudG9UZXh0KGV2ZW50LnRhcmdldC52YWx1ZSk7XHJcbiAgICB9LCAwKTtcclxuXHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHt0aGlzLm9uQWZ0ZXJCbHVyKGV2ZW50KTt9LCAwKTs7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDjgqvjg7Pjg57ku5jjgY3jga7lgKTjgpLov5TjgZlcclxuICAgKiBAcGFyYW0gaW5wdXRUYXJnZXRWYWx1ZSBldmVudC50YXJnZXQudmFsdWVcclxuICAgKi9cclxuICBwdWJsaWMgdG9UZXh0KGlucHV0VGFyZ2V0VmFsdWU6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICBpbnB1dFRhcmdldFZhbHVlID0gdGhpcy5yZW1vdmVDb21tYShpbnB1dFRhcmdldFZhbHVlKVxyXG4gICAgaWYgKCFpbnB1dFRhcmdldFZhbHVlKSByZXR1cm4gbnVsbDtcclxuICAgIGlmIChpc05hTihOdW1iZXIoaW5wdXRUYXJnZXRWYWx1ZSkpKSByZXR1cm4gbnVsbDtcclxuICAgIGlmKHRoaXMucm91bmRpbmcgPT09IFwicm91bmRcIikge1xyXG4gICAgICAvL+ahgeaVsOaMh+WumuOBp+WApOOCkuS4uOOCgeOCi1xyXG4gICAgICBsZXQgcmV0ID0gIHBhcnNlRmxvYXQocGFyc2VGbG9hdChpbnB1dFRhcmdldFZhbHVlKS50b0ZpeGVkKHRoaXMuZGVjaW1hbGRpZ2l0KSkudG9TdHJpbmcoKTtcclxuICAgICAgcmV0dXJuIHBhcnNlRmxvYXQocmV0KS50b0xvY2FsZVN0cmluZyh1bmRlZmluZWQsIHtcclxuICAgICAgICBtaW5pbXVtRnJhY3Rpb25EaWdpdHM6IHRoaXMuZGVjaW1hbGRpZ2l0LFxyXG4gICAgICAgIG1heGltdW1GcmFjdGlvbkRpZ2l0czogdGhpcy5kZWNpbWFsZGlnaXRcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMucm91bmRpbmcgPT09IFwiZmxvb3JcIikge1xyXG4gICAgICAvL+ahgeaVsOaMh+WumuOBp+WApOOCkuS4uOOCgeOCi1xyXG4gICAgICBjb25zdCBGTE9PUiA9ICh2YWx1ZSwgZGVjaW1hbERpZ2l0KSA9PiB0aGlzLmRlY2ltYWxBZGp1c3QodGhpcy5yb3VuZGluZywgdmFsdWUsIGRlY2ltYWxEaWdpdCk7XHJcbiAgICAgIGxldCByZXQgPSAgRkxPT1IocGFyc2VGbG9hdChpbnB1dFRhcmdldFZhbHVlKSwgLXRoaXMuZGVjaW1hbGRpZ2l0KS50b1N0cmluZygpO1xyXG4gICAgICByZXR1cm4gcGFyc2VGbG9hdChyZXQpLnRvTG9jYWxlU3RyaW5nKHVuZGVmaW5lZCwge1xyXG4gICAgICAgIG1pbmltdW1GcmFjdGlvbkRpZ2l0czogdGhpcy5kZWNpbWFsZGlnaXQsXHJcbiAgICAgICAgbWF4aW11bUZyYWN0aW9uRGlnaXRzOiB0aGlzLmRlY2ltYWxkaWdpdFxyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSBpZiAodGhpcy5yb3VuZGluZyA9PT0gXCJjZWlsXCIpIHtcclxuICAgICAgLy/moYHmlbDmjIflrprjgaflgKTjgpLkuLjjgoHjgotcclxuICAgICAgY29uc3QgQ0VJTCA9ICh2YWx1ZSwgZGVjaW1hbERpZ2l0KSA9PiB0aGlzLmRlY2ltYWxBZGp1c3QodGhpcy5yb3VuZGluZywgdmFsdWUsIGRlY2ltYWxEaWdpdCk7XHJcbiAgICAgIGxldCByZXQgPSAgQ0VJTChwYXJzZUZsb2F0KGlucHV0VGFyZ2V0VmFsdWUpLCAtdGhpcy5kZWNpbWFsZGlnaXQpLnRvU3RyaW5nKCk7XHJcbiAgICAgIHJldHVybiBwYXJzZUZsb2F0KHJldCkudG9Mb2NhbGVTdHJpbmcodW5kZWZpbmVkLCB7XHJcbiAgICAgICAgbWluaW11bUZyYWN0aW9uRGlnaXRzOiB0aGlzLmRlY2ltYWxkaWdpdCxcclxuICAgICAgICBtYXhpbXVtRnJhY3Rpb25EaWdpdHM6IHRoaXMuZGVjaW1hbGRpZ2l0XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogbWluIG1heOOCkuWPjeaYoOOBl+OBn+WApOOCkui/lOOBmVxyXG4gICAqIEBwYXJhbSBpbnB1dFRhcmdldFZhbHVlIGV2ZW50LnRhcmdldC52YWx1ZVxyXG4gICAqL1xyXG4gIHB1YmxpYyBzZXRNaW5NYXgoaW5wdXRUYXJnZXRWYWx1ZTogc3RyaW5nKSB7XHJcbiAgICBpZiAoIWlucHV0VGFyZ2V0VmFsdWUpIHJldHVybiBcIlwiO1xyXG4gICAgaWYgKGlzTmFOKE51bWJlcihpbnB1dFRhcmdldFZhbHVlKSkpIHJldHVybiBcIlwiO1xyXG4gICAgaWYgKHBhcnNlRmxvYXQoaW5wdXRUYXJnZXRWYWx1ZSkgPCB0aGlzLm1pbikge1xyXG4gICAgICBpbnB1dFRhcmdldFZhbHVlID0gdGhpcy5taW4udG9TdHJpbmcoKTtcclxuICAgIH1cclxuICAgIGlmIChwYXJzZUZsb2F0KGlucHV0VGFyZ2V0VmFsdWUpID4gdGhpcy5tYXgpIHtcclxuICAgICAgaW5wdXRUYXJnZXRWYWx1ZSA9IHRoaXMubWF4LnRvU3RyaW5nKCk7XHJcbiAgICB9XHJcbiAgICBpZih0aGlzLnJvdW5kaW5nID09PSBcInJvdW5kXCIpIHtcclxuICAgICAgbGV0IHcgPSBNYXRoLnBvdygxMCAsIHRoaXMuZGVjaW1hbGRpZ2l0KTtcclxuICAgICAgaW5wdXRUYXJnZXRWYWx1ZSA9IChNYXRoLnJvdW5kKCtpbnB1dFRhcmdldFZhbHVlICogdyArIDFlLTEwKS93KS50b1N0cmluZygpO1xyXG4gICAgICByZXR1cm4gaW5wdXRUYXJnZXRWYWx1ZTtcclxuICAgIH0gZWxzZSBpZiAodGhpcy5yb3VuZGluZyA9PT0gXCJmbG9vclwiIHx8IHRoaXMucm91bmRpbmcgPT09IFwiY2VpbFwiKSB7XHJcbiAgICAgIHJldHVybiBpbnB1dFRhcmdldFZhbHVlO1xyXG4gICAgfSBcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIHJvdW5kaW5n44GMZmxvb3LjgYtjZWls44Gu5pmC44Gr5YiH44KK5o2o44Gm5YiH44KK5LiK44GS5Yem55CG44KS6KGM44GGXHJcbiAgICogQHBhcmFtIHR5cGUgZmxvb3Igb3IgY2VpbCBcclxuICAgKiBAcGFyYW0gdmFsdWUgdmFsdWVcclxuICAgKiBAcGFyYW0gZGVjaW1hbERpZ2l0IGRlY2ltYWxEaWdpdFxyXG4gICAqL1xyXG4gIHB1YmxpYyBkZWNpbWFsQWRqdXN0KHR5cGUsIHZhbHVlLCBkZWNpbWFsRGlnaXQpIHtcclxuICAgIGlmICh0eXBlb2YgZGVjaW1hbERpZ2l0ID09PSAndW5kZWZpbmVkJyB8fCArZGVjaW1hbERpZ2l0ID09PSAwKSB7XHJcbiAgICAgIHJldHVybiBNYXRoW3R5cGVdKHZhbHVlKTtcclxuICAgIH1cclxuICAgIHZhbHVlID0gK3ZhbHVlO1xyXG4gICAgZGVjaW1hbERpZ2l0ID0gK2RlY2ltYWxEaWdpdDtcclxuICAgIGlmIChpc05hTih2YWx1ZSkgfHwgISh0eXBlb2YgZGVjaW1hbERpZ2l0ID09PSAnbnVtYmVyJyAmJiBkZWNpbWFsRGlnaXQgJSAxID09PSAwKSkge1xyXG4gICAgICByZXR1cm4gTmFOO1xyXG4gICAgfVxyXG4gICAgdmFsdWUgPSB2YWx1ZS50b1N0cmluZygpLnNwbGl0KCdlJyk7XHJcbiAgICB2YWx1ZSA9IE1hdGhbdHlwZV0oKyh2YWx1ZVswXSArICdlJyArICh2YWx1ZVsxXSA/ICgrdmFsdWVbMV0gLSBkZWNpbWFsRGlnaXQpIDogLWRlY2ltYWxEaWdpdCkpKTtcclxuICAgIHZhbHVlID0gdmFsdWUudG9TdHJpbmcoKS5zcGxpdCgnZScpO1xyXG4gICAgdmFsdWUgPSArKHZhbHVlWzBdICsgJ2UnICsgKHZhbHVlWzFdID8gKCt2YWx1ZVsxXSArIGRlY2ltYWxEaWdpdCkgOiBkZWNpbWFsRGlnaXQpKTtcclxuICAgIHJldHVybiB2YWx1ZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOOCq+ODs+ODnuOCkuWkluOBl+OBn+WApOOCkui/lOOBmVxyXG4gICAqIEBwYXJhbSBpbnB1dFRhcmdldFZhbHVlIGV2ZW50LnRhcmdldC52YWx1ZVxyXG4gICAqL1xyXG4gIHB1YmxpYyByZW1vdmVDb21tYShpbnB1dFRhcmdldFZhbHVlOiBzdHJpbmcpIHtcclxuICAgIGlucHV0VGFyZ2V0VmFsdWUgPSBuZXcgU3RyaW5nKGlucHV0VGFyZ2V0VmFsdWUpLnJlcGxhY2UoLywvZywgXCJcIik7XHJcbiAgICByZXR1cm4gaW5wdXRUYXJnZXRWYWx1ZTtcclxuICB9XHJcblxyXG59XHJcbiJdfQ==