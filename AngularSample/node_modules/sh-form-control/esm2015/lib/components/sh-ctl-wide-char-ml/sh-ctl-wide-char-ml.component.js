/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component } from '@angular/core';
import { SHCtlCommon } from '../sh-ctl-common';
import { SHFormControl } from '../../utilities/ShFormControl';
export class SHCtlWideCharMLComponent extends SHFormControl {
    constructor() {
        super();
        //入力変換時を補足するための値保持
        this._data = "";
        this.allowkeys = [`ArrowLeft`, `ArrowRight`, `ArrowDown`, `ArrowUp`];
        this.ctlName = "SHCtlWideCharML";
    }
    /**
     * @private
     * @param {?} key
     * @return {?}
     */
    isAllowkeys(key) {
        return this.allowkeys.includes(key);
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.onInit();
        if (this.maxByteLength % 2 != 0)
            this.maxByteLength = this.maxByteLength - 1;
    }
    /**
     * onInput
     * @param {?} event input
     * @return {?}
     */
    onInput(event) {
        /** @type {?} */
        const isSameData = (this._data == event.data);
        this._data = event.data;
        //入力変換中は書き換えを行わない
        if (event.isComposing && (!event.isComposing || !isSameData))
            return;
        if (event.inputType !== 'insertCompositionText') {
            SHCtlCommon.sliceLength(event, this.maxlength);
        }
    }
    /**
     * onClick
     * @param {?} event click
     * @return {?}
     */
    onClick(event) {
        this.onBeforeClick(event);
        this.onAfterClick(event);
    }
    /**
     * onFocus
     * @param {?} event focus
     * @return {?}
     */
    onFocus(event) {
        this.onBeforeFocus(event);
        event.target.select();
        setTimeout((/**
         * @return {?}
         */
        () => { this.onAfterFocus(event); }), 0);
    }
    /**
     * onChange
     * @param {?} event change
     * @return {?}
     */
    onChange(event) {
        this.onBeforeChange(event);
        //emitの直前にも値の精査を行う
        this.onInput(event);
        this.onKeyUp(event);
        this.valueChange.emit(event.target.value);
        setTimeout((/**
         * @return {?}
         */
        () => { this.onAfterChange(event); }), 0);
    }
    /**
     * onBlur
     * @param {?} event blur
     * @return {?}
     */
    onBlur(event) {
        this.onBeforeBlur(event);
        if (event.target.value == undefined) {
            setTimeout((/**
             * @return {?}
             */
            () => { this.onAfterBlur(event); }), 0);
            ;
            return;
        }
        ;
        setTimeout((/**
         * @return {?}
         */
        () => { this.onAfterBlur(event); }), 0);
        ;
    }
    /**
     * onKeyUp
     * @param {?} event KeyUp
     * @return {?}
     */
    onKeyUp(event) {
        /** @type {?} */
        const input = (/** @type {?} */ (event.target));
        /** @type {?} */
        const cursor = input.selectionStart;
        if (!event.isComposing) {
            SHCtlCommon.replaceHalfSpaceToFull(event);
            SHCtlCommon.replaceFullDoubleQuote(event);
            SHCtlCommon.replaceHalfKana(event);
            if (event.shiftKey || event.key === "Shift")
                return;
            input.setSelectionRange(cursor, cursor);
        }
    }
    /**
     * onKeyDown
     * @param {?} event KeyUp
     * @return {?}
     */
    onKeyDown(event) {
        if (this.maxByteLength > 0)
            super.onKeyDown(event);
    }
}
SHCtlWideCharMLComponent.decorators = [
    { type: Component, args: [{
                selector: 'sh-ctl-wide-char-ml',
                template: "<ng-container *ngIf=\"!onlyField; else onlyFieldControl\">\r\n  <div *ngIf=\"!isDisabled\" (focusin)=\"onFocusin($event)\" (focusout)=\"onFocusout($event)\">\r\n    <mat-form-field class=\"mat-validation\" [floatLabel]=\"floatLabel\">\r\n      <textarea #inputElm matInput [placeholder]=\"title\" [required]=\"required\" (input)=\"onInput($event)\"\r\n        (click)=\"onClick($event)\" (focus)=\"onFocus($event)\" [(ngModel)]=\"value\" attr.name=\"{{ctlName}}\"\r\n        class=\"form-control ShCtlWideCharMl can-moved-with-the-enter-key {{strClass}}\" (keyup)=\"onKeyUp($event)\" (keydown)=\"onKeyDown($event)\"\r\n        (change)=\"onChange($event)\" [disabled]=\"disabled\" maxlength=\"{{maxlength}}\" [ngStyle]=\"styles\"\r\n        [ngClass]=\"objClass\"></textarea>\r\n      <button mat-button *ngIf=\"inputElm.value && !inputElm.readOnly && !inputElm.disabled\" matSuffix mat-icon-button\r\n        aria-label=\"Clear\" (mousedown)=\"clearValue()\" (keydown)=\"clickClearButton($event)\">\r\n        <mat-icon>close</mat-icon>\r\n      </button>\r\n    </mat-form-field>\r\n    <span class=\"custom-alert-message\">{{message.toString().split(',').join(' ')}}</span>\r\n  </div>\r\n</ng-container>\r\n\r\n<ng-template #onlyFieldControl>\r\n  <div class=\"only-field\" (focusin)=\"onFocusin($event)\" (focusout)=\"onFocusout($event)\">\r\n    <textarea #inputElm matInput [required]=\"required\" (input)=\"onInput($event)\"\r\n      (click)=\"onClick($event)\" (focus)=\"onFocus($event)\" [(ngModel)]=\"value\" attr.name=\"{{ctlName}}\"\r\n      class=\"form-control ShCtlWideCharMl can-moved-with-the-enter-key {{strClass}}\" (keyup)=\"onKeyUp($event)\" (keydown)=\"onKeyDown($event)\"\r\n      (change)=\"onChange($event)\" [disabled]=\"disabled\" maxlength=\"{{maxlength}}\" [ngStyle]=\"styles\"\r\n      [ngClass]=\"objClass\"></textarea>\r\n    <button mat-button *ngIf=\"inputElm.value && !inputElm.readOnly && !inputElm.disabled\" matSuffix mat-icon-button\r\n      aria-label=\"Clear\" (mousedown)=\"clearValue()\" (keydown)=\"clickClearButton($event)\">\r\n      <mat-icon>close</mat-icon>\r\n    </button>\r\n  </div>\r\n</ng-template>\r\n\r\n<div *ngIf=\"isDisabled\" class=\"display-ctl-view\">\r\n  <div>\r\n    <div *ngIf=\"title\" class=\"display-ctl-view\">\r\n      <div class=\"display-result\" [ngStyle]=\"{'width.px': labelWidth}\" fxLayout=\"row wrap\" fxFlex>\r\n        <div fxFlex class=\"item-title\"><strong>{{title}}:</strong></div>\r\n      </div>\r\n      <div fxFlex class=\"valueOutput\">\r\n        {{value}}\r\n      </div>\r\n    </div>\r\n\r\n    <div *ngIf=\"!title\" class=\"display-ctl-view notitle-value\">\r\n      <div fxFlex class=\"valueOutput\">\r\n        {{value}}\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n",
                styles: ["textarea{min-height:2em}.display-ctl-view{display:-webkit-box;display:flex}.display-result{margin-left:30px}.valueOutput{-webkit-box-flex:1;flex:1}.notitle-value{width:100%;margin-left:30px}", ".sh-flex{width:100%;display:-webkit-inline-box;display:inline-flex}.sh-flex-center{-webkit-box-align:center;align-items:center}.sh-flex-between{-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:center;align-items:center}.display-ctl-view{margin-top:20px}.overlay{position:fixed;display:-webkit-box;display:flex;top:0;left:0;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center;height:100%;width:100%;color:gray;background-color:rgba(0,0,0,.5);z-index:9999}.loader-text{display:block;color:#f3f3f3;margin-top:1em}.mat-dialog-content{overflow:hidden;max-height:none}.sh-dialog-content{height:85%}.sh-kbn-dialog-table-container{height:92%;overflow-y:scroll;margin-top:18px;margin-bottom:18px}.sh-dialog-table-container{display:-webkit-box;display:flex;height:83%;overflow-y:scroll;margin-top:18px;margin-bottom:18px}.sh-text-center{text-align:center}.sh-width-100{width:100%}.sh-label{display:block}.custom-alert-message{top:-20px;position:relative;font-size:.75em;color:rgba(0,0,0,.54)}.result-input,.sh-label{color:rgba(0,0,0,.87)}::ng-deep .mat-form-field-label span{color:rgba(0,0,0,.87)}::ng-deep .result-container .mat-form-field-flex{background-color:#ccdcff}.sh-ctl-state-primary::ng-deep .mat-form-field-label{color:#3f51b5}.sh-ctl-state-primary::ng-deep .mat-form-field-underline{background-color:#3f51b5}.sh-ctl-state-primary-message{color:#3f51b5}.sh-ctl-state-secondary::ng-deep .mat-form-field-label{color:#ff4081}.sh-ctl-state-secondary::ng-deep .mat-form-field-underline{background-color:#ff4081}.sh-ctl-state-secondary-message{color:#ff4081}.sh-ctl-state-success::ng-deep .mat-form-field-label{color:#0dad17}.sh-ctl-state-success::ng-deep .mat-form-field-underline{background-color:#0dad17}.sh-ctl-state-success-message{color:#0dad17}.sh-ctl-state-danger::ng-deep .mat-form-field-label{color:#f44336}.sh-ctl-state-danger::ng-deep .mat-form-field-underline{background-color:#f44336}.sh-ctl-state-danger-message{color:#f44336}.sh-ctl-state-warning::ng-deep .mat-form-field-label{color:#e29f2b}.sh-ctl-state-warning::ng-deep .mat-form-field-underline{background-color:#e29f2b}.sh-ctl-state-warning-message{color:#e29f2b}.sh-container{position:relative;width:100%;height:100%}.only-field{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;width:100%;height:100%;min-height:28px}.only-field input,.only-field textarea{font:inherit;background:0 0;color:currentColor;border:none;outline:0;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit}.only-field-danger{background-color:#f44336}.only-field-warning{background-color:#e29f2b}.only-field-success{background-color:#0dad17}::ng-deep .only-field .material-icons{font-size:13px}::ng-deep .only-field .mat-button{position:relative;width:24px;height:24px}::ng-deep .only-field .mat-icon-button{position:relative;width:24px;height:24px}::ng-deep .only-field .mat-icon{position:absolute;top:0;left:0}::ng-deep .only-field .mat-datepicker-toggle-default-icon{position:absolute;top:25%;left:0;right:0;bottom:0;margin-left:auto;margin-right:auto}::ng-deep .mat-datepicker-toggle span svg{width:16px;height:16px}.only-label{background-color:#ccdcff;position:relative}.only-label mat-icon{position:absolute;top:25%;left:0;right:0;bottom:0;margin-left:auto;font-size:16px}.bind-flg__input{opacity:0;height:0;width:0;position:absolute;z-index:-100}"]
            }] }
];
/** @nocollapse */
SHCtlWideCharMLComponent.ctorParameters = () => [];
if (false) {
    /**
     * @type {?}
     * @private
     */
    SHCtlWideCharMLComponent.prototype._data;
    /**
     * @type {?}
     * @private
     */
    SHCtlWideCharMLComponent.prototype.allowkeys;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2gtY3RsLXdpZGUtY2hhci1tbC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9zaC1mb3JtLWNvbnRyb2wvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9zaC1jdGwtd2lkZS1jaGFyLW1sL3NoLWN0bC13aWRlLWNoYXItbWwuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLE1BQU0sZUFBZSxDQUFDO0FBQ2xELE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUMvQyxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sK0JBQStCLENBQUE7QUFPN0QsTUFBTSxPQUFPLHdCQUF5QixTQUFRLGFBQXFCO0lBTWpFO1FBQ0UsS0FBSyxFQUFFLENBQUM7O1FBSkYsVUFBSyxHQUFFLEVBQUUsQ0FBQztRQUNWLGNBQVMsR0FBRyxDQUFDLFdBQVcsRUFBRSxZQUFZLEVBQUUsV0FBVyxFQUFFLFNBQVMsQ0FBQyxDQUFDO1FBSXRFLElBQUksQ0FBQyxPQUFPLEdBQUcsaUJBQWlCLENBQUM7SUFDbkMsQ0FBQzs7Ozs7O0lBQ08sV0FBVyxDQUFDLEdBQVc7UUFDN0IsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUN0QyxDQUFDOzs7O0lBQ00sUUFBUTtRQUNiLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNkLElBQUksSUFBSSxDQUFDLGFBQWEsR0FBRyxDQUFDLElBQUksQ0FBQztZQUM3QixJQUFJLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQyxhQUFhLEdBQUcsQ0FBQyxDQUFDO0lBQ2hELENBQUM7Ozs7OztJQU1NLE9BQU8sQ0FBQyxLQUFLOztjQUNaLFVBQVUsR0FBRyxDQUFDLElBQUksQ0FBQyxLQUFLLElBQUksS0FBSyxDQUFDLElBQUksQ0FBQztRQUM3QyxJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQyxJQUFJ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QkFDVCxRQUFRLEVBQUUscUJBQXFCO2dCQUMvQixtdUZBQW1EOzthQUVwRDs7Ozs7Ozs7O0lBSUMseUNBQWtCOzs7OztJQUNsQiw2Q0FBd0UiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBTSEN0bENvbW1vbiB9IGZyb20gJy4uL3NoLWN0bC1jb21tb24nO1xyXG5pbXBvcnQgeyBTSEZvcm1Db250cm9sIH0gZnJvbSAnLi4vLi4vdXRpbGl0aWVzL1NoRm9ybUNvbnRyb2wnXHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ3NoLWN0bC13aWRlLWNoYXItbWwnLFxyXG4gIHRlbXBsYXRlVXJsOiAnLi9zaC1jdGwtd2lkZS1jaGFyLW1sLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi9zaC1jdGwtd2lkZS1jaGFyLW1sLmNvbXBvbmVudC5jc3MnLCAnLi4vLi4vLi4vc3R5bGUuY29tbW9uLmNzcyddXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBTSEN0bFdpZGVDaGFyTUxDb21wb25lbnQgZXh0ZW5kcyBTSEZvcm1Db250cm9sPHN0cmluZz4gaW1wbGVtZW50cyBPbkluaXQge1xyXG5cclxuICAvL+WFpeWKm+WkieaPm+aZguOCkuijnOi2s+OBmeOCi+OBn+OCgeOBruWApOS/neaMgVxyXG4gIHByaXZhdGUgX2RhdGEgPVwiXCI7XHJcbiAgcHJpdmF0ZSBhbGxvd2tleXMgPSBbYEFycm93TGVmdGAsIGBBcnJvd1JpZ2h0YCwgYEFycm93RG93bmAsIGBBcnJvd1VwYF07XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgc3VwZXIoKTtcclxuICAgIHRoaXMuY3RsTmFtZSA9IFwiU0hDdGxXaWRlQ2hhck1MXCI7XHJcbiAgfVxyXG4gIHByaXZhdGUgaXNBbGxvd2tleXMoa2V5OiBzdHJpbmcpIHtcclxuICAgIHJldHVybiB0aGlzLmFsbG93a2V5cy5pbmNsdWRlcyhrZXkpO1xyXG4gIH1cclxuICBwdWJsaWMgbmdPbkluaXQoKSB7XHJcbiAgICB0aGlzLm9uSW5pdCgpO1xyXG4gICAgaWYgKHRoaXMubWF4Qnl0ZUxlbmd0aCAlIDIgIT0gMClcclxuICAgICAgdGhpcy5tYXhCeXRlTGVuZ3RoID0gdGhpcy5tYXhCeXRlTGVuZ3RoIC0gMTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIG9uSW5wdXRcclxuICAgKiBAcGFyYW0gZXZlbnQgaW5wdXRcclxuICAgKi9cclxuICBwdWJsaWMgb25JbnB1dChldmVudCkge1xyXG4gICAgY29uc3QgaXNTYW1lRGF0YSA9ICh0aGlzLl9kYXRhID09IGV2ZW50LmRhdGEpO1xyXG4gICAgdGhpcy5fZGF0YSA9IGV2ZW50LmRhdGE7XHJcbiAgICAvL+WFpeWKm+WkieaPm+S4reOBr+abuOOBjeaPm+OBiOOCkuihjOOCj+OBquOBhFxyXG4gICAgaWYoZXZlbnQuaXNDb21wb3NpbmcgJiYgKCFldmVudC5pc0NvbXBvc2luZyB8fCAhaXNTYW1lRGF0YSkpXHJcbiAgICAgIHJldHVybjtcclxuXHJcbiAgICBpZiAoZXZlbnQuaW5wdXRUeXBlICE9PSAnaW5zZXJ0Q29tcG9zaXRpb25UZXh0Jykge1xyXG4gICAgICBTSEN0bENvbW1vbi5zbGljZUxlbmd0aChldmVudCwgdGhpcy5tYXhsZW5ndGgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogb25DbGlja1xyXG4gICAqIEBwYXJhbSBldmVudCBjbGlja1xyXG4gICAqL1xyXG4gIHB1YmxpYyBvbkNsaWNrKGV2ZW50KSB7XHJcbiAgICB0aGlzLm9uQmVmb3JlQ2xpY2soZXZlbnQpO1xyXG5cclxuICAgIHRoaXMub25BZnRlckNsaWNrKGV2ZW50KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIG9uRm9jdXNcclxuICAgKiBAcGFyYW0gZXZlbnQgZm9jdXNcclxuICAgKi9cclxuICBwdWJsaWMgb25Gb2N1cyhldmVudCkge1xyXG4gICAgdGhpcy5vbkJlZm9yZUZvY3VzKGV2ZW50KTtcclxuXHJcbiAgICBldmVudC50YXJnZXQuc2VsZWN0KCk7XHJcblxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7dGhpcy5vbkFmdGVyRm9jdXMoZXZlbnQpfSwgMCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBvbkNoYW5nZVxyXG4gICAqIEBwYXJhbSBldmVudCBjaGFuZ2VcclxuICAgKi9cclxuICBwdWJsaWMgb25DaGFuZ2UoZXZlbnQpIHtcclxuICAgIHRoaXMub25CZWZvcmVDaGFuZ2UoZXZlbnQpO1xyXG5cclxuICAgIC8vZW1pdOOBruebtOWJjeOBq+OCguWApOOBrueyvuafu+OCkuihjOOBhlxyXG4gICAgdGhpcy5vbklucHV0KGV2ZW50KTtcclxuICAgIHRoaXMub25LZXlVcChldmVudCk7XHJcbiAgICB0aGlzLnZhbHVlQ2hhbmdlLmVtaXQoZXZlbnQudGFyZ2V0LnZhbHVlKTtcclxuXHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHt0aGlzLm9uQWZ0ZXJDaGFuZ2UoZXZlbnQpfSwgMCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBvbkJsdXJcclxuICAgKiBAcGFyYW0gZXZlbnQgYmx1clxyXG4gICAqL1xyXG4gIHB1YmxpYyBvbkJsdXIoZXZlbnQpIHtcclxuICAgIHRoaXMub25CZWZvcmVCbHVyKGV2ZW50KTtcclxuXHJcbiAgICBpZiAoZXZlbnQudGFyZ2V0LnZhbHVlID09IHVuZGVmaW5lZCkge1xyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHt0aGlzLm9uQWZ0ZXJCbHVyKGV2ZW50KTt9LCAwKTs7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH07XHJcblxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7dGhpcy5vbkFmdGVyQmx1cihldmVudCk7fSwgMCk7O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogb25LZXlVcFxyXG4gICAqIEBwYXJhbSBldmVudCBLZXlVcFxyXG4gICAqL1xyXG4gIHB1YmxpYyBvbktleVVwKGV2ZW50KSB7XHJcbiAgICBjb25zdCBpbnB1dCA9IGV2ZW50LnRhcmdldCBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgY29uc3QgY3Vyc29yID0gaW5wdXQuc2VsZWN0aW9uU3RhcnQ7XHJcbiAgICBpZiAoICFldmVudC5pc0NvbXBvc2luZyApIHsgXHJcbiAgICAgIFNIQ3RsQ29tbW9uLnJlcGxhY2VIYWxmU3BhY2VUb0Z1bGwoZXZlbnQpO1xyXG4gICAgICBTSEN0bENvbW1vbi5yZXBsYWNlRnVsbERvdWJsZVF1b3RlKGV2ZW50KTtcclxuICAgICAgU0hDdGxDb21tb24ucmVwbGFjZUhhbGZLYW5hKGV2ZW50KTtcclxuICAgICAgaWYoZXZlbnQuc2hpZnRLZXkgfHwgZXZlbnQua2V5ID09PSBcIlNoaWZ0XCIpIHJldHVybjtcclxuICAgICAgaW5wdXQuc2V0U2VsZWN0aW9uUmFuZ2UoY3Vyc29yLCBjdXJzb3IpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogb25LZXlEb3duXHJcbiAgICogQHBhcmFtIGV2ZW50IEtleVVwXHJcbiAgICovXHJcbiAgcHVibGljIG9uS2V5RG93bihldmVudCkge1xyXG4gICAgaWYgKHRoaXMubWF4Qnl0ZUxlbmd0aCA+IDApXHJcbiAgICAgIHN1cGVyLm9uS2V5RG93bihldmVudCk7XHJcbiAgfVxyXG5cclxufVxyXG4iXX0=